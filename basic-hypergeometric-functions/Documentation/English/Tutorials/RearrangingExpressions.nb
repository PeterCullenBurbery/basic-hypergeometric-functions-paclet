(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    444013,      12199]
NotebookOptionsPosition[    414421,      11524]
NotebookOutlinePosition[    415541,      11554]
CellTagsIndexPosition[    415381,      11548]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Rearranging Expressions", "Title",
 CellID->555292541,ExpressionUUID->"4392a549-f5bc-4eed-86cd-bd4f56abb022"],

Cell[TextData[{
 "The functions defined in the ",
 Cell[BoxData["PeterBurbery`BasicHypergeometricFunctions`"], "InlineFormula",
  FormatType->StandardForm,ExpressionUUID->
  "33d3b121-2af1-420b-8d3c-d9ff2a4461b4"],
 " context provide support for placing the q in front."
}], "Text",
 CellChangeTimes->{{3.894968939778677*^9, 3.8949689950377684`*^9}},
 CellID->34242218,ExpressionUUID->"da171d77-9ecf-45b9-aa05-d6d9041a939a"],

Cell[CellGroupData[{

Cell["This loads the package:", "MathCaption",
 CellChangeTimes->{{3.894968996501567*^9, 3.8949690035870385`*^9}},
 CellID->513850824,ExpressionUUID->"7bada169-7c3d-4776-b7f7-9de2435b9070"],

Cell[BoxData[
 RowBox[{"<<", "PeterBurbery`BasicHypergeometricFunctions`"}]], "Input",
 CellChangeTimes->{{3.8949690042623696`*^9, 3.894969012464512*^9}},
 CellLabel->"In[9]:=",
 CellID->542855510,ExpressionUUID->"0dee9fdd-35d3-4720-adb9-0ac50b09f781"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Put Q in the front", "Section",
 CellChangeTimes->{{3.3702661238247538`*^9, 3.370266130890768*^9}, 
   3.371301959371707*^9, {3.3751044240283327`*^9, 3.375104428916211*^9}, {
   3.8949690267658215`*^9, 3.894969030164384*^9}},
 CellID->2591,ExpressionUUID->"e289c6af-e7f4-4b1c-818e-9eda6dd9cb82"],

Cell[CellGroupData[{

Cell["\<\
The built-in function PositionQInFrontOfList puts q in front of a list. The \
function works by using UnsortedComplement.\
\>", "Text",
 CellChangeTimes->{{3.8949690314164023`*^9, 3.894969074727002*^9}},
 CellID->590619292,ExpressionUUID->"b612293d-b26c-4a4f-9c16-0ee176d43931"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PositionQInFrontOfList", "[", 
  RowBox[{"{", 
   RowBox[{"b", ",", "c", ",", "d", ",", "q", ",", "f", ",", "q"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.894969041619733*^9, 3.894969080736179*^9}},
 CellLabel->"In[10]:=",
 CellID->219423307,ExpressionUUID->"c005b7de-a8c7-45df-9f11-f64113601e19"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"q", ",", "q", ",", "b", ",", "c", ",", "d", ",", "f"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.89496908104531*^9},
 CellLabel->"Out[10]=",
 CellID->272831206,ExpressionUUID->"9e37fe5e-f82a-4f84-a340-a0975f379d0a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rearranging", "Section",
 CellChangeTimes->{{3.3702661238247538`*^9, 3.370266130890768*^9}, 
   3.371301959371707*^9, {3.3751044240283327`*^9, 3.375104428916211*^9}, {
   3.8949690267658215`*^9, 3.894969030164384*^9}, {3.894969115477767*^9, 
   3.8949691269123325`*^9}},
 CellID->237748664,ExpressionUUID->"00036f6a-63fd-4f4f-a2de-66a749e3d47c"],

Cell[CellGroupData[{

Cell["This is the expression tree of a a b s a s q s d \
s\[NonBreakingSpace]d:", "MathCaption",
 CellChangeTimes->{{3.8949691282524586`*^9, 3.8949691430957074`*^9}},
 CellID->30906755,ExpressionUUID->"e250cd9f-9b0e-4e7b-8c8b-dd8939ecf38b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exampleInput", "=", 
  RowBox[{
  "a", " ", "b", " ", "s", " ", "a", " ", "s", " ", "q", " ", "s", " ", "d", 
   " ", "s", " ", "d"}]}]], "Input",
 CellChangeTimes->{{3.8949691440325036`*^9, 3.894969152146666*^9}},
 CellLabel->"In[3]:=",
 CellID->501709717,ExpressionUUID->"1542516c-d21f-43bc-a96f-434c0b7c4782"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["a", "2"], " ", "b", " ", 
  SuperscriptBox["d", "2"], " ", "q", " ", 
  SuperscriptBox["s", "4"]}]], "Output",
 CellChangeTimes->{3.8949691525907345`*^9, 3.894975444077566*^9},
 CellLabel->"Out[3]=",
 CellID->187249567,ExpressionUUID->"488c71cf-7b69-4b59-85bc-82928f353118"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpressionTree", "[", "exampleInput", "]"}]], "Input",
 CellChangeTimes->{{3.8949691546072807`*^9, 3.894969158038974*^9}},
 CellLabel->"In[4]:=",
 CellID->45907700,ExpressionUUID->"afa7c4e4-7e9c-42d8-8885-a887ef7faee4"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["Trees",
   DynamicModuleBox[{Typeset`tree = HoldComplete[
     Tree[Times, {
       Tree[Power, {
         Tree[$CellContext`a, None], 
         Tree[2, None]}], 
       Tree[$CellContext`b, None], 
       Tree[Power, {
         Tree[$CellContext`d, None], 
         Tree[2, None]}], 
       Tree[$CellContext`q, None], 
       Tree[Power, {
         Tree[$CellContext`s, None], 
         Tree[4, None]}]}]]}, 
    NamespaceBox[{
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
         0.3496029493900505, 0.7574021974529568}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
         1.0488088481701514`, 0.7574021974529568}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
         1.7480147469502525`, 0.7574021974529568}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
         2.4472206457303534`, 0.7574021974529568}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
         3.1464265445104544`, 0.7574021974529568}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{0.3496029493900505, 0.7574021974529568}, {0., 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{0.3496029493900505, 0.7574021974529568}, {0.699205898780101,
          0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7480147469502525`, 0.7574021974529568}, {
         1.398411797560202, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7480147469502525`, 0.7574021974529568}, {
         2.097617696340303, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.1464265445104544`, 0.7574021974529568}, {
         2.796823595120404, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.1464265445104544`, 0.7574021974529568}, {
         3.496029493900505, 0.}}]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
       TagBox[InsetBox[
         FrameBox["Times",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {1.7480147469502525, 1.5148043949059136}],
        "DynamicName",
        BoxID -> "VertexID$1"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {0.3496029493900505, 0.7574021974529568}],
        "DynamicName",
        BoxID -> "VertexID$2"], 
       TagBox[InsetBox[
         FrameBox["a",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {0., 0.}],
        "DynamicName",
        BoxID -> "VertexID$3"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {0.699205898780101, 0.}],
        "DynamicName",
        BoxID -> "VertexID$4"], 
       TagBox[InsetBox[
         FrameBox["b",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {1.0488088481701514, 0.7574021974529568}],
        "DynamicName",
        BoxID -> "VertexID$5"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {1.7480147469502525, 0.7574021974529568}],
        "DynamicName",
        BoxID -> "VertexID$6"], 
       TagBox[InsetBox[
         FrameBox["d",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {1.398411797560202, 0.}],
        "DynamicName",
        BoxID -> "VertexID$7"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.097617696340303, 0.}],
        "DynamicName",
        BoxID -> "VertexID$8"], 
       TagBox[InsetBox[
         FrameBox["q",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.4472206457303534, 0.7574021974529568}],
        "DynamicName",
        BoxID -> "VertexID$9"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {3.1464265445104544, 0.7574021974529568}],
        "DynamicName",
        BoxID -> "VertexID$10"], 
       TagBox[InsetBox[
         FrameBox["s",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.796823595120404, 0.}],
        "DynamicName",
        BoxID -> "VertexID$11"], 
       TagBox[InsetBox[
         FrameBox["4",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {3.496029493900505, 0.}],
        "DynamicName",
        BoxID -> "VertexID$12"]}}]]],
  AlignmentPoint->Center,
  Axes->False,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  ContentSelectable->Automatic,
  DefaultBaseStyle->"TreeGraphics",
  Epilog->{},
  FormatType->StandardForm,
  Frame->False,
  FrameLabel->None,
  FrameStyle->{},
  FrameTicks->None,
  FrameTicksStyle->{},
  GridLines->None,
  GridLinesStyle->{},
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  LabelStyle->{},
  PlotLabel->None,
  PlotRange->All,
  PlotRangeClipping->False,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  Prolog->{},
  RotateLabel->True,
  Ticks->Automatic,
  TicksStyle->{}]], "Output",
 CellChangeTimes->{3.8949691592289743`*^9, 3.894975447564186*^9},
 CellLabel->"Out[4]=",
 CellID->895181536,ExpressionUUID->"8107efe8-ed22-4c56-87de-5eaa90656bb7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We want to put q in the front. We need to verify q is in the expression first:\
\>", "MathCaption",
 CellChangeTimes->{{3.8949691623887377`*^9, 3.8949691782679667`*^9}},
 CellID->340949841,ExpressionUUID->"f8838af4-b20d-4ec5-a66f-f7d8b078f083"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{"exampleInput", ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949691790251617`*^9, 3.8949691820111685`*^9}},
 CellLabel->"In[5]:=",
 CellID->152984908,ExpressionUUID->"3ffb77c4-590c-4ead-a50c-cb1b18c855f9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "4", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.894969182409585*^9, 3.894975448662047*^9},
 CellLabel->"Out[5]=",
 CellID->130135511,ExpressionUUID->"c93a09c0-c592-4a37-a1c9-a736cb2815d0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["An expression without q would have a different output.", "MathCaption",
 CellChangeTimes->{{3.8949691900043087`*^9, 3.8949692012692738`*^9}},
 CellID->579788294,ExpressionUUID->"2e56b696-7921-4dd2-bf7d-0c15be4b3e70"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expressionWithNoQ", "=", 
  RowBox[{"b", " ", "d"}]}]], "Input",
 CellChangeTimes->{{3.894969202497032*^9, 3.894969212139762*^9}},
 CellLabel->"In[6]:=",
 CellID->8585758,ExpressionUUID->"9e3189cf-1dac-4683-b068-aa39e4a347fe"],

Cell[BoxData[
 RowBox[{"b", " ", "d"}]], "Output",
 CellChangeTimes->{3.894969212516898*^9, 3.8949754508089275`*^9},
 CellLabel->"Out[6]=",
 CellID->15928604,ExpressionUUID->"4705ed4c-77f3-4d52-93c1-3e4e4dd55fb2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{"expressionWithNoQ", ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949692159597335`*^9, 3.8949692198048673`*^9}},
 CellLabel->"In[7]:=",
 CellID->1001352657,ExpressionUUID->"8d2cec3f-4b54-43fc-ae0e-c64bd1ae354a"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.89496922053944*^9, 3.8949754523779373`*^9},
 CellLabel->"Out[7]=",
 CellID->555168197,ExpressionUUID->"ed66c2d4-31f0-4bb5-ba5d-b990fa15b75b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The q could be raised to a power:", "MathCaption",
 CellChangeTimes->{{3.8949692252117195`*^9, 3.8949692303046722`*^9}},
 CellID->210058381,ExpressionUUID->"8565d89a-3dc1-40ac-acd5-d801d217a040"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qraisedtothepower", "=", 
  RowBox[{"b", " ", "d", " ", 
   SuperscriptBox["q", "2"], " ", "d", " ", "b"}]}]], "Input",
 CellChangeTimes->{{3.8949692323762565`*^9, 3.8949692414595823`*^9}},
 CellLabel->"In[8]:=",
 CellID->3618976,ExpressionUUID->"2de0fa28-d123-428b-b5e2-98d1c8625d06"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["b", "2"], " ", 
  SuperscriptBox["d", "2"], " ", 
  SuperscriptBox["q", "2"]}]], "Output",
 CellChangeTimes->{3.894969241859357*^9, 3.8949754544982395`*^9},
 CellLabel->"Out[8]=",
 CellID->60384182,ExpressionUUID->"94746ca0-d6f1-48e7-8278-248ff52f0647"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{"qraisedtothepower", ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949692460745296`*^9, 3.89496924958002*^9}},
 CellLabel->"In[9]:=",
 CellID->158897045,ExpressionUUID->"660b225c-1422-4319-8e29-d30e3deb8688"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"3", ",", "1"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.89496924999722*^9, 3.8949754562030897`*^9},
 CellLabel->"Out[9]=",
 CellID->90949083,ExpressionUUID->"601fecce-349c-4039-8f5b-2f1b74399bd6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let's look at these three examples from the perspective of Cases:\
\>", "MathCaption",
 CellChangeTimes->{{3.8949692568198767`*^9, 3.8949692685568333`*^9}},
 CellID->45747336,ExpressionUUID->"2af08122-2b75-4880-a344-84d2102e1006"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"exampleInput", ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949692696952534`*^9, 3.8949692739442234`*^9}},
 CellLabel->"In[10]:=",
 CellID->106947108,ExpressionUUID->"66b70e28-e77a-447e-a23b-1b9e9d0d56eb"],

Cell[BoxData[
 RowBox[{"{", "q", "}"}]], "Output",
 CellChangeTimes->{3.8949692743166456`*^9, 3.894975458642703*^9},
 CellLabel->"Out[10]=",
 CellID->688234202,ExpressionUUID->"4c82f576-35b3-4c89-9dda-a2b8fadfdd98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"expressionWithNoQ", ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949692696952534`*^9, 3.8949692788900175`*^9}},
 CellLabel->"In[11]:=",
 CellID->289386853,ExpressionUUID->"4468754d-b339-4a2a-9d0d-4595095e64b6"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.8949692791362443`*^9, 3.894975461371749*^9},
 CellLabel->"Out[11]=",
 CellID->383066580,ExpressionUUID->"48a35c84-046a-4567-9766-96920108ee49"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"qraisedtothepower", ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949692696952534`*^9, 3.8949692827785826`*^9}},
 CellLabel->"In[12]:=",
 CellID->616336306,ExpressionUUID->"d79fbaf0-27e6-49a8-aa49-3068b2ea26df"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.8949692831055317`*^9, 3.894975462439204*^9},
 CellLabel->"Out[12]=",
 CellID->287890430,ExpressionUUID->"f29a22a9-3747-4e8f-b627-7b11e218ce82"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The last example should have something, but q is on a higher level. Let's \
look at the expression tree.\
\>", "MathCaption",
 CellChangeTimes->{{3.894969287663664*^9, 3.894969313196578*^9}},
 CellID->657986846,ExpressionUUID->"58782be3-aee4-4688-9aa0-f67ced329f3f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpressionTree", "[", "qraisedtothepower", "]"}]], "Input",
 CellChangeTimes->{{3.89496931377957*^9, 3.8949693172066326`*^9}},
 CellLabel->"In[13]:=",
 CellID->3639185,ExpressionUUID->"53397038-fd0e-4d9a-9edd-b596769b620d"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["Trees",
   DynamicModuleBox[{Typeset`tree = HoldComplete[
     Tree[Times, {
       Tree[Power, {
         Tree[$CellContext`b, None], 
         Tree[2, None]}], 
       Tree[Power, {
         Tree[$CellContext`d, None], 
         Tree[2, None]}], 
       Tree[Power, {
         Tree[$CellContext`q, None], 
         Tree[2, None]}]}]]}, 
    NamespaceBox[{
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
         0.34874291623145787`, 0.7555526554078994}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
         1.7437145811572892`, 0.7555526554078994}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
         3.1386862460831204`, 0.7555526554078994}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{0.34874291623145787`, 0.7555526554078994}, {0., 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{0.34874291623145787`, 0.7555526554078994}, {
         0.6974858324629157, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7437145811572892`, 0.7555526554078994}, {
         1.3949716649258315`, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.7437145811572892`, 0.7555526554078994}, {
         2.092457497388747, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.1386862460831204`, 0.7555526554078994}, {
         2.789943329851663, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.1386862460831204`, 0.7555526554078994}, {
         3.4874291623145783`, 0.}}]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
       TagBox[InsetBox[
         FrameBox["Times",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {1.7437145811572892, 1.5111053108157988}],
        "DynamicName",
        BoxID -> "VertexID$1"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {0.34874291623145787, 0.7555526554078994}],
        "DynamicName",
        BoxID -> "VertexID$2"], 
       TagBox[InsetBox[
         FrameBox["b",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {0., 0.}],
        "DynamicName",
        BoxID -> "VertexID$3"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {0.6974858324629157, 0.}],
        "DynamicName",
        BoxID -> "VertexID$4"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {1.7437145811572892, 0.7555526554078994}],
        "DynamicName",
        BoxID -> "VertexID$5"], 
       TagBox[InsetBox[
         FrameBox["d",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {1.3949716649258315, 0.}],
        "DynamicName",
        BoxID -> "VertexID$6"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.092457497388747, 0.}],
        "DynamicName",
        BoxID -> "VertexID$7"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {3.1386862460831204, 0.7555526554078994}],
        "DynamicName",
        BoxID -> "VertexID$8"], 
       TagBox[InsetBox[
         FrameBox["q",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.789943329851663, 0.}],
        "DynamicName",
        BoxID -> "VertexID$9"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {3.4874291623145783, 0.}],
        "DynamicName",
        BoxID -> "VertexID$10"]}}]]],
  AlignmentPoint->Center,
  Axes->False,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  ContentSelectable->Automatic,
  DefaultBaseStyle->"TreeGraphics",
  Epilog->{},
  FormatType->StandardForm,
  Frame->False,
  FrameLabel->None,
  FrameStyle->{},
  FrameTicks->None,
  FrameTicksStyle->{},
  GridLines->None,
  GridLinesStyle->{},
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  LabelStyle->{},
  PlotLabel->None,
  PlotRange->All,
  PlotRangeClipping->False,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  Prolog->{},
  RotateLabel->True,
  Ticks->Automatic,
  TicksStyle->{}]], "Output",
 CellChangeTimes->{3.8949693175765953`*^9, 3.894975465146831*^9},
 CellLabel->"Out[13]=",
 CellID->781595662,ExpressionUUID->"84c8a925-7c7f-43d1-9477-0b21d4c74fd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeLevel", "[", 
  RowBox[{
   RowBox[{"ExpressionTree", "[", "qraisedtothepower", "]"}], ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.894969320974035*^9, 3.894969324249234*^9}},
 CellLabel->"In[14]:=",
 CellID->106876852,ExpressionUUID->"b8a9ab4a-ca17-489b-a112-77b3eb665233"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Power, {
         Tree[$CellContext`b, None], 
         Tree[2, None]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {0., 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {
           0.8944271909999159, 0.}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.4472135954999579, 0.8929961074943159}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 0.}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.8944271909999159, 0.}],
          "DynamicName",
          BoxID -> "VertexID$3"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Power, {
         Tree[$CellContext`d, None], 
         Tree[2, None]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {0., 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {
           0.8944271909999159, 0.}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.4472135954999579, 0.8929961074943159}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 0.}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.8944271909999159, 0.}],
          "DynamicName",
          BoxID -> "VertexID$3"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Power, {
         Tree[$CellContext`q, None], 
         Tree[2, None]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {0., 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {
           0.8944271909999159, 0.}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.4472135954999579, 0.8929961074943159}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 0.}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.8944271909999159, 0.}],
          "DynamicName",
          BoxID -> "VertexID$3"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}]}], "}"}]], "Output",
 CellChangeTimes->{3.894969324948366*^9, 3.8949754692313843`*^9},
 CellLabel->"Out[14]=",
 CellID->78099367,ExpressionUUID->"c1912582-c320-4a31-a835-d77a09a1b203"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["q is on the second level:", "MathCaption",
 CellChangeTimes->{{3.8949693826997375`*^9, 3.8949693860439405`*^9}},
 CellID->201555096,ExpressionUUID->"ea217606-4fc7-4ae5-b860-1a9d9c0c9bb4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeLevel", "[", 
  RowBox[{
   RowBox[{"ExpressionTree", "[", "qraisedtothepower", "]"}], ",", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.894969320974035*^9, 3.894969324249234*^9}, {
  3.8949693866741505`*^9, 3.8949693878641925`*^9}},
 CellLabel->"In[15]:=",
 CellID->76274047,ExpressionUUID->"7365682a-9352-4f44-8e92-8fa88547b46e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`b, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Power, {
         Tree[$CellContext`b, None], 
         Tree[2, None]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {0., 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {
           0.8944271909999159, 0.}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.4472135954999579, 0.8929961074943159}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 0.}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.8944271909999159, 0.}],
          "DynamicName",
          BoxID -> "VertexID$3"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`d, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Power, {
         Tree[$CellContext`d, None], 
         Tree[2, None]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {0., 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {
           0.8944271909999159, 0.}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.4472135954999579, 0.8929961074943159}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 0.}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.8944271909999159, 0.}],
          "DynamicName",
          BoxID -> "VertexID$3"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`q, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Power, {
         Tree[$CellContext`q, None], 
         Tree[2, None]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {0., 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {
           0.8944271909999159, 0.}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.4472135954999579, 0.8929961074943159}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 0.}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.8944271909999159, 0.}],
          "DynamicName",
          BoxID -> "VertexID$3"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}]}], "}"}]], "Output",
 CellChangeTimes->{3.894969388494458*^9, 3.894975472427712*^9},
 CellLabel->"Out[15]=",
 CellID->268218734,ExpressionUUID->"d0cf1f2d-53e1-484a-9edc-173b312ec335"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We might want just level 2 and not the subtrees. We can specify this:\
\>", "MathCaption",
 CellChangeTimes->{{3.894969400701731*^9, 3.894969414339944*^9}},
 CellID->116384939,ExpressionUUID->"193fd985-a1c8-4cb4-8049-61c540b24416"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeLevel", "[", 
  RowBox[{
   RowBox[{"ExpressionTree", "[", "qraisedtothepower", "]"}], ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894969320974035*^9, 3.894969324249234*^9}, {
  3.8949693866741505`*^9, 3.894969416293313*^9}},
 CellLabel->"In[16]:=",
 CellID->11721902,ExpressionUUID->"1650bdc2-d3dd-44d2-935a-cb0166afa61e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`b, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`d, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`q, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}]}], "}"}]], "Output",
 CellChangeTimes->{3.8949694167668667`*^9, 3.894975475358383*^9},
 CellLabel->"Out[16]=",
 CellID->122696485,ExpressionUUID->"f3d6bc50-6c9c-40f3-bf12-4a151619f9cb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["q is in the leaves:", "MathCaption",
 CellChangeTimes->{{3.8949693761751165`*^9, 3.894969379816039*^9}},
 CellID->7379660,ExpressionUUID->"86b94b57-eaac-4303-81af-a7050b4a3f0d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeLeaves", "[", 
  RowBox[{"ExpressionTree", "[", "qraisedtothepower", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949694237806373`*^9, 3.894969444523631*^9}},
 CellLabel->"In[17]:=",
 CellID->57152497,ExpressionUUID->"fc483901-d97e-4372-9f6a-9813c3022a4b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`b, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`d, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`q, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8949694289816074`*^9, 3.894969445137455*^9}, 
   3.894975477791693*^9},
 CellLabel->"Out[17]=",
 CellID->99386605,ExpressionUUID->"c5e71275-b015-4f09-85eb-6a48969472f9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["We can also use -1 level specification:", "MathCaption",
 CellChangeTimes->{{3.8949693761751165`*^9, 3.894969379816039*^9}, {
  3.894969499172389*^9, 3.894969505432061*^9}},
 CellID->600024437,ExpressionUUID->"124a6d2d-ea42-451a-94ee-c679eb1ebe95"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeLevel", "[", 
  RowBox[{
   RowBox[{"ExpressionTree", "[", "qraisedtothepower", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"-", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949694237806373`*^9, 3.894969444523631*^9}, {
  3.8949695061181626`*^9, 3.894969515298168*^9}},
 CellLabel->"In[18]:=",
 CellID->356384648,ExpressionUUID->"85f25a87-aaee-49ac-aec1-40dc56984d69"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`b, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`d, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`q, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}]}], "}"}]], "Output",
 CellChangeTimes->{3.8949695157736745`*^9, 3.8949754802745523`*^9},
 CellLabel->"Out[18]=",
 CellID->51287920,ExpressionUUID->"44758134-dc52-4f6e-9723-314aab58a870"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Another way to get q is with TreeLeafQ:", "MathCaption",
 CellChangeTimes->{{3.8949695522537136`*^9, 3.8949695588228693`*^9}},
 CellID->32533157,ExpressionUUID->"ef013166-4ead-44c5-b462-ff65ddc99d01"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeSelect", "[", 
  RowBox[{
   RowBox[{"ExpressionTree", "[", "qraisedtothepower", "]"}], ",", 
   "TreeLeafQ"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949694237806373`*^9, 3.894969444523631*^9}, {
  3.8949695061181626`*^9, 3.894969515298168*^9}, {3.894969559492277*^9, 
  3.894969569287594*^9}},
 CellLabel->"In[19]:=",
 CellID->221488453,ExpressionUUID->"0416be1e-c919-43ec-aa1e-85469159a7b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`b, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`d, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[$CellContext`q, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[2, None]]}, 
      NamespaceBox[{{}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1., 1.}],
          "DynamicName",
          BoxID -> "VertexID$1"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->0.1,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}]}], "}"}]], "Output",
 CellChangeTimes->{3.894969569922017*^9, 3.894975482719123*^9},
 CellLabel->"Out[19]=",
 CellID->44145120,ExpressionUUID->"35e9dc97-64da-40ab-bf0d-b1170d95795f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["We can get the data with TreeData:", "MathCaption",
 CellChangeTimes->{{3.894969587792997*^9, 3.8949695947360897`*^9}},
 CellID->441304007,ExpressionUUID->"a2133ad2-2225-44aa-9f09-fb71192a71ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeData", "/@", 
  RowBox[{"TreeSelect", "[", 
   RowBox[{
    RowBox[{"ExpressionTree", "[", "qraisedtothepower", "]"}], ",", 
    "TreeLeafQ"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894969577102889*^9, 3.8949695791575985`*^9}},
 CellLabel->"In[20]:=",
 CellID->784023909,ExpressionUUID->"a58c9ff8-287c-44c1-b668-5330c449eee6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"b", ",", "2", ",", "d", ",", "2", ",", "q", ",", "2"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.894969579437874*^9, 3.8949754849984426`*^9},
 CellLabel->"Out[20]=",
 CellID->565604538,ExpressionUUID->"81941b3a-1333-4d5a-a4ac-58c4a01cf9cd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
If q is in the expression, then q will be in this list. Otherwise it will not \
be.\
\>", "MathCaption",
 CellChangeTimes->{{3.8949695997676344`*^9, 3.8949696073557587`*^9}, {
  3.8949699741404486`*^9, 3.894969984771845*^9}},
 CellID->48363548,ExpressionUUID->"5149010d-c608-4898-8767-cfd634db1877"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeData", "/@", 
  RowBox[{"TreeSelect", "[", 
   RowBox[{
    RowBox[{"ExpressionTree", "[", "expressionWithNoQ", "]"}], ",", 
    "TreeLeafQ"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894969577102889*^9, 3.8949695791575985`*^9}, {
  3.89496998582251*^9, 3.8949699920734425`*^9}},
 CellLabel->"In[21]:=",
 CellID->265849720,ExpressionUUID->"0994fd9e-af71-478d-908d-4500620df444"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"b", ",", "d"}], "}"}]], "Output",
 CellChangeTimes->{3.8949699924218483`*^9, 3.894975487848468*^9},
 CellLabel->"Out[21]=",
 CellID->36210837,ExpressionUUID->"affd3fdf-d9ac-416c-862d-47ff1e8b97d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MemberQ", "[", 
  RowBox[{
   RowBox[{"TreeData", "/@", 
    RowBox[{"TreeSelect", "[", 
     RowBox[{
      RowBox[{"ExpressionTree", "[", "expressionWithNoQ", "]"}], ",", 
      "TreeLeafQ"}], "]"}]}], ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949699954406986`*^9, 3.8949700005932827`*^9}},
 CellLabel->"In[22]:=",
 CellID->10018807,ExpressionUUID->"fd7a6e53-b654-4cbc-b5ee-9f48f9ec5f56"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.8949700010475116`*^9, 3.894975490514269*^9},
 CellLabel->"Out[22]=",
 CellID->90942833,ExpressionUUID->"e76d88ee-cf9e-4426-9e7b-7134e41378e3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make a function to test if q is in an expression:", "MathCaption",
 CellChangeTimes->{{3.894970432273905*^9, 3.8949704389607983`*^9}},
 CellID->222360495,ExpressionUUID->"7d92d8c6-2ea7-4ba0-8219-43584f030b73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myQWithinExpressionQ", "[", "input_", "]"}], ":=", 
  RowBox[{"MemberQ", "[", 
   RowBox[{
    RowBox[{"TreeData", "/@", 
     RowBox[{"TreeSelect", "[", 
      RowBox[{
       RowBox[{"ExpressionTree", "[", "input", "]"}], ",", "TreeLeafQ"}], 
      "]"}]}], ",", "q"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894970428956133*^9, 3.894970450647216*^9}, {
  3.894970779184678*^9, 3.894970780050911*^9}, {3.894975500869317*^9, 
  3.8949755011785765`*^9}},
 CellLabel->"In[23]:=",
 CellID->876159263,ExpressionUUID->"82beeeb9-2a8c-4463-af42-1005bc5440b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test the function:", "MathCaption",
 CellChangeTimes->{{3.894970460467807*^9, 3.8949704627825966`*^9}},
 CellID->140693972,ExpressionUUID->"bb3a1f82-6483-45e6-bf09-9be803a1b346"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myQWithinExpressionQ", "[", "expressionWithNoQ", "]"}]], "Input",
 CellChangeTimes->{{3.8949704526003966`*^9, 3.894970456870181*^9}, {
  3.894970785858317*^9, 3.8949707875918765`*^9}, {3.894975504687765*^9, 
  3.8949755049984684`*^9}},
 CellLabel->"In[24]:=",
 CellID->676058770,ExpressionUUID->"d8f63307-e67d-4fc8-a97d-402c45b59692"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.894970457560179*^9, 3.894970788499939*^9, 
  3.8949755055673637`*^9},
 CellLabel->"Out[24]=",
 CellID->173651887,ExpressionUUID->"eea12d2b-f043-46fd-85dd-2cbf4f625467"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Test all the examples with the SameTest QInExpressionQ[#1] == #2.\
\>", "MathCaption",
 CellChangeTimes->{{3.894970681532936*^9, 3.8949706918600016`*^9}},
 CellID->362701572,ExpressionUUID->"9acb1795-a990-4a13-8873-c90e28be41a8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestReport", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TestCreate", "[", 
       RowBox[{"#1", ",", "#2", ",", 
        RowBox[{"TestID", "->", "Automatic"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "expressionWithNoQ", ",", "qraisedtothepower", ",", "exampleInput"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], "}"}]}], "]"}], 
   ",", 
   RowBox[{"SameTest", "->", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"myQWithinExpressionQ", "[", "#1", "]"}], "==", "#2"}], "&"}], 
     ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894970620321947*^9, 3.894970658010736*^9}, {
   3.8949706949242897`*^9, 3.894970698515956*^9}, 3.8949707919767895`*^9, {
   3.8949755111589785`*^9, 3.8949755136677804`*^9}},
 CellLabel->"In[25]:=",
 CellID->569912814,ExpressionUUID->"19d0214e-62ae-45d5-aa1b-60302fc7b9e9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["TestReportObject",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              InsetBox[
               BoxData[
                FormBox[
                 PaneBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitExpressions", "SuccessIcon"]], Alignment -> Center, 
                  ImageSize -> 
                  Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], TraditionalForm]]]}, 
             PlotRange -> {{0, 1}, {0, 1}}, Background -> GrayLevel[0.93], 
             Axes -> False, AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.55]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Tests count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Success rate: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   InterpretationBox[
                    StyleBox["\"100%\"", ShowStringCharacters -> False], 1., 
                    AutoDelete -> True], PercentForm], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              InsetBox[
               BoxData[
                FormBox[
                 PaneBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitExpressions", "SuccessIcon"]], Alignment -> Center, 
                  ImageSize -> 
                  Dynamic[{
                    Automatic, 
                    3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], TraditionalForm]]]}, 
             PlotRange -> {{0, 1}, {0, 1}}, Background -> GrayLevel[0.93], 
             Axes -> False, AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.55]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Tests count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}], ""}, {
               RowBox[{
                 TagBox["\"Success rate: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   InterpretationBox[
                    StyleBox["\"100%\"", ShowStringCharacters -> False], 1., 
                    AutoDelete -> True], PercentForm], "SummaryItem"]}], ""}, {
               RowBox[{
                 TagBox["\"Succeeded: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}], "\[SpanFromLeft]"}, {
               RowBox[{
                 TagBox["\"Time elapsed: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  
                  TemplateBox[{
                   "0.0006032`3.4538550759740443", "\"s\"", "seconds", 
                    "\"Seconds\""}, "Quantity", SyntaxForm -> Mod], 
                  "SummaryItem"]}], "\[SpanFromLeft]"}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  TestReportObject[<|
   "Title" -> Automatic, "Aborted" -> False, 
    "TestResults" -> <|
     4703637773967450255 -> 
      TestObject[<|
        "MetaInformation" -> None, "AbsoluteTime" -> 3.8949755148313847`*^9, 
         "SameTest" -> ($CellContext`myQWithinExpressionQ[#] == #2& ), 
         "SameMessages" -> Testing`MessageMatchQ, "MemoryConstraint" -> 
         DirectedInfinity[1], "TimeConstraint" -> DirectedInfinity[1], 
         "CreationID" -> "fb859b59-9cf7-4585-b8a0-262124d60501", "TestID" -> 
         "8597f48c-5968-4d71-b784-bd13651c719b", "TestFileName" -> "", 
         "EvaluationID" -> "59248cc9-f369-43da-978f-beb1c27e49c8", "Input" -> 
         HoldForm[$CellContext`b $CellContext`d], "ExpectedOutput" -> 
         HoldForm[False], "ExpectedMessages" -> HoldForm[{}], "ActualOutput" -> 
         HoldForm[$CellContext`b $CellContext`d], "ActualMessages" -> {}, 
         "AbsoluteTimeUsed" -> 0``7.150514997831988, "CPUTimeUsed" -> 0., 
         "MemoryUsed" -> 2152, "Outcome" -> "Success"|>], 7194249459347865311 -> 
      TestObject[<|
        "MetaInformation" -> None, "AbsoluteTime" -> 3.8949755148313847`*^9, 
         "SameTest" -> ($CellContext`myQWithinExpressionQ[#] == #2& ), 
         "SameMessages" -> Testing`MessageMatchQ, "MemoryConstraint" -> 
         DirectedInfinity[1], "TimeConstraint" -> DirectedInfinity[1], 
         "CreationID" -> "f8443332-ea6d-4078-8191-b0afea29f6b9", "TestID" -> 
         "469b6c47-bc5d-473d-9e92-f64edbf645b5", "TestFileName" -> "", 
         "EvaluationID" -> "3fdb3916-d1ad-4264-83ed-b017e565b2c7", "Input" -> 
         HoldForm[($CellContext`b^2 $CellContext`d^2) $CellContext`q^2], 
         "ExpectedOutput" -> HoldForm[True], "ExpectedMessages" -> 
         HoldForm[{}], "ActualOutput" -> 
         HoldForm[($CellContext`b^2 $CellContext`d^2) $CellContext`q^2], 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         0.0006032`3.9309763306937073, "CPUTimeUsed" -> 0., "MemoryUsed" -> 
         2544, "Outcome" -> "Success"|>], 503140813721197662 -> 
      TestObject[<|
        "MetaInformation" -> None, "AbsoluteTime" -> 3.8949755148325334`*^9, 
         "SameTest" -> ($CellContext`myQWithinExpressionQ[#] == #2& ), 
         "SameMessages" -> Testing`MessageMatchQ, "MemoryConstraint" -> 
         DirectedInfinity[1], "TimeConstraint" -> DirectedInfinity[1], 
         "CreationID" -> "d4ea5852-8e96-4918-8628-c69108596c20", "TestID" -> 
         "dd16a253-8190-453d-8b82-04ad766f3607", "TestFileName" -> "", 
         "EvaluationID" -> "824896fd-2d61-4813-a091-4f8ec63a2cd0", "Input" -> 
         HoldForm[((($CellContext`a^2 $CellContext`b) $CellContext`d^2) \
$CellContext`q) $CellContext`s^4], "ExpectedOutput" -> HoldForm[True], 
         "ExpectedMessages" -> HoldForm[{}], "ActualOutput" -> 
         HoldForm[((($CellContext`a^2 $CellContext`b) $CellContext`d^2) \
$CellContext`q) $CellContext`s^4], "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         0``7.1505149978319915, "CPUTimeUsed" -> 0., "MemoryUsed" -> 2184, 
         "Outcome" -> "Success"|>]|>, "FailureResults" -> <||>, 
    "TestsNotEvaluatedKeys" -> {}, "TestsFailedWrongResultsKeys" -> {}, 
    "TestsFailedWithMessagesKeys" -> {}, "TestsFailedWithErrorsKeys" -> {}, 
    "TestsSucceededKeys" -> {4703637773967450255, 7194249459347865311, 
     503140813721197662}|>],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.894970632563512*^9, 3.894970658447559*^9}, 
   3.894970698934829*^9, 3.894970792840955*^9, 3.8949755148763833`*^9},
 CellLabel->"Out[25]=",
 CellID->466247083,ExpressionUUID->"a2d3cb23-f362-4b5c-a1bc-da580aaa66bf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["There is now the function QWithinExpressionQ built in.", "MathCaption",
 CellChangeTimes->{{3.8949754222456226`*^9, 3.8949754324102144`*^9}},
 CellID->860484422,ExpressionUUID->"97132d86-e5d0-45e3-802f-58f9f0f39315"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QWithinExpressionQ", "/@", 
  RowBox[{"{", 
   RowBox[{
   "expressionWithNoQ", ",", "qraisedtothepower", ",", "exampleInput"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.8949754330826454`*^9, 3.894975437746332*^9}, {
  3.894975521344624*^9, 3.8949755339470797`*^9}},
 CellLabel->"In[27]:=",
 CellID->200160651,ExpressionUUID->"add0c371-31b9-4367-bc72-eb4c040e00e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.894975527420882*^9, 3.894975534196209*^9}},
 CellLabel->"Out[27]=",
 CellID->5616810,ExpressionUUID->"167bdd41-fd93-47ac-ab49-db1c26338de0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Let's look at two examples and try to find some similarities:\
\>", "MathCaption",
 CellChangeTimes->{{3.8949756188526716`*^9, 3.894975630321536*^9}},
 CellID->38347245,ExpressionUUID->"9c17d504-b7ec-49f5-aa76-01b975d8b4ff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Multicolumn", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ExpressionTree", "[", "exampleInput", "]"}], ",", 
    RowBox[{"ExpressionTree", "[", "qraisedtothepower", "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.894975631196563*^9, 3.8949756796603947`*^9}},
 CellLabel->"In[31]:=",
 CellID->26282727,ExpressionUUID->"724adc3c-0673-4c79-83a0-9b35580656c0"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[
      NamespaceBox["Trees",
       DynamicModuleBox[{Typeset`tree = HoldComplete[
         Tree[Times, {
           Tree[Power, {
             Tree[$CellContext`a, None], 
             Tree[2, None]}], 
           Tree[$CellContext`b, None], 
           Tree[Power, {
             Tree[$CellContext`d, None], 
             Tree[2, None]}], 
           Tree[$CellContext`q, None], 
           Tree[Power, {
             Tree[$CellContext`s, None], 
             Tree[4, None]}]}]]}, 
        NamespaceBox[{
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
             0.3496029493900505, 0.7574021974529568}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
             1.0488088481701514`, 0.7574021974529568}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
             1.7480147469502525`, 0.7574021974529568}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
             2.4472206457303534`, 0.7574021974529568}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
             3.1464265445104544`, 0.7574021974529568}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{0.3496029493900505, 0.7574021974529568}, {0., 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{0.3496029493900505, 0.7574021974529568}, {
             0.699205898780101, 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7480147469502525`, 0.7574021974529568}, {
             1.398411797560202, 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7480147469502525`, 0.7574021974529568}, {
             2.097617696340303, 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{3.1464265445104544`, 0.7574021974529568}, {
             2.796823595120404, 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{3.1464265445104544`, 0.7574021974529568}, {
             3.496029493900505, 0.}}]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           TagBox[InsetBox[
             FrameBox["Times",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->4,
              StripOnInput->False], {1.7480147469502525, 1.5148043949059136}],
            "DynamicName",
            BoxID -> "VertexID$1"], 
           TagBox[InsetBox[
             FrameBox["Power",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->4,
              StripOnInput->False], {0.3496029493900505, 0.7574021974529568}],
            "DynamicName",
            BoxID -> "VertexID$2"], 
           TagBox[InsetBox[
             FrameBox["a",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {0., 0.}],
            "DynamicName",
            BoxID -> "VertexID$3"], 
           TagBox[InsetBox[
             FrameBox["2",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {0.699205898780101, 0.}],
            "DynamicName",
            BoxID -> "VertexID$4"], 
           TagBox[InsetBox[
             FrameBox["b",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {1.0488088481701514, 0.7574021974529568}],
            "DynamicName",
            BoxID -> "VertexID$5"], 
           TagBox[InsetBox[
             FrameBox["Power",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->4,
              StripOnInput->False], {1.7480147469502525, 0.7574021974529568}],
            "DynamicName",
            BoxID -> "VertexID$6"], 
           TagBox[InsetBox[
             FrameBox["d",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {1.398411797560202, 0.}],
            "DynamicName",
            BoxID -> "VertexID$7"], 
           TagBox[InsetBox[
             FrameBox["2",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {2.097617696340303, 0.}],
            "DynamicName",
            BoxID -> "VertexID$8"], 
           TagBox[InsetBox[
             FrameBox["q",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {2.4472206457303534, 0.7574021974529568}],
            "DynamicName",
            BoxID -> "VertexID$9"], 
           TagBox[InsetBox[
             FrameBox["Power",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->4,
              StripOnInput->False], {3.1464265445104544, 0.7574021974529568}],
            "DynamicName",
            BoxID -> "VertexID$10"], 
           TagBox[InsetBox[
             FrameBox["s",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {2.796823595120404, 0.}],
            "DynamicName",
            BoxID -> "VertexID$11"], 
           TagBox[InsetBox[
             FrameBox["4",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {3.496029493900505, 0.}],
            "DynamicName",
            BoxID -> "VertexID$12"]}}]]],
      AlignmentPoint->Center,
      Axes->False,
      AxesLabel->None,
      AxesOrigin->Automatic,
      AxesStyle->{},
      Background->None,
      BaseStyle->{},
      BaselinePosition->Automatic,
      ContentSelectable->Automatic,
      DefaultBaseStyle->"TreeGraphics",
      Epilog->{},
      FormatType->StandardForm,
      Frame->False,
      FrameLabel->None,
      FrameStyle->{},
      FrameTicks->None,
      FrameTicksStyle->{},
      GridLines->None,
      GridLinesStyle->{},
      ImageMargins->0.,
      ImagePadding->All,
      ImageSize->Automatic,
      LabelStyle->{},
      PlotLabel->None,
      PlotRange->All,
      PlotRangeClipping->False,
      PlotRangePadding->Automatic,
      PlotRegion->Automatic,
      Prolog->{},
      RotateLabel->True,
      Ticks->Automatic,
      TicksStyle->{}], 
     GraphicsBox[
      NamespaceBox["Trees",
       DynamicModuleBox[{Typeset`tree = HoldComplete[
         Tree[Times, {
           Tree[Power, {
             Tree[$CellContext`b, None], 
             Tree[2, None]}], 
           Tree[Power, {
             Tree[$CellContext`d, None], 
             Tree[2, None]}], 
           Tree[Power, {
             Tree[$CellContext`q, None], 
             Tree[2, None]}]}]]}, 
        NamespaceBox[{
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
             0.34874291623145787`, 0.7555526554078994}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
             1.7437145811572892`, 0.7555526554078994}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
             3.1386862460831204`, 0.7555526554078994}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{0.34874291623145787`, 0.7555526554078994}, {0., 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{0.34874291623145787`, 0.7555526554078994}, {
             0.6974858324629157, 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7437145811572892`, 0.7555526554078994}, {
             1.3949716649258315`, 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{1.7437145811572892`, 0.7555526554078994}, {
             2.092457497388747, 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{3.1386862460831204`, 0.7555526554078994}, {
             2.789943329851663, 0.}}]}, 
           {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
            AbsoluteThickness[1], 
            LineBox[{{3.1386862460831204`, 0.7555526554078994}, {
             3.4874291623145783`, 0.}}]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           TagBox[InsetBox[
             FrameBox["Times",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->4,
              StripOnInput->False], {1.7437145811572892, 1.5111053108157988}],
            "DynamicName",
            BoxID -> "VertexID$1"], 
           TagBox[InsetBox[
             FrameBox["Power",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->4,
              StripOnInput->False], {0.34874291623145787, 0.7555526554078994}],
            "DynamicName",
            BoxID -> "VertexID$2"], 
           TagBox[InsetBox[
             FrameBox["b",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {0., 0.}],
            "DynamicName",
            BoxID -> "VertexID$3"], 
           TagBox[InsetBox[
             FrameBox["2",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {0.6974858324629157, 0.}],
            "DynamicName",
            BoxID -> "VertexID$4"], 
           TagBox[InsetBox[
             FrameBox["Power",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->4,
              StripOnInput->False], {1.7437145811572892, 0.7555526554078994}],
            "DynamicName",
            BoxID -> "VertexID$5"], 
           TagBox[InsetBox[
             FrameBox["d",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {1.3949716649258315, 0.}],
            "DynamicName",
            BoxID -> "VertexID$6"], 
           TagBox[InsetBox[
             FrameBox["2",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {2.092457497388747, 0.}],
            "DynamicName",
            BoxID -> "VertexID$7"], 
           TagBox[InsetBox[
             FrameBox["Power",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->4,
              StripOnInput->False], {3.1386862460831204, 0.7555526554078994}],
            "DynamicName",
            BoxID -> "VertexID$8"], 
           TagBox[InsetBox[
             FrameBox["q",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {2.789943329851663, 0.}],
            "DynamicName",
            BoxID -> "VertexID$9"], 
           TagBox[InsetBox[
             FrameBox["2",
              Background->Directive[
                RGBColor[
                0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
              BaseStyle->GrayLevel[0],
              FrameMargins->{{2, 2}, {1, 1}},
              FrameStyle->Directive[
                RGBColor[
                0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
                AbsoluteThickness[1], 
                Opacity[1]],
              ImageSize->Automatic,
              RoundingRadius->0,
              StripOnInput->False], {3.4874291623145783, 0.}],
            "DynamicName",
            BoxID -> "VertexID$10"]}}]]],
      AlignmentPoint->Center,
      Axes->False,
      AxesLabel->None,
      AxesOrigin->Automatic,
      AxesStyle->{},
      Background->None,
      BaseStyle->{},
      BaselinePosition->Automatic,
      ContentSelectable->Automatic,
      DefaultBaseStyle->"TreeGraphics",
      Epilog->{},
      FormatType->StandardForm,
      Frame->False,
      FrameLabel->None,
      FrameStyle->{},
      FrameTicks->None,
      FrameTicksStyle->{},
      GridLines->None,
      GridLinesStyle->{},
      ImageMargins->0.,
      ImagePadding->All,
      ImageSize->Automatic,
      LabelStyle->{},
      PlotLabel->None,
      PlotRange->All,
      PlotRangeClipping->False,
      PlotRangePadding->Automatic,
      PlotRegion->Automatic,
      Prolog->{},
      RotateLabel->True,
      Ticks->Automatic,
      TicksStyle->{}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.8949756801876383`*^9},
 CellLabel->"Out[31]=",
 CellID->434215884,ExpressionUUID->"cfcbbb5c-53db-400b-b113-44c26b8cecc7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeSelect", "[", 
  RowBox[{
   RowBox[{"ExpressionTree", "[", "exampleInput", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TreeData", "[", "#", "]"}], "==", "Times"}], "&&", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"TreeData", "/@", 
        RowBox[{"TreeLeaves", "[", "#", "]"}]}], ",", "q"}], "]"}]}], "&"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.89497572121375*^9, 3.894975736546118*^9}, {
  3.894975767607016*^9, 3.8949757836017385`*^9}},
 CellLabel->"In[34]:=",
 CellID->466437509,ExpressionUUID->"b4839ee4-2c41-4b36-94a0-7b8578dcef1d"],

Cell[BoxData[
 RowBox[{"{", 
  GraphicsBox[
   NamespaceBox["Trees",
    DynamicModuleBox[{Typeset`tree = HoldComplete[
      Tree[Times, {
        Tree[Power, {
          Tree[$CellContext`a, None], 
          Tree[2, None]}], 
        Tree[$CellContext`b, None], 
        Tree[Power, {
          Tree[$CellContext`d, None], 
          Tree[2, None]}], 
        Tree[$CellContext`q, None], 
        Tree[Power, {
          Tree[$CellContext`s, None], 
          Tree[4, None]}]}]]}, 
     NamespaceBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
          0.3496029493900505, 0.7574021974529568}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
          1.0488088481701514`, 0.7574021974529568}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
          1.7480147469502525`, 0.7574021974529568}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
          2.4472206457303534`, 0.7574021974529568}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{1.7480147469502525`, 1.5148043949059136`}, {
          3.1464265445104544`, 0.7574021974529568}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{0.3496029493900505, 0.7574021974529568}, {0., 0.}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{0.3496029493900505, 0.7574021974529568}, {
          0.699205898780101, 0.}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{1.7480147469502525`, 0.7574021974529568}, {
          1.398411797560202, 0.}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{1.7480147469502525`, 0.7574021974529568}, {
          2.097617696340303, 0.}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{3.1464265445104544`, 0.7574021974529568}, {
          2.796823595120404, 0.}}]}, 
        {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
         AbsoluteThickness[1], 
         LineBox[{{3.1464265445104544`, 0.7574021974529568}, {
          3.496029493900505, 0.}}]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        TagBox[InsetBox[
          FrameBox["Times",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->4,
           StripOnInput->False], {1.7480147469502525, 1.5148043949059136}],
         "DynamicName",
         BoxID -> "VertexID$1"], 
        TagBox[InsetBox[
          FrameBox["Power",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->4,
           StripOnInput->False], {0.3496029493900505, 0.7574021974529568}],
         "DynamicName",
         BoxID -> "VertexID$2"], 
        TagBox[InsetBox[
          FrameBox["a",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->0,
           StripOnInput->False], {0., 0.}],
         "DynamicName",
         BoxID -> "VertexID$3"], 
        TagBox[InsetBox[
          FrameBox["2",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->0,
           StripOnInput->False], {0.699205898780101, 0.}],
         "DynamicName",
         BoxID -> "VertexID$4"], 
        TagBox[InsetBox[
          FrameBox["b",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->0,
           StripOnInput->False], {1.0488088481701514, 0.7574021974529568}],
         "DynamicName",
         BoxID -> "VertexID$5"], 
        TagBox[InsetBox[
          FrameBox["Power",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->4,
           StripOnInput->False], {1.7480147469502525, 0.7574021974529568}],
         "DynamicName",
         BoxID -> "VertexID$6"], 
        TagBox[InsetBox[
          FrameBox["d",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->0,
           StripOnInput->False], {1.398411797560202, 0.}],
         "DynamicName",
         BoxID -> "VertexID$7"], 
        TagBox[InsetBox[
          FrameBox["2",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->0,
           StripOnInput->False], {2.097617696340303, 0.}],
         "DynamicName",
         BoxID -> "VertexID$8"], 
        TagBox[InsetBox[
          FrameBox["q",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->0,
           StripOnInput->False], {2.4472206457303534, 0.7574021974529568}],
         "DynamicName",
         BoxID -> "VertexID$9"], 
        TagBox[InsetBox[
          FrameBox["Power",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->4,
           StripOnInput->False], {3.1464265445104544, 0.7574021974529568}],
         "DynamicName",
         BoxID -> "VertexID$10"], 
        TagBox[InsetBox[
          FrameBox["s",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->0,
           StripOnInput->False], {2.796823595120404, 0.}],
         "DynamicName",
         BoxID -> "VertexID$11"], 
        TagBox[InsetBox[
          FrameBox["4",
           Background->Directive[
             RGBColor[
             0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
           BaseStyle->GrayLevel[0],
           FrameMargins->{{2, 2}, {1, 1}},
           FrameStyle->Directive[
             RGBColor[
             0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
             AbsoluteThickness[1], 
             Opacity[1]],
           ImageSize->Automatic,
           RoundingRadius->0,
           StripOnInput->False], {3.496029493900505, 0.}],
         "DynamicName",
         BoxID -> "VertexID$12"]}}]]],
   AlignmentPoint->Center,
   Axes->False,
   AxesLabel->None,
   AxesOrigin->Automatic,
   AxesStyle->{},
   Background->None,
   BaseStyle->{},
   BaselinePosition->Automatic,
   ContentSelectable->Automatic,
   DefaultBaseStyle->"TreeGraphics",
   Epilog->{},
   FormatType->StandardForm,
   Frame->False,
   FrameLabel->None,
   FrameStyle->{},
   FrameTicks->None,
   FrameTicksStyle->{},
   GridLines->None,
   GridLinesStyle->{},
   ImageMargins->0.,
   ImagePadding->All,
   ImageSize->Automatic,
   LabelStyle->{},
   PlotLabel->None,
   PlotRange->All,
   PlotRangeClipping->False,
   PlotRangePadding->Automatic,
   PlotRegion->Automatic,
   Prolog->{},
   RotateLabel->True,
   Ticks->Automatic,
   TicksStyle->{}], "}"}]], "Output",
 CellChangeTimes->{{3.894975729680859*^9, 3.8949757388091745`*^9}, 
   3.894975784063511*^9},
 CellLabel->"Out[34]=",
 CellID->581867833,ExpressionUUID->"5c162d0f-d327-443a-a8bc-5f4ac9e44d7f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Let's add Times but without a q:", "MathCaption",
 CellChangeTimes->{{3.8949757915194283`*^9, 3.8949757971558094`*^9}},
 CellID->46456499,ExpressionUUID->"c3f2f89c-9482-4f53-98b1-6c9fc2a23c33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"complicatedexpression", "=", 
  FractionBox["exampleInput", 
   RowBox[{"expressionWithNoQ", "+", "qraisedtothepower"}]]}]], "Input",
 CellChangeTimes->{{3.894975819159013*^9, 3.8949758279289975`*^9}},
 CellLabel->"In[39]:=",
 CellID->30529297,ExpressionUUID->"546a60cf-d081-49f5-aa14-fa702e72a761"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["a", "2"], " ", "b", " ", 
   SuperscriptBox["d", "2"], " ", "q", " ", 
   SuperscriptBox["s", "4"]}], 
  RowBox[{
   RowBox[{"b", " ", "d"}], "+", 
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox["d", "2"], " ", 
    SuperscriptBox["q", "2"]}]}]]], "Output",
 CellChangeTimes->{{3.8949758152283583`*^9, 3.894975828243354*^9}},
 CellLabel->"Out[39]=",
 CellID->315960114,ExpressionUUID->"9103b4bb-7813-45f2-a6d7-9a32cded2b51"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpressionTree", "[", "complicatedexpression", "]"}]], "Input",
 CellChangeTimes->{3.894975831656579*^9},
 CellLabel->"In[40]:=",
 CellID->562027770,ExpressionUUID->"ab190343-3149-4f6a-8623-4ccb8dedd90a"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["Trees",
   DynamicModuleBox[{Typeset`tree = HoldComplete[
     Tree[Times, {
       Tree[Power, {
         Tree[$CellContext`a, None], 
         Tree[2, None]}], 
       Tree[$CellContext`b, None], 
       Tree[Power, {
         Tree[$CellContext`d, None], 
         Tree[2, None]}], 
       Tree[$CellContext`q, None], 
       Tree[Power, {
         Tree[Plus, {
           Tree[Times, {
             Tree[$CellContext`b, None], 
             Tree[$CellContext`d, None]}], 
           Tree[Times, {
             Tree[Power, {
               Tree[$CellContext`b, None], 
               Tree[2, None]}], 
             Tree[Power, {
               Tree[$CellContext`d, None], 
               Tree[2, None]}], 
             Tree[Power, {
               Tree[$CellContext`q, None], 
               Tree[2, None]}]}]}], 
         Tree[-1, None]}], 
       Tree[Power, {
         Tree[$CellContext`s, None], 
         Tree[4, None]}]}]]}, 
    NamespaceBox[{
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.021301775466617948`], 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.187420884645266, 3.2305571152089323`}, {
         0.3124886978064666, 2.5844456921671464`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.187420884645266, 3.2305571152089323`}, {
         0.9374660934193997, 2.5844456921671464`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.187420884645266, 3.2305571152089323`}, {
         1.5624434890323329`, 2.5844456921671464`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.187420884645266, 3.2305571152089323`}, {2.187420884645266,
          2.5844456921671464`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.187420884645266, 3.2305571152089323`}, {
         2.8123982802581993`, 2.5844456921671464`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.187420884645266, 3.2305571152089323`}, {4.062353071484066,
          2.5844456921671464`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{0.3124886978064666, 2.5844456921671464`}, {0., 
         1.9383342691253593`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{0.3124886978064666, 2.5844456921671464`}, {
         0.6249773956129332, 1.9383342691253593`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.5624434890323329`, 2.5844456921671464`}, {
         1.2499547912258664`, 1.9383342691253593`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.5624434890323329`, 2.5844456921671464`}, {
         1.8749321868387994`, 1.9383342691253593`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.8123982802581993`, 2.5844456921671464`}, {
         2.499909582451733, 1.9383342691253593`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.8123982802581993`, 2.5844456921671464`}, {
         3.1248869780646658`, 1.9383342691253593`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.499909582451733, 1.9383342691253593`}, {
         1.4061991401290996`, 1.2922228460835732`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.499909582451733, 1.9383342691253593`}, {
         3.5936200247743657`, 1.2922228460835732`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.4061991401290996`, 1.2922228460835732`}, {
         1.093710442322633, 0.6461114230417864}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.4061991401290996`, 1.2922228460835732`}, {
         1.7186878379355661`, 0.6461114230417864}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.5936200247743657`, 1.2922228460835732`}, {
         2.3436652335484993`, 0.6461114230417864}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.5936200247743657`, 1.2922228460835732`}, {
         3.5936200247743657`, 0.6461114230417864}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.5936200247743657`, 1.2922228460835732`}, {
         4.843574816000232, 0.6461114230417864}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.3436652335484993`, 0.6461114230417864}, {
         2.031176535742033, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.3436652335484993`, 0.6461114230417864}, {
         2.656153931354966, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.5936200247743657`, 0.6461114230417864}, {
         3.281131326967899, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.5936200247743657`, 0.6461114230417864}, {
         3.906108722580832, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{4.843574816000232, 0.6461114230417864}, {4.531086118193765, 
         0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{4.843574816000232, 0.6461114230417864}, {5.156063513806698, 
         0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{4.062353071484066, 2.5844456921671464`}, {
         3.7498643736775987`, 1.9383342691253593`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{4.062353071484066, 2.5844456921671464`}, {4.374841769290532,
          1.9383342691253593`}}]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
       TagBox[InsetBox[
         FrameBox["Times",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {2.187420884645266, 3.2305571152089323}],
        "DynamicName",
        BoxID -> "VertexID$1"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {0.3124886978064666, 2.5844456921671464}],
        "DynamicName",
        BoxID -> "VertexID$2"], 
       TagBox[InsetBox[
         FrameBox["a",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {0., 1.9383342691253593}],
        "DynamicName",
        BoxID -> "VertexID$3"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {0.6249773956129332, 1.9383342691253593}],
        "DynamicName",
        BoxID -> "VertexID$4"], 
       TagBox[InsetBox[
         FrameBox["b",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {0.9374660934193997, 2.5844456921671464}],
        "DynamicName",
        BoxID -> "VertexID$5"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {1.5624434890323329, 2.5844456921671464}],
        "DynamicName",
        BoxID -> "VertexID$6"], 
       TagBox[InsetBox[
         FrameBox["d",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {1.2499547912258664, 1.9383342691253593}],
        "DynamicName",
        BoxID -> "VertexID$7"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {1.8749321868387994, 1.9383342691253593}],
        "DynamicName",
        BoxID -> "VertexID$8"], 
       TagBox[InsetBox[
         FrameBox["q",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.187420884645266, 2.5844456921671464}],
        "DynamicName",
        BoxID -> "VertexID$9"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {2.8123982802581993, 2.5844456921671464}],
        "DynamicName",
        BoxID -> "VertexID$10"], 
       TagBox[InsetBox[
         FrameBox["Plus",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {2.499909582451733, 1.9383342691253593}],
        "DynamicName",
        BoxID -> "VertexID$11"], 
       TagBox[InsetBox[
         FrameBox["Times",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {1.4061991401290996, 1.2922228460835732}],
        "DynamicName",
        BoxID -> "VertexID$12"], 
       TagBox[InsetBox[
         FrameBox["b",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {1.093710442322633, 0.6461114230417864}],
        "DynamicName",
        BoxID -> "VertexID$13"], 
       TagBox[InsetBox[
         FrameBox["d",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {1.7186878379355661, 0.6461114230417864}],
        "DynamicName",
        BoxID -> "VertexID$14"], 
       TagBox[InsetBox[
         FrameBox["Times",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {3.5936200247743657, 1.2922228460835732}],
        "DynamicName",
        BoxID -> "VertexID$15"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {2.3436652335484993, 0.6461114230417864}],
        "DynamicName",
        BoxID -> "VertexID$16"], 
       TagBox[InsetBox[
         FrameBox["b",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.031176535742033, 0.}],
        "DynamicName",
        BoxID -> "VertexID$17"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.656153931354966, 0.}],
        "DynamicName",
        BoxID -> "VertexID$18"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {3.5936200247743657, 0.6461114230417864}],
        "DynamicName",
        BoxID -> "VertexID$19"], 
       TagBox[InsetBox[
         FrameBox["d",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {3.281131326967899, 0.}],
        "DynamicName",
        BoxID -> "VertexID$20"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {3.906108722580832, 0.}],
        "DynamicName",
        BoxID -> "VertexID$21"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {4.843574816000232, 0.6461114230417864}],
        "DynamicName",
        BoxID -> "VertexID$22"], 
       TagBox[InsetBox[
         FrameBox["q",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {4.531086118193765, 0.}],
        "DynamicName",
        BoxID -> "VertexID$23"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {5.156063513806698, 0.}],
        "DynamicName",
        BoxID -> "VertexID$24"], 
       TagBox[InsetBox[
         FrameBox[
          RowBox[{"-", "1"}],
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {3.1248869780646658, 1.9383342691253593}],
        "DynamicName",
        BoxID -> "VertexID$25"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {4.062353071484066, 2.5844456921671464}],
        "DynamicName",
        BoxID -> "VertexID$26"], 
       TagBox[InsetBox[
         FrameBox["s",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {3.7498643736775987, 1.9383342691253593}],
        "DynamicName",
        BoxID -> "VertexID$27"], 
       TagBox[InsetBox[
         FrameBox["4",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {4.374841769290532, 1.9383342691253593}],
        "DynamicName",
        BoxID -> "VertexID$28"]}}]]],
  AlignmentPoint->Center,
  Axes->False,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  ContentSelectable->Automatic,
  DefaultBaseStyle->"TreeGraphics",
  Epilog->{},
  FormatType->StandardForm,
  Frame->False,
  FrameLabel->None,
  FrameStyle->{},
  FrameTicks->None,
  FrameTicksStyle->{},
  GridLines->None,
  GridLinesStyle->{},
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  LabelStyle->{},
  PlotLabel->None,
  PlotRange->All,
  PlotRangeClipping->False,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  Prolog->{},
  RotateLabel->True,
  Ticks->Automatic,
  TicksStyle->{}]], "Output",
 CellChangeTimes->{{3.8949758092861757`*^9, 3.8949758323489494`*^9}},
 CellLabel->"Out[40]=",
 CellID->601819694,ExpressionUUID->"afcc092f-35b7-4fcc-b26b-92d5ac91f7b1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Which Times contain a q?", "MathCaption",
 CellChangeTimes->{{3.894975837933651*^9, 3.894975849312274*^9}},
 CellID->194616050,ExpressionUUID->"77777825-f8e5-4ced-be9c-4cc1309fbd28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeSelect", "[", 
  RowBox[{
   RowBox[{"ExpressionTree", "[", "complicatedexpression", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TreeData", "[", "#", "]"}], "==", "Times"}], "&&", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"TreeData", "/@", 
        RowBox[{"TreeLeaves", "[", "#", "]"}]}], ",", "q"}], "]"}]}], "&"}], 
   ",", "Infinity"}], "]"}]], "Input",
 CellChangeTimes->{{3.89497572121375*^9, 3.894975736546118*^9}, {
   3.894975767607016*^9, 3.8949758036126223`*^9}, 3.8949758542966056`*^9, {
   3.8949758919708834`*^9, 3.8949758997225504`*^9}},
 CellLabel->"In[43]:=",
 CellID->233755330,ExpressionUUID->"72c77568-5553-4447-b7b6-5d1fe557a34e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Times, {
         Tree[Power, {
           Tree[$CellContext`b, None], 
           Tree[2, None]}], 
         Tree[Power, {
           Tree[$CellContext`d, None], 
           Tree[2, None]}], 
         Tree[Power, {
           Tree[$CellContext`q, None], 
           Tree[2, None]}]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
           0.34874291623145787`, 0.7555526554078994}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
           1.7437145811572892`, 0.7555526554078994}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
           3.1386862460831204`, 0.7555526554078994}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.34874291623145787`, 0.7555526554078994}, {0., 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.34874291623145787`, 0.7555526554078994}, {
           0.6974858324629157, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 0.7555526554078994}, {
           1.3949716649258315`, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 0.7555526554078994}, {
           2.092457497388747, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.1386862460831204`, 0.7555526554078994}, {
           2.789943329851663, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.1386862460831204`, 0.7555526554078994}, {
           3.4874291623145783`, 0.}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Times",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {1.7437145811572892, 1.5111053108157988}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.34874291623145787, 0.7555526554078994}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 0.}],
          "DynamicName",
          BoxID -> "VertexID$3"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.6974858324629157, 0.}],
          "DynamicName",
          BoxID -> "VertexID$4"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {1.7437145811572892, 0.7555526554078994}],
          "DynamicName",
          BoxID -> "VertexID$5"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.3949716649258315, 0.}],
          "DynamicName",
          BoxID -> "VertexID$6"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.092457497388747, 0.}],
          "DynamicName",
          BoxID -> "VertexID$7"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {3.1386862460831204, 0.7555526554078994}],
          "DynamicName",
          BoxID -> "VertexID$8"], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.789943329851663, 0.}],
          "DynamicName",
          BoxID -> "VertexID$9"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.4874291623145783, 0.}],
          "DynamicName",
          BoxID -> "VertexID$10"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Times, {
         Tree[Power, {
           Tree[$CellContext`a, None], 
           Tree[2, None]}], 
         Tree[$CellContext`b, None], 
         Tree[Power, {
           Tree[$CellContext`d, None], 
           Tree[2, None]}], 
         Tree[$CellContext`q, None], 
         Tree[Power, {
           Tree[Plus, {
             Tree[Times, {
               Tree[$CellContext`b, None], 
               Tree[$CellContext`d, None]}], 
             Tree[Times, {
               Tree[Power, {
                 Tree[$CellContext`b, None], 
                 Tree[2, None]}], 
               Tree[Power, {
                 Tree[$CellContext`d, None], 
                 Tree[2, None]}], 
               Tree[Power, {
                 Tree[$CellContext`q, None], 
                 Tree[2, None]}]}]}], 
           Tree[-1, None]}], 
         Tree[Power, {
           Tree[$CellContext`s, None], 
           Tree[4, None]}]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.021301775466617948`], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           0.3124886978064666, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           0.9374660934193997, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           1.5624434890323329`, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           2.187420884645266, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           2.8123982802581993`, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           4.062353071484066, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.3124886978064666, 2.5844456921671464`}, {0., 
           1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.3124886978064666, 2.5844456921671464`}, {
           0.6249773956129332, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.5624434890323329`, 2.5844456921671464`}, {
           1.2499547912258664`, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.5624434890323329`, 2.5844456921671464`}, {
           1.8749321868387994`, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.8123982802581993`, 2.5844456921671464`}, {
           2.499909582451733, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.8123982802581993`, 2.5844456921671464`}, {
           3.1248869780646658`, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.499909582451733, 1.9383342691253593`}, {
           1.4061991401290996`, 1.2922228460835732`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.499909582451733, 1.9383342691253593`}, {
           3.5936200247743657`, 1.2922228460835732`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.4061991401290996`, 1.2922228460835732`}, {
           1.093710442322633, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.4061991401290996`, 1.2922228460835732`}, {
           1.7186878379355661`, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 1.2922228460835732`}, {
           2.3436652335484993`, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 1.2922228460835732`}, {
           3.5936200247743657`, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 1.2922228460835732`}, {
           4.843574816000232, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.3436652335484993`, 0.6461114230417864}, {
           2.031176535742033, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.3436652335484993`, 0.6461114230417864}, {
           2.656153931354966, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 0.6461114230417864}, {
           3.281131326967899, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 0.6461114230417864}, {
           3.906108722580832, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{4.843574816000232, 0.6461114230417864}, {
           4.531086118193765, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{4.843574816000232, 0.6461114230417864}, {
           5.156063513806698, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{4.062353071484066, 2.5844456921671464`}, {
           3.7498643736775987`, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{4.062353071484066, 2.5844456921671464`}, {
           4.374841769290532, 1.9383342691253593`}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Times",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {2.187420884645266, 3.2305571152089323}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.3124886978064666, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["a",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$3"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.6249773956129332, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$4"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.9374660934193997, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$5"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {1.5624434890323329, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$6"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.2499547912258664, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$7"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.8749321868387994, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$8"], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.187420884645266, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$9"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {2.8123982802581993, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$10"], 
         TagBox[InsetBox[
           FrameBox["Plus",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {2.499909582451733, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$11"], 
         TagBox[InsetBox[
           FrameBox["Times",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {1.4061991401290996, 1.2922228460835732}],
          "DynamicName",
          BoxID -> "VertexID$12"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.093710442322633, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$13"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.7186878379355661, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$14"], 
         TagBox[InsetBox[
           FrameBox["Times",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {3.5936200247743657, 1.2922228460835732}],
          "DynamicName",
          BoxID -> "VertexID$15"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {2.3436652335484993, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$16"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.031176535742033, 0.}],
          "DynamicName",
          BoxID -> "VertexID$17"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.656153931354966, 0.}],
          "DynamicName",
          BoxID -> "VertexID$18"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {3.5936200247743657, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$19"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.281131326967899, 0.}],
          "DynamicName",
          BoxID -> "VertexID$20"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.906108722580832, 0.}],
          "DynamicName",
          BoxID -> "VertexID$21"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {4.843574816000232, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$22"], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {4.531086118193765, 0.}],
          "DynamicName",
          BoxID -> "VertexID$23"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {5.156063513806698, 0.}],
          "DynamicName",
          BoxID -> "VertexID$24"], 
         TagBox[InsetBox[
           FrameBox[
            RowBox[{"-", "1"}],
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.1248869780646658, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$25"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {4.062353071484066, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$26"], 
         TagBox[InsetBox[
           FrameBox["s",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.7498643736775987, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$27"], 
         TagBox[InsetBox[
           FrameBox["4",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {4.374841769290532, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$28"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->{454.19999999999993`, Automatic},
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8949758041610613`*^9, 3.894975855079266*^9, {3.8949758941742306`*^9, 
   3.8949759002775073`*^9}},
 CellLabel->"Out[43]=",
 CellID->147590346,ExpressionUUID->"dce34231-e31a-474d-8db2-47053a02cbd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeSelect", "[", 
  RowBox[{
   RowBox[{"ExpressionTree", "[", "complicatedexpression", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"TreeData", "[", "#", "]"}], "==", "Times"}], "&"}], ",", 
   "Infinity"}], "]"}]], "Input",
 CellChangeTimes->{{3.89497572121375*^9, 3.894975736546118*^9}, {
   3.894975767607016*^9, 3.8949758036126223`*^9}, 3.8949758542966056`*^9, {
   3.8949758919708834`*^9, 3.8949758997225504`*^9}, {3.8949759403544455`*^9, 
   3.894975945060295*^9}},
 CellLabel->"In[44]:=",
 CellID->45569491,ExpressionUUID->"c67180dc-cad8-49b0-943d-64bf7b19934b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Times, {
         Tree[$CellContext`b, None], 
         Tree[$CellContext`d, None]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {0., 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.4472135954999579, 0.8929961074943159}, {
           0.8944271909999159, 0.}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Times",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.4472135954999579, 0.8929961074943159}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 0.}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.8944271909999159, 0.}],
          "DynamicName",
          BoxID -> "VertexID$3"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Times, {
         Tree[Power, {
           Tree[$CellContext`b, None], 
           Tree[2, None]}], 
         Tree[Power, {
           Tree[$CellContext`d, None], 
           Tree[2, None]}], 
         Tree[Power, {
           Tree[$CellContext`q, None], 
           Tree[2, None]}]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
           0.34874291623145787`, 0.7555526554078994}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
           1.7437145811572892`, 0.7555526554078994}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 1.5111053108157988`}, {
           3.1386862460831204`, 0.7555526554078994}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.34874291623145787`, 0.7555526554078994}, {0., 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.34874291623145787`, 0.7555526554078994}, {
           0.6974858324629157, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 0.7555526554078994}, {
           1.3949716649258315`, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.7437145811572892`, 0.7555526554078994}, {
           2.092457497388747, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.1386862460831204`, 0.7555526554078994}, {
           2.789943329851663, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.1386862460831204`, 0.7555526554078994}, {
           3.4874291623145783`, 0.}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Times",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {1.7437145811572892, 1.5111053108157988}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.34874291623145787, 0.7555526554078994}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 0.}],
          "DynamicName",
          BoxID -> "VertexID$3"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.6974858324629157, 0.}],
          "DynamicName",
          BoxID -> "VertexID$4"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {1.7437145811572892, 0.7555526554078994}],
          "DynamicName",
          BoxID -> "VertexID$5"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.3949716649258315, 0.}],
          "DynamicName",
          BoxID -> "VertexID$6"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.092457497388747, 0.}],
          "DynamicName",
          BoxID -> "VertexID$7"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {3.1386862460831204, 0.7555526554078994}],
          "DynamicName",
          BoxID -> "VertexID$8"], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.789943329851663, 0.}],
          "DynamicName",
          BoxID -> "VertexID$9"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.4874291623145783, 0.}],
          "DynamicName",
          BoxID -> "VertexID$10"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->{301.8, Automatic},
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}], ",", 
   GraphicsBox[
    NamespaceBox["Trees",
     DynamicModuleBox[{Typeset`tree = HoldComplete[
       Tree[Times, {
         Tree[Power, {
           Tree[$CellContext`a, None], 
           Tree[2, None]}], 
         Tree[$CellContext`b, None], 
         Tree[Power, {
           Tree[$CellContext`d, None], 
           Tree[2, None]}], 
         Tree[$CellContext`q, None], 
         Tree[Power, {
           Tree[Plus, {
             Tree[Times, {
               Tree[$CellContext`b, None], 
               Tree[$CellContext`d, None]}], 
             Tree[Times, {
               Tree[Power, {
                 Tree[$CellContext`b, None], 
                 Tree[2, None]}], 
               Tree[Power, {
                 Tree[$CellContext`d, None], 
                 Tree[2, None]}], 
               Tree[Power, {
                 Tree[$CellContext`q, None], 
                 Tree[2, None]}]}]}], 
           Tree[-1, None]}], 
         Tree[Power, {
           Tree[$CellContext`s, None], 
           Tree[4, None]}]}]]}, 
      NamespaceBox[{
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.021301775466617948`], 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           0.3124886978064666, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           0.9374660934193997, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           1.5624434890323329`, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           2.187420884645266, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           2.8123982802581993`, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.187420884645266, 3.2305571152089323`}, {
           4.062353071484066, 2.5844456921671464`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.3124886978064666, 2.5844456921671464`}, {0., 
           1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{0.3124886978064666, 2.5844456921671464`}, {
           0.6249773956129332, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.5624434890323329`, 2.5844456921671464`}, {
           1.2499547912258664`, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.5624434890323329`, 2.5844456921671464`}, {
           1.8749321868387994`, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.8123982802581993`, 2.5844456921671464`}, {
           2.499909582451733, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.8123982802581993`, 2.5844456921671464`}, {
           3.1248869780646658`, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.499909582451733, 1.9383342691253593`}, {
           1.4061991401290996`, 1.2922228460835732`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.499909582451733, 1.9383342691253593`}, {
           3.5936200247743657`, 1.2922228460835732`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.4061991401290996`, 1.2922228460835732`}, {
           1.093710442322633, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{1.4061991401290996`, 1.2922228460835732`}, {
           1.7186878379355661`, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 1.2922228460835732`}, {
           2.3436652335484993`, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 1.2922228460835732`}, {
           3.5936200247743657`, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 1.2922228460835732`}, {
           4.843574816000232, 0.6461114230417864}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.3436652335484993`, 0.6461114230417864}, {
           2.031176535742033, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{2.3436652335484993`, 0.6461114230417864}, {
           2.656153931354966, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 0.6461114230417864}, {
           3.281131326967899, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{3.5936200247743657`, 0.6461114230417864}, {
           3.906108722580832, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{4.843574816000232, 0.6461114230417864}, {
           4.531086118193765, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{4.843574816000232, 0.6461114230417864}, {
           5.156063513806698, 0.}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{4.062353071484066, 2.5844456921671464`}, {
           3.7498643736775987`, 1.9383342691253593`}}]}, 
         {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
          AbsoluteThickness[1], 
          LineBox[{{4.062353071484066, 2.5844456921671464`}, {
           4.374841769290532, 1.9383342691253593`}}]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         TagBox[InsetBox[
           FrameBox["Times",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {2.187420884645266, 3.2305571152089323}],
          "DynamicName",
          BoxID -> "VertexID$1"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {0.3124886978064666, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$2"], 
         TagBox[InsetBox[
           FrameBox["a",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0., 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$3"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.6249773956129332, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$4"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {0.9374660934193997, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$5"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {1.5624434890323329, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$6"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.2499547912258664, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$7"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.8749321868387994, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$8"], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.187420884645266, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$9"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {2.8123982802581993, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$10"], 
         TagBox[InsetBox[
           FrameBox["Plus",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {2.499909582451733, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$11"], 
         TagBox[InsetBox[
           FrameBox["Times",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {1.4061991401290996, 1.2922228460835732}],
          "DynamicName",
          BoxID -> "VertexID$12"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.093710442322633, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$13"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {1.7186878379355661, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$14"], 
         TagBox[InsetBox[
           FrameBox["Times",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {3.5936200247743657, 1.2922228460835732}],
          "DynamicName",
          BoxID -> "VertexID$15"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {2.3436652335484993, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$16"], 
         TagBox[InsetBox[
           FrameBox["b",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.031176535742033, 0.}],
          "DynamicName",
          BoxID -> "VertexID$17"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {2.656153931354966, 0.}],
          "DynamicName",
          BoxID -> "VertexID$18"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {3.5936200247743657, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$19"], 
         TagBox[InsetBox[
           FrameBox["d",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.281131326967899, 0.}],
          "DynamicName",
          BoxID -> "VertexID$20"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.906108722580832, 0.}],
          "DynamicName",
          BoxID -> "VertexID$21"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {4.843574816000232, 0.6461114230417864}],
          "DynamicName",
          BoxID -> "VertexID$22"], 
         TagBox[InsetBox[
           FrameBox["q",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {4.531086118193765, 0.}],
          "DynamicName",
          BoxID -> "VertexID$23"], 
         TagBox[InsetBox[
           FrameBox["2",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {5.156063513806698, 0.}],
          "DynamicName",
          BoxID -> "VertexID$24"], 
         TagBox[InsetBox[
           FrameBox[
            RowBox[{"-", "1"}],
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.1248869780646658, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$25"], 
         TagBox[InsetBox[
           FrameBox["Power",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->4,
            StripOnInput->False], {4.062353071484066, 2.5844456921671464}],
          "DynamicName",
          BoxID -> "VertexID$26"], 
         TagBox[InsetBox[
           FrameBox["s",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {3.7498643736775987, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$27"], 
         TagBox[InsetBox[
           FrameBox["4",
            Background->Directive[
              RGBColor[
              0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
            BaseStyle->GrayLevel[0],
            FrameMargins->{{2, 2}, {1, 1}},
            FrameStyle->Directive[
              RGBColor[
              0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
              AbsoluteThickness[1], 
              Opacity[1]],
            ImageSize->Automatic,
            RoundingRadius->0,
            StripOnInput->False], {4.374841769290532, 1.9383342691253593}],
          "DynamicName",
          BoxID -> "VertexID$28"]}}]]],
    AlignmentPoint->Center,
    Axes->False,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    ContentSelectable->Automatic,
    DefaultBaseStyle->"TreeGraphics",
    Epilog->{},
    FormatType->StandardForm,
    Frame->False,
    FrameLabel->None,
    FrameStyle->{},
    FrameTicks->None,
    FrameTicksStyle->{},
    GridLines->None,
    GridLinesStyle->{},
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->{280.80000000000007`, Automatic},
    LabelStyle->{},
    PlotLabel->None,
    PlotRange->All,
    PlotRangeClipping->False,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    Prolog->{},
    RotateLabel->True,
    Ticks->Automatic,
    TicksStyle->{}]}], "}"}]], "Output",
 CellChangeTimes->{3.894975946007599*^9},
 CellLabel->"Out[44]=",
 CellID->86851793,ExpressionUUID->"43022bc4-fb05-4799-b6aa-38362aa929e6"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {"XXXX", Cell[
    "XXXX", "TableText",ExpressionUUID->
     "20abe685-ebfa-41b2-9eb3-70763a2cf376"]},
   {"XXXX", Cell[
    "XXXX", "TableText",ExpressionUUID->
     "a120455c-2b93-4748-80c5-2bbc9da0b85c"]},
   {"XXXX", Cell[
    "XXXX", "TableText",ExpressionUUID->
     "719ac795-98a8-4d7b-9296-26ff2232ec52"]}
  }]], "DefinitionBox",
 CellID->771150938,ExpressionUUID->"3a120140-9199-49e4-9455-dd2ea9fc8376"],

Cell["XXXX.", "Caption",
 CellID->56681674,ExpressionUUID->"f5f60007-c978-4515-b0ad-835ba5ae7d46"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.8949765183388796`*^9, 3.8949765194373446`*^9}},
 CellID->194172257,ExpressionUUID->"19945e51-54d3-43c9-aa1b-f6fdb8d3c43e"],

Cell[CellGroupData[{

Cell["Example 1", "Subsection",
 CellChangeTimes->{{3.894976525981079*^9, 3.8949765272807703`*^9}},
 CellID->268449717,ExpressionUUID->"1e56a077-1c45-4290-8be6-0d02c8772dcc"],

Cell["\<\
Consider the input q. q is already in front. We can use AtomQ to just return \
the output.\
\>", "Text",
 CellChangeTimes->{{3.894976545316383*^9, 3.894976597391072*^9}},
 CellID->38548766,ExpressionUUID->"f43cd62e-9a36-420a-b91e-3d128127be16"],

Cell[CellGroupData[{

Cell["This", "MathCaption",
 CellChangeTimes->{{3.894976548268383*^9, 3.894976551797518*^9}},
 CellID->869928153,ExpressionUUID->"bcaa542b-05a8-40ae-8474-eb2c14e74d8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RearrangeFunction", "[", 
   RowBox[{"i_", "?", "AtomQ"}], "]"}], ":=", "i"}]], "Input",
 CellChangeTimes->{{3.894976622233094*^9, 3.8949766566388597`*^9}},
 CellLabel->"In[1]:=",
 CellID->332914739,ExpressionUUID->"2839130b-501f-465e-b1d6-f14121ff0e17"]
}, Open  ]],

Cell[CellGroupData[{

Cell["It works with q:", "MathCaption",
 CellChangeTimes->{{3.8949766665418577`*^9, 3.8949766689776316`*^9}},
 CellID->76608498,ExpressionUUID->"28ce1dcc-0757-40de-b210-523e1bf7b01e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RearrangeFunction", "[", "q", "]"}]], "Input",
 CellChangeTimes->{{3.8949766590002313`*^9, 3.8949766616527967`*^9}},
 CellLabel->"In[2]:=",
 CellID->96817370,ExpressionUUID->"cd69e59c-e6ea-4b50-9ff6-c1a65c608a37"],

Cell[BoxData["q"], "Output",
 CellChangeTimes->{3.8949766622909784`*^9},
 CellLabel->"Out[2]=",
 CellID->333277154,ExpressionUUID->"5fe6d5fd-930d-450e-9f7a-9e42e562f7e7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["It works with other symbols:", "MathCaption",
 CellChangeTimes->{{3.8949766719326577`*^9, 3.8949766764397345`*^9}},
 CellID->132842737,ExpressionUUID->"28fe1505-656f-4577-8353-f3aa193cb1a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RearrangeFunction", "[", "r", "]"}]], "Input",
 CellChangeTimes->{{3.8949766590002313`*^9, 3.894976678502855*^9}},
 CellLabel->"In[3]:=",
 CellID->384650234,ExpressionUUID->"662735f4-c64c-4559-a8a8-6e8d8f29167c"],

Cell[BoxData["r"], "Output",
 CellChangeTimes->{3.8949766788747663`*^9},
 CellLabel->"Out[3]=",
 CellID->202833461,ExpressionUUID->"62918c2d-efef-4281-85cf-fc5d34de8b89"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 2", "Subsection",
 CellChangeTimes->{{3.894976525981079*^9, 3.8949765272807703`*^9}, {
  3.894976713069312*^9, 3.8949767144114714`*^9}},
 CellID->194967963,ExpressionUUID->"6983f950-66f2-4847-b830-1bf59eecd009"],

Cell[CellGroupData[{

Cell[TextData[{
 "The next example is ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "c", " ", "d", " ", "z"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"q", " ", "a"}], ")"}]}], ")"}], "^", "2"}]], "InlineFormula",
  FormatType->StandardForm,ExpressionUUID->
  "43c0c53d-245c-46a0-9ae4-49ab528c973c"],
 "."
}], "Text",
 CellChangeTimes->{{3.8949767156086597`*^9, 3.8949767253109818`*^9}},
 CellID->185252635,ExpressionUUID->"90f00af2-676b-4b97-9811-3bd4dd7d6754"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"example2", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "c", " ", "d", " ", "z"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"q", " ", "a"}], ")"}]}], ")"}], "^", "2"}]}]], "Input",
 CellChangeTimes->{{3.8949767274095755`*^9, 3.8949767317751265`*^9}},
 CellLabel->"In[5]:=",
 CellID->250393049,ExpressionUUID->"c5c33a0d-a7c3-4ba1-a946-fcaff628af6e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["b", "2"], " ", 
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["z", "2"]}], 
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["q", "2"]}]]], "Output",
 CellChangeTimes->{{3.8949767279348917`*^9, 3.894976732141649*^9}},
 CellLabel->"Out[5]=",
 CellID->878465958,ExpressionUUID->"c29aedee-2263-4374-8164-0dd77a1007a7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["We need", "MathCaption",
 CellChangeTimes->{{3.8949767441926184`*^9, 3.8949767452976613`*^9}},
 CellID->386931535,ExpressionUUID->"3f611023-c3c0-45d3-9bc3-0bc5cdf393a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"output2", "=", 
  RowBox[{"Inactivate", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["b", "2"], 
      SuperscriptBox["c", "2"], 
      SuperscriptBox["d", "2"], 
      SuperscriptBox["z", "2"]}], 
     RowBox[{
      SuperscriptBox["q", "2"], 
      SuperscriptBox["a", "2"]}]], ",", "Times"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894976747068531*^9, 3.8949767778689585`*^9}},
 CellLabel->"In[7]:=",
 CellID->170794992,ExpressionUUID->"056d53d0-94f6-4eb4-a3a9-30502ed40cd6"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["b", "2"], 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  SuperscriptBox["c", "2"], 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  SuperscriptBox["d", "2"], 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  SuperscriptBox["z", "2"], 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["q", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["a", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.8949767739716415`*^9, 3.894976778002411*^9}},
 CellLabel->"Out[7]=",
 CellID->112160897,ExpressionUUID->"296619f3-3e80-4fd6-a0ec-c21a226deaea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputForm", "[", "output2", "]"}]], "Input",
 CellChangeTimes->{{3.894976783460842*^9, 3.894976787210737*^9}},
 CellLabel->"In[8]:=",
 CellID->200307475,ExpressionUUID->"7768e08f-1efd-4577-83cf-0b81f428b9d9"],

Cell["\<\
Inactive[Times][b^2, c^2, d^2, z^2, Inactive[Times][q^2, a^2]^
  (-1)]\
\>", "Output",
 CellChangeTimes->{3.894976787599227*^9},
 CellLabel->"Out[8]//InputForm=",
 CellID->1194021,ExpressionUUID->"3d93041f-01d3-42c1-924c-16ab8a04e539"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", "output2", "]"}]], "Input",
 CellChangeTimes->{{3.8949768222558136`*^9, 3.894976825072523*^9}},
 CellLabel->"In[9]:=",
 CellID->791122323,ExpressionUUID->"6355e096-68a8-40fa-b4cb-7f2526bf9496"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[
   TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQA2IQXXDD9OlHKxaHuX4+6xt/M0Lpi/ZvSj+1Of38Zc8A
BRDxj/YQ+qE9jO+SJC+dVPUNrh5V3Uf712jiMPtQ1cPshZnHBufv/397zyYL
Xrh6iHlccPlJnUc/KVXww/ltwo6nLKWF0cwXxFA/D+oPmPkwf27uDJ9y8rYA
nA9xrwhcPcx8mHzUXC2GVVGiGOph9gEAT62lNw==
     "], {
      {RGBColor[0.55, 0.45, 0.45], 
       LineBox[{{1, 2}, {1, 5}, {1, 8}, {1, 11}, {1, 14}, {2, 3}, {2, 4}, {5, 
        6}, {5, 7}, {8, 9}, {8, 10}, {11, 12}, {11, 13}, {14, 15}, {14, 22}, {
        15, 16}, {15, 19}, {16, 17}, {16, 18}, {19, 20}, {19, 21}}]}, {
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            RowBox[{"Inactive", "[", "Times", "]"}], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 1],
         TagBox[
          RowBox[{
            SuperscriptBox["b", "2"], 
            TagBox[
            "\[Times]", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> 
             "a*b"], 
            SuperscriptBox["c", "2"], 
            TagBox[
            "\[Times]", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> 
             "a*b"], 
            SuperscriptBox["d", "2"], 
            TagBox[
            "\[Times]", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> 
             "a*b"], 
            SuperscriptBox["z", "2"], 
            TagBox[
            "\[Times]", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> 
             "a*b"], 
            FractionBox["1", 
             RowBox[{
               SuperscriptBox["q", "2"], 
               TagBox[
               "\[Times]", "InactiveToken", BaseStyle -> "Inactive", 
                SyntaxForm -> "a*b"], 
               SuperscriptBox["a", "2"]}]]}], HoldForm]],
        Annotation[#, 
         HoldForm[
          Inactive[
          Times][$CellContext`b^2, $CellContext`c^2, $CellContext`d^2, \
$CellContext`z^2, Inactive[Times][$CellContext`q^2, $CellContext`a^2]^(-1)]], 
         "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Power", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 2],
         TagBox[
          SuperscriptBox["b", "2"], HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`b^2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["b",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 3],
         TagBox["b", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`b], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["2",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 4],
         TagBox["2", HoldForm]],
        Annotation[#, 
         HoldForm[2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Power", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 5],
         TagBox[
          SuperscriptBox["c", "2"], HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`c^2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["c",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 6],
         TagBox["c", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`c], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["2",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 7],
         TagBox["2", HoldForm]],
        Annotation[#, 
         HoldForm[2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Power", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 8],
         TagBox[
          SuperscriptBox["d", "2"], HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`d^2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["d",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 9],
         TagBox["d", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`d], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["2",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 10],
         TagBox["2", HoldForm]],
        Annotation[#, 
         HoldForm[2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Power", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 11],
         TagBox[
          SuperscriptBox["z", "2"], HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`z^2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["z",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 12],
         TagBox["z", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`z], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["2",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 13],
         TagBox["2", HoldForm]],
        Annotation[#, 
         HoldForm[2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Power", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 14],
         TagBox[
          FractionBox["1", 
           RowBox[{
             SuperscriptBox["q", "2"], 
             TagBox[
             "\[Times]", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> 
              "a*b"], 
             SuperscriptBox["a", "2"]}]], HoldForm]],
        Annotation[#, 
         HoldForm[Inactive[Times][$CellContext`q^2, $CellContext`a^2]^(-1)], 
         "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            RowBox[{"Inactive", "[", "Times", "]"}], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 15],
         TagBox[
          RowBox[{
            SuperscriptBox["q", "2"], 
            TagBox[
            "\[Times]", "InactiveToken", BaseStyle -> "Inactive", SyntaxForm -> 
             "a*b"], 
            SuperscriptBox["a", "2"]}], HoldForm]],
        Annotation[#, 
         HoldForm[
          Inactive[Times][$CellContext`q^2, $CellContext`a^2]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Power", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 16],
         TagBox[
          SuperscriptBox["q", "2"], HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`q^2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["q",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 17],
         TagBox["q", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`q], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["2",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 18],
         TagBox["2", HoldForm]],
        Annotation[#, 
         HoldForm[2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Power", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 19],
         TagBox[
          SuperscriptBox["a", "2"], HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`a^2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["a",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 20],
         TagBox["a", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`a], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["2",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 21],
         TagBox["2", HoldForm]],
        Annotation[#, 
         HoldForm[2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox[
             RowBox[{"-", "1"}],
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.032],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 22],
         TagBox[
          RowBox[{"-", "1"}], HoldForm]],
        Annotation[#, 
         HoldForm[-1], "Tooltip"]& ]}}],
    Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQA2IQXXDD9OlHKxaHuX4+6xt/M0Lpi/ZvSj+1Of38Zc8A
BRDxj/YQ+qE9jO+SJC+dVPUNrh5V3Uf712jiMPtQ1cPshZnHBufv/397zyYL
Xrh6iHlccPlJnUc/KVXww/ltwo6nLKWF0cwXxFA/D+oPmPkwf27uDJ9y8rYA
nA9xrwhcPcx8mHzUXC2GVVGiGOph9gEAT62lNw==
      "]]& ],
   AspectRatio->NCache[Rational[2, 5]^Rational[1, 2], 0.6324555320336759],
   FormatType:>StandardForm,
   FrameTicks->Automatic,
   ImageSize->{273.60000000000014`, Automatic},
   PlotRange->All,
   PlotRangePadding->Scaled[0.1]],
  TreeForm[
   Inactive[
   Times][$CellContext`b^2, $CellContext`c^2, $CellContext`d^2, \
$CellContext`z^2, Inactive[Times][$CellContext`q^2, $CellContext`a^2]^(-1)]],
  Editable->False]], "Output",
 CellChangeTimes->{3.8949768255155954`*^9},
 CellLabel->"Out[9]//TreeForm=",
 CellID->170209671,ExpressionUUID->"4493ce93-aa09-4ec8-ace9-d8028959f40d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpressionTree", "[", "output2", "]"}]], "Input",
 CellChangeTimes->{{3.894976851210536*^9, 3.894976856148093*^9}},
 CellLabel->"In[10]:=",
 CellID->66563211,ExpressionUUID->"c13fba48-4a62-4503-a2bb-e39e9bd34fa8"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["Trees",
   DynamicModuleBox[{Typeset`tree = HoldComplete[
     Tree[
      Tree[Inactive, {
        Tree[Times, None]}], {
       Tree[Power, {
         Tree[$CellContext`b, None], 
         Tree[2, None]}], 
       Tree[Power, {
         Tree[$CellContext`c, None], 
         Tree[2, None]}], 
       Tree[Power, {
         Tree[$CellContext`d, None], 
         Tree[2, None]}], 
       Tree[Power, {
         Tree[$CellContext`z, None], 
         Tree[2, None]}], 
       Tree[Power, {
         Tree[
          Tree[Inactive, {
            Tree[Times, None]}], {
           Tree[Power, {
             Tree[$CellContext`q, None], 
             Tree[2, None]}], 
           Tree[Power, {
             Tree[$CellContext`a, None], 
             Tree[2, None]}]}], 
         Tree[-1, None]}]}]]}, 
    NamespaceBox[{
      {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.02104973008516573], 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.5287816912705736`, 2.4120315285839298`}, {
         0.2809757434745082, 1.8090236464379474`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.5287816912705736`, 2.4120315285839298`}, {
         1.404878717372541, 1.8090236464379474`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.5287816912705736`, 2.4120315285839298`}, {
         2.5287816912705736`, 1.8090236464379474`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.5287816912705736`, 2.4120315285839298`}, {
         3.6526846651686067`, 1.8090236464379474`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.5287816912705736`, 2.4120315285839298`}, {
         4.776587639066639, 1.8090236464379474`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{0.2809757434745082, 1.8090236464379474`}, {0., 
         1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{0.2809757434745082, 1.8090236464379474`}, {
         0.5619514869490164, 1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.404878717372541, 1.8090236464379474`}, {
         1.1239029738980328`, 1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{1.404878717372541, 1.8090236464379474`}, {
         1.6858544608470492`, 1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.5287816912705736`, 1.8090236464379474`}, {
         2.2478059477960657`, 1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{2.5287816912705736`, 1.8090236464379474`}, {
         2.809757434745082, 1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.6526846651686067`, 1.8090236464379474`}, {
         3.3717089216940983`, 1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.6526846651686067`, 1.8090236464379474`}, {
         3.9336604086431146`, 1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{4.776587639066639, 1.8090236464379474`}, {4.495611895592131,
          1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{4.776587639066639, 1.8090236464379474`}, {5.057563382541147,
          1.2060157642919649`}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{4.495611895592131, 1.2060157642919649`}, {
         3.9336604086431146`, 0.6030078821459826}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{4.495611895592131, 1.2060157642919649`}, {5.057563382541147,
          0.6030078821459826}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.9336604086431146`, 0.6030078821459826}, {
         3.6526846651686067`, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{3.9336604086431146`, 0.6030078821459826}, {
         4.214636152117623, 0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{5.057563382541147, 0.6030078821459826}, {4.776587639066639, 
         0.}}]}, 
       {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
        AbsoluteThickness[1], 
        LineBox[{{5.057563382541147, 0.6030078821459826}, {5.338539126015656, 
         0.}}]}}, 
      {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
       TagBox[InsetBox[
         FrameBox[
          GraphicsBox[
           NamespaceBox["Trees",
            DynamicModuleBox[{Typeset`tree = HoldComplete[
              Tree[Inactive, {
                Tree[Times, None]}]]}, 
             NamespaceBox[{
               {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
                AbsoluteThickness[1], Opacity[0.7], Arrowheads[Medium], 
                LineBox[{{0., 1.}, {0., 0.}}]}, 
               {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
                TagBox[InsetBox[
                  FrameBox["Inactive",
                   Background->Directive[
                    RGBColor[
                    0.9607843137254902, 0.9882352941176471, 
                    0.9764705882352941]],
                   BaseStyle->GrayLevel[0],
                   FrameMargins->{{2, 2}, {1, 1}},
                   FrameStyle->Directive[
                    RGBColor[
                    0.4196078431372549, 0.6313725490196078, 
                    0.4196078431372549], 
                    AbsoluteThickness[1], 
                    Opacity[1]],
                   ImageSize->Automatic,
                   RoundingRadius->4,
                   StripOnInput->False], {0., 1.}],
                 "DynamicName",
                 BoxID -> "VertexID$1"], 
                TagBox[InsetBox[
                  FrameBox["Times",
                   Background->Directive[
                    RGBColor[
                    0.9607843137254902, 0.9882352941176471, 
                    0.9764705882352941]],
                   BaseStyle->GrayLevel[0],
                   FrameMargins->{{2, 2}, {1, 1}},
                   FrameStyle->Directive[
                    RGBColor[
                    0.4196078431372549, 0.6313725490196078, 
                    0.4196078431372549], 
                    AbsoluteThickness[1], 
                    Opacity[1]],
                   ImageSize->Automatic,
                   RoundingRadius->0,
                   StripOnInput->False], {0., 0.}],
                 "DynamicName",
                 BoxID -> "VertexID$2"]}}]]],
           AlignmentPoint->Center,
           Axes->False,
           AxesLabel->None,
           AxesOrigin->Automatic,
           AxesStyle->{},
           Background->None,
           BaseStyle->{},
           BaselinePosition->Automatic,
           ContentSelectable->Automatic,
           DefaultBaseStyle->"TreeGraphics",
           Epilog->{},
           FormatType->StandardForm,
           Frame->False,
           FrameLabel->None,
           FrameStyle->{},
           FrameTicks->None,
           FrameTicksStyle->{},
           GridLines->None,
           GridLinesStyle->{},
           ImageMargins->0.,
           ImagePadding->All,
           ImageSize->Automatic,
           LabelStyle->{},
           PlotLabel->None,
           PlotRange->All,
           PlotRangeClipping->False,
           PlotRangePadding->Automatic,
           PlotRegion->Automatic,
           Prolog->{},
           RotateLabel->True,
           Ticks->Automatic,
           TicksStyle->{}],
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {2.5287816912705736, 2.4120315285839298}],
        "DynamicName",
        BoxID -> "VertexID$1"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {0.2809757434745082, 1.8090236464379474}],
        "DynamicName",
        BoxID -> "VertexID$2"], 
       TagBox[InsetBox[
         FrameBox["b",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {0., 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$3"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {0.5619514869490164, 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$4"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {1.404878717372541, 1.8090236464379474}],
        "DynamicName",
        BoxID -> "VertexID$5"], 
       TagBox[InsetBox[
         FrameBox["c",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {1.1239029738980328, 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$6"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {1.6858544608470492, 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$7"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {2.5287816912705736, 1.8090236464379474}],
        "DynamicName",
        BoxID -> "VertexID$8"], 
       TagBox[InsetBox[
         FrameBox["d",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.2478059477960657, 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$9"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {2.809757434745082, 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$10"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {3.6526846651686067, 1.8090236464379474}],
        "DynamicName",
        BoxID -> "VertexID$11"], 
       TagBox[InsetBox[
         FrameBox["z",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {3.3717089216940983, 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$12"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {3.9336604086431146, 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$13"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {4.776587639066639, 1.8090236464379474}],
        "DynamicName",
        BoxID -> "VertexID$14"], 
       TagBox[InsetBox[
         FrameBox[
          GraphicsBox[
           NamespaceBox["Trees",
            DynamicModuleBox[{Typeset`tree = HoldComplete[
              Tree[Inactive, {
                Tree[Times, None]}]]}, 
             NamespaceBox[{
               {RGBColor[0.6, 0.5882352941176471, 0.5529411764705883], 
                AbsoluteThickness[1], Opacity[0.7], Arrowheads[Medium], 
                LineBox[{{0., 1.}, {0., 0.}}]}, 
               {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
                TagBox[InsetBox[
                  FrameBox["Inactive",
                   Background->Directive[
                    RGBColor[
                    0.9607843137254902, 0.9882352941176471, 
                    0.9764705882352941]],
                   BaseStyle->GrayLevel[0],
                   FrameMargins->{{2, 2}, {1, 1}},
                   FrameStyle->Directive[
                    RGBColor[
                    0.4196078431372549, 0.6313725490196078, 
                    0.4196078431372549], 
                    AbsoluteThickness[1], 
                    Opacity[1]],
                   ImageSize->Automatic,
                   RoundingRadius->4,
                   StripOnInput->False], {0., 1.}],
                 "DynamicName",
                 BoxID -> "VertexID$1"], 
                TagBox[InsetBox[
                  FrameBox["Times",
                   Background->Directive[
                    RGBColor[
                    0.9607843137254902, 0.9882352941176471, 
                    0.9764705882352941]],
                   BaseStyle->GrayLevel[0],
                   FrameMargins->{{2, 2}, {1, 1}},
                   FrameStyle->Directive[
                    RGBColor[
                    0.4196078431372549, 0.6313725490196078, 
                    0.4196078431372549], 
                    AbsoluteThickness[1], 
                    Opacity[1]],
                   ImageSize->Automatic,
                   RoundingRadius->0,
                   StripOnInput->False], {0., 0.}],
                 "DynamicName",
                 BoxID -> "VertexID$2"]}}]]],
           AlignmentPoint->Center,
           Axes->False,
           AxesLabel->None,
           AxesOrigin->Automatic,
           AxesStyle->{},
           Background->None,
           BaseStyle->{},
           BaselinePosition->Automatic,
           ContentSelectable->Automatic,
           DefaultBaseStyle->"TreeGraphics",
           Epilog->{},
           FormatType->StandardForm,
           Frame->False,
           FrameLabel->None,
           FrameStyle->{},
           FrameTicks->None,
           FrameTicksStyle->{},
           GridLines->None,
           GridLinesStyle->{},
           ImageMargins->0.,
           ImagePadding->All,
           ImageSize->Automatic,
           LabelStyle->{},
           PlotLabel->None,
           PlotRange->All,
           PlotRangeClipping->False,
           PlotRangePadding->Automatic,
           PlotRegion->Automatic,
           Prolog->{},
           RotateLabel->True,
           Ticks->Automatic,
           TicksStyle->{}],
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {4.495611895592131, 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$15"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {3.9336604086431146, 0.6030078821459826}],
        "DynamicName",
        BoxID -> "VertexID$16"], 
       TagBox[InsetBox[
         FrameBox["q",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {3.6526846651686067, 0.}],
        "DynamicName",
        BoxID -> "VertexID$17"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {4.214636152117623, 0.}],
        "DynamicName",
        BoxID -> "VertexID$18"], 
       TagBox[InsetBox[
         FrameBox["Power",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->4,
          StripOnInput->False], {5.057563382541147, 0.6030078821459826}],
        "DynamicName",
        BoxID -> "VertexID$19"], 
       TagBox[InsetBox[
         FrameBox["a",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {4.776587639066639, 0.}],
        "DynamicName",
        BoxID -> "VertexID$20"], 
       TagBox[InsetBox[
         FrameBox["2",
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {5.338539126015656, 0.}],
        "DynamicName",
        BoxID -> "VertexID$21"], 
       TagBox[InsetBox[
         FrameBox[
          RowBox[{"-", "1"}],
          Background->Directive[
            RGBColor[
            0.9607843137254902, 0.9882352941176471, 0.9764705882352941]],
          BaseStyle->GrayLevel[0],
          FrameMargins->{{2, 2}, {1, 1}},
          FrameStyle->Directive[
            RGBColor[
            0.4196078431372549, 0.6313725490196078, 0.4196078431372549], 
            AbsoluteThickness[1], 
            Opacity[1]],
          ImageSize->Automatic,
          RoundingRadius->0,
          StripOnInput->False], {5.057563382541147, 1.2060157642919649}],
        "DynamicName",
        BoxID -> "VertexID$22"]}}]]],
  AlignmentPoint->Center,
  Axes->False,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  ContentSelectable->Automatic,
  DefaultBaseStyle->"TreeGraphics",
  Epilog->{},
  FormatType->StandardForm,
  Frame->False,
  FrameLabel->None,
  FrameStyle->{},
  FrameTicks->None,
  FrameTicksStyle->{},
  GridLines->None,
  GridLinesStyle->{},
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->{Automatic, 313.2062930384654},
  LabelStyle->{},
  PlotLabel->None,
  PlotRange->All,
  PlotRangeClipping->False,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  Prolog->{},
  RotateLabel->True,
  Ticks->Automatic,
  TicksStyle->{}]], "Output",
 CellChangeTimes->{3.8949768570228095`*^9},
 CellLabel->"Out[10]=",
 CellID->162891395,ExpressionUUID->"03247c3a-8051-483e-9c28-96703063ee23"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Head", "[", 
  RowBox[{
   SuperscriptBox["b", "2"], 
   TagBox["\[Times]",
    "InactiveToken",
    BaseStyle->"Inactive",
    SyntaxForm->"a*b"], 
   SuperscriptBox["c", "2"], 
   TagBox["\[Times]",
    "InactiveToken",
    BaseStyle->"Inactive",
    SyntaxForm->"a*b"], 
   SuperscriptBox["d", "2"], 
   TagBox["\[Times]",
    "InactiveToken",
    BaseStyle->"Inactive",
    SyntaxForm->"a*b"], 
   SuperscriptBox["z", "2"], 
   TagBox["\[Times]",
    "InactiveToken",
    BaseStyle->"Inactive",
    SyntaxForm->"a*b"], 
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["q", "2"], 
     TagBox["\[Times]",
      "InactiveToken",
      BaseStyle->"Inactive",
      SyntaxForm->"a*b"], 
     SuperscriptBox["a", "2"]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949771085401983`*^9, 3.8949771135389524`*^9}},
 CellLabel->"In[19]:=",
 CellID->172257243,ExpressionUUID->"ec6fb240-62f1-481b-aead-d76ba7d01e83"],

Cell[BoxData[
 RowBox[{"Inactive", "[", "Times", "]"}]], "Output",
 CellChangeTimes->{3.8949771143319273`*^9},
 CellLabel->"Out[19]=",
 CellID->113973965,ExpressionUUID->"eaeea999-b9d6-434c-86bf-8808382d67df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["b", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["c", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["d", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["z", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["q", "2"], 
      TagBox["\[Times]",
       "InactiveToken",
       BaseStyle->"Inactive",
       SyntaxForm->"a*b"], 
      SuperscriptBox["a", "2"]}]]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Inactive", "[", "Times", "]"}], "[", 
     RowBox[{"OrderlessPatternSequence", "[", 
      RowBox[{
       RowBox[{"numerator", ":", 
        RowBox[{"RepeatedNull", "[", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"Head", "[", "x", "]"}], "!=", 
           RowBox[{"Inactive", "[", "Times", "]"}]}]}], "]"}]}], ",", "___"}],
       "]"}], "]"}], ":>", 
    RowBox[{"(", 
     RowBox[{"<|", 
      RowBox[{"\"\<numerator\>\"", "->", 
       RowBox[{"{", "numerator", "}"}]}], "|>"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949769692773714`*^9, 3.894977123663551*^9}},
 CellLabel->"In[20]:=",
 CellID->250063681,ExpressionUUID->"13eb6b9c-455c-4ad9-bd49-edd045309a4a"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{"\<\"numerator\"\>", "\[Rule]", 
   RowBox[{"{", "}"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.894976971951887*^9, {3.8949770425945807`*^9, 3.8949770826867275`*^9}, 
   3.894977124625724*^9},
 CellLabel->"Out[20]=",
 CellID->106697600,ExpressionUUID->"0e53fd9a-0db9-4847-b392-bf47cfc113ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Inactive", "[", "Times", "]"}], "[", 
    RowBox[{
     RowBox[{"b", "^", "2"}], ",", " ", 
     RowBox[{"c", "^", "2"}], ",", " ", 
     RowBox[{"d", "^", "2"}], ",", " ", 
     RowBox[{"z", "^", "2"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactive", "[", "Times", "]"}], "[", 
       RowBox[{
        RowBox[{"q", "^", "2"}], ",", " ", 
        RowBox[{"a", "^", "2"}]}], "]"}], "^", "\n", "  ", 
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}]}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"Inactive", "[", "Times", "]"}], "[", "___", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.894977155262138*^9, 3.894977165112692*^9}},
 CellLabel->"In[21]:=",
 CellID->661990640,ExpressionUUID->"dbc6f9c3-035e-4def-a6e5-e35f54f2c047"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.894977165425598*^9},
 CellLabel->"Out[21]=",
 CellID->179615253,ExpressionUUID->"1ea36e34-572f-497e-96d1-6ca644b69040"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Inactive", "[", "Times", "]"}], "[", 
    RowBox[{
     RowBox[{"b", "^", "2"}], ",", " ", 
     RowBox[{"c", "^", "2"}], ",", " ", 
     RowBox[{"d", "^", "2"}], ",", " ", 
     RowBox[{"z", "^", "2"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactive", "[", "Times", "]"}], "[", 
       RowBox[{
        RowBox[{"q", "^", "2"}], ",", " ", 
        RowBox[{"a", "^", "2"}]}], "]"}], "^", "\n", "  ", 
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}]}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"Inactive", "[", "Times", "]"}], "[", 
    RowBox[{"___", ",", "___"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977155262138*^9, 3.894977210140698*^9}},
 CellLabel->"In[22]:=",
 CellID->60633593,ExpressionUUID->"3d6228a8-2208-4d35-95b0-a050cee534b1"],

Cell[BoxData[
 TemplateBox[{
  "Head", "argt", 
   "\"\\!\\(\\*RowBox[{\\\"Head\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"0\\\
\"}]\\) arguments; \\!\\(\\*RowBox[{\\\"1\\\"}]\\) or \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) arguments are expected.\"", 2, 22, 3, 
   34135963325345372815, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.894977181114984*^9},
 CellLabel->"During evaluation of In[22]:=",
 CellID->170308327,ExpressionUUID->"5a4fabba-f2ec-4c83-b2a4-b38f3e0ece80"],

Cell[BoxData[
 TemplateBox[{
  "Head", "argt", 
   "\"\\!\\(\\*RowBox[{\\\"Head\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"3\\\
\"}]\\) arguments; \\!\\(\\*RowBox[{\\\"1\\\"}]\\) or \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) arguments are expected.\"", 2, 22, 4, 
   34135963325345372815, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.894977182401993*^9},
 CellLabel->"During evaluation of In[22]:=",
 CellID->102137890,ExpressionUUID->"61a8d197-545b-44b1-83e3-71cbb7032891"],

Cell[BoxData[
 TemplateBox[{
  "Head", "argt", 
   "\"\\!\\(\\*RowBox[{\\\"Head\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"4\\\
\"}]\\) arguments; \\!\\(\\*RowBox[{\\\"1\\\"}]\\) or \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) arguments are expected.\"", 2, 22, 5, 
   34135963325345372815, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8949771837745714`*^9},
 CellLabel->"During evaluation of In[22]:=",
 CellID->394454359,ExpressionUUID->"0f8e44fb-fc80-4be1-910d-1125443ebcc8"],

Cell[BoxData[
 TemplateBox[{
  "Head", "argt", 
   "\"\\!\\(\\*RowBox[{\\\"Head\\\"}]\\) called with \\!\\(\\*RowBox[{\\\"5\\\
\"}]\\) arguments; \\!\\(\\*RowBox[{\\\"1\\\"}]\\) or \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) arguments are expected.\"", 2, 22, 6, 
   34135963325345372815, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.894977185094868*^9},
 CellLabel->"During evaluation of In[22]:=",
 CellID->76820452,ExpressionUUID->"70210467-e429-4c0c-a85a-959e7fe46990"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.894977186475951*^9},
 CellLabel->"Out[22]=",
 CellID->491793677,ExpressionUUID->"e53fb0c0-7c9d-4a9a-a8ad-14927e217ac7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   SuperscriptBox["b", "2"], ",", 
   RowBox[{"x_", "/;", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], "!=", 
     RowBox[{"Inactive", "[", "Times", "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977219103095*^9, 3.894977235979902*^9}},
 CellLabel->"In[23]:=",
 CellID->384495673,ExpressionUUID->"2de3f7cd-8cc2-44d0-97aa-27093d6cd1e0"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.8949772363292046`*^9},
 CellLabel->"Out[23]=",
 CellID->186967771,ExpressionUUID->"ded23f71-8f0d-4855-950e-4a71093512d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   SuperscriptBox["b", "2"], ",", 
   RowBox[{"x_", "/;", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], "=!=", 
     RowBox[{"Inactive", "[", "Times", "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977219103095*^9, 3.8949772429614725`*^9}},
 CellLabel->"In[24]:=",
 CellID->322303961,ExpressionUUID->"4f18cbe3-aae0-43f9-903d-5b5f5e86408a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8949772433416615`*^9},
 CellLabel->"Out[24]=",
 CellID->705383167,ExpressionUUID->"679fcfca-9b09-47d4-b027-626f35009e3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   SuperscriptBox["b", "2"], ",", 
   RowBox[{"x_", "/;", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], "=!=", 
     RowBox[{"Inactive", "[", "Times", "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977219103095*^9, 3.8949772457188215`*^9}},
 CellLabel->"In[29]:=",
 CellID->352881982,ExpressionUUID->"8444b3cf-06af-42e3-8559-d3cc05066374"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8949773348893013`*^9},
 CellLabel->"Out[29]=",
 CellID->104515354,ExpressionUUID->"c9a85bc5-8306-4405-ab81-892c8d1a822c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["q", "2"], 
     TagBox["\[Times]",
      "InactiveToken",
      BaseStyle->"Inactive",
      SyntaxForm->"a*b"], 
     SuperscriptBox["a", "2"]}]], ",", 
   RowBox[{"x_", "/;", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], "=!=", 
     RowBox[{"Inactive", "[", "Times", "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977219103095*^9, 3.8949772457188215`*^9}, {
  3.8949773323305693`*^9, 3.8949773402140036`*^9}},
 CellLabel->"In[30]:=",
 CellID->319128574,ExpressionUUID->"1198c22f-8820-476d-882a-5d43b3337bb9"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8949773411642704`*^9},
 CellLabel->"Out[30]=",
 CellID->32208754,ExpressionUUID->"d1ee4449-7485-4155-93c9-252412f233f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Head", "[", 
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["q", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["a", "2"]}]], "]"}]], "Input",
 CellChangeTimes->{{3.8949773456867285`*^9, 3.894977346799077*^9}},
 CellLabel->"In[31]:=",
 CellID->632903510,ExpressionUUID->"00f1cd4a-9fe8-42f1-985b-3fce886b359c"],

Cell[BoxData["Power"], "Output",
 CellChangeTimes->{3.894977347218948*^9},
 CellLabel->"Out[31]=",
 CellID->65152455,ExpressionUUID->"1674cfe9-585a-4193-b5db-2c822c9e8c64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["q", "2"], 
     TagBox["\[Times]",
      "InactiveToken",
      BaseStyle->"Inactive",
      SyntaxForm->"a*b"], 
     SuperscriptBox["a", "2"]}]], ",", 
   RowBox[{"Inactive", "[", "Times", "]"}], ",", "All", ",", 
   RowBox[{"Heads", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949773575777025`*^9, 3.894977389600083*^9}},
 CellLabel->"In[36]:=",
 CellID->588694242,ExpressionUUID->"7a83c442-d251-47b5-b5a1-d3bb25d22f13"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Inactive", "[", "Times", "]"}], "}"}]], "Output",
 CellChangeTimes->{{3.8949773635052385`*^9, 3.894977389985563*^9}},
 CellLabel->"Out[36]=",
 CellID->328151388,ExpressionUUID->"efbd91c7-c11c-4ea0-b7d3-33a30effc388"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MemberQ", "[", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["q", "2"], 
       TagBox["\[Times]",
        "InactiveToken",
        BaseStyle->"Inactive",
        SyntaxForm->"a*b"], 
       SuperscriptBox["a", "2"]}]], ",", 
     RowBox[{"Inactive", "[", "Times", "]"}], ",", "All", ",", 
     RowBox[{"Heads", "->", "True"}]}], "]"}], ",", 
   RowBox[{"Inactive", "[", "Times", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977405814847*^9, 3.8949774120649347`*^9}},
 CellLabel->"In[38]:=",
 CellID->148597441,ExpressionUUID->"cd28b2b7-65ae-400a-a093-7dad2334a9f4"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8949774122009335`*^9},
 CellLabel->"Out[38]=",
 CellID->250828651,ExpressionUUID->"909173d8-b455-4248-a8c9-71120bd7a5b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   SuperscriptBox["b", "2"], ",", 
   RowBox[{"Inactive", "[", "Times", "]"}], ",", "All", ",", 
   RowBox[{"Heads", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949773575777025`*^9, 3.894977401582542*^9}},
 CellLabel->"In[37]:=",
 CellID->328691234,ExpressionUUID->"a0a51258-c844-46c5-9e06-1d9327ee7bf8"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.8949774019842057`*^9},
 CellLabel->"Out[37]=",
 CellID->230939523,ExpressionUUID->"1b4accef-4fc1-4457-a47b-ee1df3cf1600"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MemberQ", "[", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{
     SuperscriptBox["b", "2"], ",", 
     RowBox[{"Inactive", "[", "Times", "]"}], ",", "All", ",", 
     RowBox[{"Heads", "->", "True"}]}], "]"}], ",", 
   RowBox[{"Inactive", "[", "Times", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977415391075*^9, 3.8949774207283087`*^9}},
 CellLabel->"In[39]:=",
 CellID->236727458,ExpressionUUID->"9f2a93c1-fd83-4e4d-8b48-a9fed68f6d1c"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.8949774208603477`*^9},
 CellLabel->"Out[39]=",
 CellID->592692198,ExpressionUUID->"d34ec792-8a1c-4bb7-9762-433b0f04f7be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InputForm", "[", 
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["q", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["a", "2"]}]], "]"}]], "Input",
 CellChangeTimes->{{3.8949773675626135`*^9, 3.8949773694017553`*^9}},
 CellLabel->"In[33]:=",
 CellID->2559059,ExpressionUUID->"c510437a-bcf3-4366-bd8b-1a3c2e50f76b"],

Cell["Inactive[Times][q^2, a^2]^(-1)", "Output",
 CellChangeTimes->{3.8949773697959356`*^9},
 CellLabel->"Out[33]//InputForm=",
 CellID->280959356,ExpressionUUID->"2f2751b3-7d72-4276-9597-60b735135929"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["b", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["c", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["d", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["z", "2"]}], ",", 
   RowBox[{
    RowBox[{"Inactive", "[", "Times", "]"}], "[", 
    RowBox[{"numerator", ":", 
     RowBox[{"Repeated", "[", 
      RowBox[{"x_", "/;", 
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"x", ",", 
            RowBox[{"Inactive", "[", "Times", "]"}], ",", "All", ",", 
            RowBox[{"Heads", "->", "True"}]}], "]"}], ",", 
          RowBox[{"Inactive", "[", "Times", "]"}]}], "]"}]}]}], "]"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977506067643*^9, 3.8949775120720606`*^9}, {
  3.894977542365525*^9, 3.894977557270855*^9}},
 CellLabel->"In[45]:=",
 CellID->322886675,ExpressionUUID->"431fe04e-2754-4e57-90db-d8383a7d7144"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.894977543595532*^9, 3.8949775576103907`*^9}},
 CellLabel->"Out[45]=",
 CellID->215218184,ExpressionUUID->"135ec8d8-f0d6-4014-97fd-0186555bf35f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["b", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["c", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["d", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["z", "2"]}], ",", 
   RowBox[{
    RowBox[{"Inactive", "[", "Times", "]"}], "[", 
    RowBox[{"numerator", ":", 
     RowBox[{"Repeated", "[", "x_", "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977506067643*^9, 3.8949775120720606`*^9}, {
  3.894977542365525*^9, 3.8949775691287565`*^9}},
 CellLabel->"In[46]:=",
 CellID->284468844,ExpressionUUID->"059dd3a9-ee61-4444-b26a-07a3cc3e54fc"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.8949775694886045`*^9},
 CellLabel->"Out[46]=",
 CellID->300512079,ExpressionUUID->"0835eedc-ced7-4500-a32b-1b1d5d30b0d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["b", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["c", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["d", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["z", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["q", "2"], 
      TagBox["\[Times]",
       "InactiveToken",
       BaseStyle->"Inactive",
       SyntaxForm->"a*b"], 
      SuperscriptBox["a", "2"]}]]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Inactive", "[", "Times", "]"}], "[", 
     RowBox[{"OrderlessPatternSequence", "[", 
      RowBox[{
       RowBox[{"numerator", ":", 
        RowBox[{"Repeated", "[", 
         RowBox[{"x_", "/;", 
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"x", ",", 
               RowBox[{"Inactive", "[", "Times", "]"}], ",", "All", ",", 
               RowBox[{"Heads", "->", "True"}]}], "]"}], ",", 
             RowBox[{"Inactive", "[", "Times", "]"}]}], "]"}]}]}], "]"}]}], 
       ",", 
       RowBox[{"denominator", ":", 
        RowBox[{"Repeated", "[", 
         RowBox[{"x_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"x", ",", 
              RowBox[{"Inactive", "[", "Times", "]"}], ",", "All", ",", 
              RowBox[{"Heads", "->", "True"}]}], "]"}], ",", 
            RowBox[{"Inactive", "[", "Times", "]"}]}], "]"}]}], "]"}]}]}], 
      "]"}], "]"}], ":>", 
    RowBox[{"(", 
     RowBox[{"<|", 
      RowBox[{"\"\<denominator\>\"", "->", 
       RowBox[{"{", "denominator", "}"}]}], "|>"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894977254702261*^9, 3.894977310339546*^9}, {
  3.894977430675001*^9, 3.8949775289423323`*^9}},
 CellLabel->"In[43]:=",
 CellID->20379994,ExpressionUUID->"4f5311fe-d663-4bf8-b6fb-f51d10a2b9b5"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["b", "2"], 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  SuperscriptBox["c", "2"], 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  SuperscriptBox["d", "2"], 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  SuperscriptBox["z", "2"], 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["q", "2"], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    SuperscriptBox["a", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.8949772550999346`*^9, {3.894977287143893*^9, 3.894977311269075*^9}, {
   3.894977460516875*^9, 3.894977488955085*^9}, 3.8949775312499704`*^9},
 CellLabel->"Out[43]=",
 CellID->647092413,ExpressionUUID->"2d9327b2-4dae-4956-a98e-58a4c8fac1d5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"RearrangeFunction2", ",", 
   RowBox[{"{", 
    RowBox[{"HoldFirst", ",", "Listable"}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"RearrangeFunction2", "[", "input_", "]"}], ":=", "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "firstoutput", "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"firstoutput", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{"input", ",", "Times"}], "]"}], "//.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Inactive", "[", "Times", "]"}], "[", 
            RowBox[{"i", ":", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], "\n", ":>", 
           RowBox[{"NonCommutativeMultiply", "@@", 
            RowBox[{"PositionQInFrontOfList", "[", 
             RowBox[{"{", "i", "}"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Inactive", "[", "Times", "]"}], "[", 
            RowBox[{"OrderlessPatternSequence", "[", "\n", 
             RowBox[{
              RowBox[{"n", ":", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"_", "^", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", ">", "0"}], "&"}], ")"}]}]}], "|", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Denominator", "[", "#1", "]"}], "===", "1"}], 
                    "&"}], ")"}]}]}], ")"}], ".."}], ")"}]}], ",", 
              RowBox[{"d", ":", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"_", "^", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]}], "|", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Denominator", "[", "#1", "]"}], "=!=", "1"}], 
                    "&"}], ")"}]}]}], ")"}], ".."}], ")"}]}]}], "]"}], "]"}], 
           ":>", "\n", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"PositionQInFrontOfList", "[", 
                RowBox[{"{", "n", "}"}], "]"}]}], "/.", "\n", " ", 
              RowBox[{
               RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], ":>", 
               "x"}]}], ")"}], "/", "\n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"PositionQInFrontOfList", "[", 
                RowBox[{"Denominator", "/@", 
                 RowBox[{"{", "d", "}"}]}], "]"}]}], "/.", " ", 
              RowBox[{
               RowBox[{"NonCommutativeMultiply", "[", "y_", "]"}], ":>", 
               "y"}]}], ")"}]}]}], ",", "\n", " ", "\n", 
          RowBox[{
           RowBox[{"NonCommutativeMultiply", "[", 
            RowBox[{"i", ":", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], ":>", 
           RowBox[{"Times", "[", "i", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"u", ":", 
             RowBox[{"NonCommutativeMultiply", "[", "___", "]"}]}], "/;", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"u", ",", 
               RowBox[{"q", "|", 
                RowBox[{"q", "^", "_"}]}]}], "]"}], "!=", 
             RowBox[{"{", "}"}]}]}], ":>", "\n", 
           RowBox[{"NonCommutativeMultiply", "@@", 
            RowBox[{"PositionQInFrontOfList", "[", 
             RowBox[{"List", "@@", "u"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Inactive", "[", "Times", "]"}], "[", "y__", "]"}], ":>", 
           RowBox[{"NonCommutativeMultiply", "[", "y", "]"}]}]}], "}"}]}], "/.",
        " ", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"Inactive", "[", "Times", "]"}], "[", 
         RowBox[{"i", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], ":>", 
        RowBox[{"Times", "[", "i", "]"}]}]}]}], ";", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"firstoutput", "/.", " ", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"OrderlessPatternSequence", "[", 
               RowBox[{
                RowBox[{"numbers", ":", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], ",", 
                RowBox[{"symbols", ":", 
                 RowBox[{"(", 
                  RowBox[{"_Symbol", "..."}], ")"}]}], ",", 
                RowBox[{"powers", ":", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"_", "^", "_."}], ".."}], ")"}]}]}], "]"}], "\n", "**", 
              RowBox[{"(", 
               RowBox[{"plus", ":", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"+", "__"}], ")"}], "..."}], ")"}]}], ")"}]}], ":>", 
             RowBox[{
              RowBox[{"Times", "@@", "numbers"}], " ", 
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"PositionQInFrontOfList", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", "symbols", "}"}], ",", 
                  RowBox[{"{", "powers", "}"}], ",", 
                  RowBox[{"{", "plus", "}"}]}], "]"}], "]"}]}]}]}]}], ",", 
           "\n", 
           RowBox[{"NonCommutativeMultiply", "[", "]"}], ",", "All"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], ":>", "x"}], 
         ",", "All"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NonCommutativeMultiply", "[", 
          RowBox[{
           RowBox[{"nonqs", ":", 
            RowBox[{"Repeated", "[", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "#", "]"}], "==", "\n", "Symbol"}], "&&", 
                 RowBox[{"#", "=!=", "q"}]}], "&"}], ")"}]}], "]"}]}], ",", 
           RowBox[{"qs", ":", 
            RowBox[{"Power", "[", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", "[", 
               RowBox[{"q", ",", "_"}], "]"}], ",", "_"}], "]"}]}]}], "]"}], ":>", 
         RowBox[{"NonCommutativeMultiply", "[", 
          RowBox[{"qs", ",", "nonqs"}], "]"}]}], "}"}], ",", "All"}], 
      "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8949776657833767`*^9, 3.894977677355816*^9}, {
  3.894977710351591*^9, 3.8949777121138988`*^9}},
 CellLabel->"In[50]:=",
 CellID->471136429,ExpressionUUID->"21ee101e-a3a8-4f14-a5b7-72a1d6253748"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RearrangeFunction2", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "c", " ", "d", " ", "z"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"q", " ", "a"}], ")"}]}], ")"}], "^", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.894977719249086*^9, 3.8949777287572193`*^9}},
 CellLabel->"In[52]:=",
 CellID->396067602,ExpressionUUID->"37b1258b-5ebb-46fb-a9bc-7e6f8da57a70"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"b", "**", "c", "**", "d", "**", "z"}], ")"}], "2"], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"q", "**", "a"}], ")"}], "2"]]], "Output",
 CellChangeTimes->{3.8949777294581723`*^9},
 CellLabel->"Out[52]=",
 CellID->91876342,ExpressionUUID->"d5063990-1c42-4265-a57c-7669168239c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Inactivate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b", " ", "c", " ", "d", " ", "z"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"q", " ", "a"}], ")"}]}], ")"}], "^", "2"}], ",", "Times"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.8949777579648247`*^9},
 CellLabel->"In[53]:=",
 CellID->737919,ExpressionUUID->"7cbfbbf7-3317-4633-995f-59bcb763a0e8"],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", 
      TagBox["\[Times]",
       "InactiveToken",
       BaseStyle->"Inactive",
       SyntaxForm->"a*b"], "c", 
      TagBox["\[Times]",
       "InactiveToken",
       BaseStyle->"Inactive",
       SyntaxForm->"a*b"], "d", 
      TagBox["\[Times]",
       "InactiveToken",
       BaseStyle->"Inactive",
       SyntaxForm->"a*b"], "z"}], ")"}], 
    TagBox["\[Times]",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"a*b"], 
    FractionBox["1", 
     RowBox[{"q", 
      TagBox["\[Times]",
       "InactiveToken",
       BaseStyle->"Inactive",
       SyntaxForm->"a*b"], "a"}]]}], ")"}], "2"]], "Output",
 CellChangeTimes->{3.894977758960075*^9},
 CellLabel->"Out[53]=",
 CellID->65017555,ExpressionUUID->"e7c93c68-1f93-4eac-9af1-a05a192c747f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Inactivate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", " ", "c", " ", "d", " ", "z"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"q", " ", "a"}], ")"}]}], ")"}], "^", "2"}], ",", "Times"}],
      "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{"EchoEvaluation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactive", "[", "Times", "]"}], "[", 
        RowBox[{"i", ":", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], "\n", ":>", 
       RowBox[{
        RowBox[{"Inactive", "[", "Times", "]"}], "@@", 
        RowBox[{"PositionQInFrontOfList", "[", 
         RowBox[{"{", "i", "}"}], "]"}]}]}], "]"}], "}"}]}], ")"}], ",", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Inactive", "[", "Times", "]"}], "[", 
      RowBox[{"OrderlessPatternSequence", "[", "\n", 
       RowBox[{
        RowBox[{"n", ":", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"_", "^", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", ">", "0"}], "&"}], ")"}]}]}], "|", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Denominator", "[", "#1", "]"}], "===", "1"}], "&"}],
                ")"}]}]}], ")"}], ".."}], ")"}]}], ",", 
        RowBox[{"d", ":", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"_", "^", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]}], "|", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Denominator", "[", "#1", "]"}], "=!=", "1"}], "&"}],
                ")"}]}]}], ")"}], ".."}], ")"}]}]}], "]"}], "]"}], ":>", "\n", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NonCommutativeMultiply", "@@", 
         RowBox[{"PositionQInFrontOfList", "[", 
          RowBox[{"{", "n", "}"}], "]"}]}], "/.", "\n", " ", 
        RowBox[{
         RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], ":>", "x"}]}], 
       ")"}], "/", "\n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NonCommutativeMultiply", "@@", 
         RowBox[{"PositionQInFrontOfList", "[", 
          RowBox[{"Denominator", "/@", 
           RowBox[{"{", "d", "}"}]}], "]"}]}], "/.", " ", 
        RowBox[{
         RowBox[{"NonCommutativeMultiply", "[", "y_", "]"}], ":>", "y"}]}], 
       ")"}]}]}], ",", "\n", " ", "\n", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", 
      RowBox[{"i", ":", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], ":>", 
     RowBox[{"Times", "[", "i", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"u", ":", 
       RowBox[{"NonCommutativeMultiply", "[", "___", "]"}]}], "/;", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"u", ",", 
         RowBox[{"q", "|", 
          RowBox[{"q", "^", "_"}]}]}], "]"}], "!=", 
       RowBox[{"{", "}"}]}]}], ":>", "\n", 
     RowBox[{"NonCommutativeMultiply", "@@", 
      RowBox[{"PositionQInFrontOfList", "[", 
       RowBox[{"List", "@@", "u"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Inactive", "[", "Times", "]"}], "[", "y__", "]"}], ":>", 
     RowBox[{"NonCommutativeMultiply", "[", "y", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8949777579648247`*^9, 3.894977856117901*^9}},
 CellLabel->"In[56]:=",
 CellID->7081445,ExpressionUUID->"358492fd-be8e-4c62-b9ed-fab0068babb0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inactive", "[", "Times", "]"}], "[", 
   RowBox[{"i", ":", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], "\[RuleDelayed]", 
  RowBox[{
   RowBox[{"Inactive", "[", "Times", "]"}], "@@", 
   RowBox[{"PositionQInFrontOfList", "[", 
    RowBox[{"{", "i", "}"}], "]"}]}]}]], "EchoBefore",
 CellDingbat->Cell[
   BoxData[
    TemplateBox[{
      StyleBox["\[LeftGuillemet]", "EchoBeforeDingbat"], {
       FrontEnd`EvaluationNotebook[], "1e264c9a-d32f-444c-996b-0bb1b507d08a"},
       None}, "HyperlinkDefault"]]],
 CellChangeTimes->{3.8949778195288396`*^9},
 CellTags->"407df68d-e655-417b-9ff2-0449c81d58ef",
 CellID->585255656,ExpressionUUID->"104d456c-ed20-4f85-a700-42712bc8cd17"],

Cell[BoxData[
 TagBox[
  TooltipBox[
   RowBox[{
    RowBox[{
     RowBox[{"Inactive", "[", "Times", "]"}], "[", 
     RowBox[{"i", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"Inactive", "[", "Times", "]"}], "@@", 
     RowBox[{"PositionQInFrontOfList", "[", 
      RowBox[{"{", "i", "}"}], "]"}]}]}],
   RowBox[{
     RowBox[{
       RowBox[{"Inactive", "[", "Times", "]"}], "[", 
       RowBox[{"i", ":", 
         RowBox[{"(", 
           RowBox[{
             RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{
       RowBox[{"Inactive", "[", "Times", "]"}], "@@", 
       RowBox[{"PositionQInFrontOfList", "[", 
         RowBox[{"{", "i", "}"}], "]"}]}]}]],
  Annotation[#, Inactive[Times][
     Pattern[$CellContext`i, 
      Repeated[
       PatternTest[
        Blank[], AtomQ]]]] :> Apply[
     Inactive[Times], 
     PeterBurbery`BasicHypergeometricFunctions`PositionQInFrontOfList[{$\
CellContext`i}]], "Tooltip"]& ]], "EchoAfter",
 CellDingbat->Cell[
   BoxData[
    TemplateBox[{
      StyleBox["\[RightGuillemet]", "EchoAfterDingbat"], {
       FrontEnd`EvaluationNotebook[], "407df68d-e655-417b-9ff2-0449c81d58ef"},
       None}, "HyperlinkDefault"]]],
 CellChangeTimes->{3.89497782129799*^9},
 CellTags->"1e264c9a-d32f-444c-996b-0bb1b507d08a",
 CellID->257068581,ExpressionUUID->"db7c6fb7-bb00-4871-a8a4-db62aeb14ff1"]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"b", 
     TagBox["\[Times]",
      "InactiveToken",
      BaseStyle->"Inactive",
      SyntaxForm->"a*b"], "c", 
     TagBox["\[Times]",
      "InactiveToken",
      BaseStyle->"Inactive",
      SyntaxForm->"a*b"], "d", 
     TagBox["\[Times]",
      "InactiveToken",
      BaseStyle->"Inactive",
      SyntaxForm->"a*b"], "z"}], ")"}], "2"], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"q", 
     TagBox["\[Times]",
      "InactiveToken",
      BaseStyle->"Inactive",
      SyntaxForm->"a*b"], "a"}], ")"}], "2"]]], "Output",
 CellChangeTimes->{3.8949777870843215`*^9, 3.894977823066971*^9},
 CellLabel->"Out[56]=",
 CellID->362255658,ExpressionUUID->"0b6a67ed-4aa9-4130-9665-a1d90348d6c8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"RearrangeFunction2", ",", 
   RowBox[{"{", 
    RowBox[{"HoldFirst", ",", "Listable"}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"RearrangeFunction2", "[", "input_", "]"}], ":=", "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "firstoutput", "}"}], ",", 
    RowBox[{
     RowBox[{"firstoutput", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{"input", ",", "Times"}], "]"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Inactive", "[", "Times", "]"}], "[", 
            RowBox[{"i", ":", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], ":>", 
           RowBox[{"NonCommutativeMultiply", "@@", 
            RowBox[{"PositionQInFrontOfList", "[", 
             RowBox[{"{", "i", "}"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Inactive", "[", "Times", "]"}], "[", 
            RowBox[{"OrderlessPatternSequence", "[", 
             RowBox[{
              RowBox[{"n", ":", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"_", "^", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", ">", "0"}], "&"}], ")"}]}]}], "|", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumeratorTermQ", "[", "#1", "]"}], "&"}], 
                    ")"}]}]}], ")"}], ".."}], ")"}]}], ",", 
              RowBox[{"d", ":", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"_", "^", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]}], "|", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"DenominatorTermQ", "[", "#1", "]"}], "&"}], 
                    ")"}]}]}], ")"}], ".."}], ")"}]}]}], "]"}], "]"}], ":>", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"PositionQInFrontOfList", "[", 
                RowBox[{"{", "n", "}"}], "]"}]}], "/.", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], ":>", 
               "x"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"PositionQInFrontOfList", "[", 
                RowBox[{"Denominator", "/@", 
                 RowBox[{"{", "d", "}"}]}], "]"}]}], "/.", " ", 
              RowBox[{
               RowBox[{"NonCommutativeMultiply", "[", "y_", "]"}], ":>", 
               "y"}]}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"NonCommutativeMultiply", "[", 
            RowBox[{"i", ":", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], ":>", 
           RowBox[{"Times", "[", "i", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"u", ":", 
             RowBox[{"NonCommutativeMultiply", "[", "___", "]"}]}], "/;", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"u", ",", 
               RowBox[{"q", "|", 
                RowBox[{"q", "^", "_"}]}]}], "]"}], "!=", 
             RowBox[{"{", "}"}]}]}], ":>", 
           RowBox[{"NonCommutativeMultiply", "@@", 
            RowBox[{"PositionQInFrontOfList", "[", 
             RowBox[{"List", "@@", "u"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Inactive", "[", "Times", "]"}], "[", "y__", "]"}], ":>", 
           RowBox[{"NonCommutativeMultiply", "[", "y", "]"}]}]}], "}"}]}], "/.",
        " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Inactive", "[", "Times", "]"}], "[", 
         RowBox[{"i", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], ":>", 
        RowBox[{"Times", "[", "i", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"firstoutput", "/.", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"OrderlessPatternSequence", "[", 
               RowBox[{
                RowBox[{"numbers", ":", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], ",", 
                RowBox[{"symbols", ":", 
                 RowBox[{"(", 
                  RowBox[{"_Symbol", "..."}], ")"}]}], ",", 
                RowBox[{"powers", ":", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"_", "^", "_."}], ".."}], ")"}]}]}], "]"}], "**", 
              RowBox[{"(", 
               RowBox[{"plus", ":", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"+", "__"}], ")"}], "..."}], ")"}]}], ")"}]}], ":>", 
             RowBox[{
              RowBox[{"Times", "@@", "numbers"}], " ", 
              RowBox[{"NonCommutativeMultiply", "@@", 
               RowBox[{"PositionQInFrontOfList", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", "symbols", "}"}], ",", 
                  RowBox[{"{", "powers", "}"}], ",", 
                  RowBox[{"{", "plus", "}"}]}], "]"}], "]"}]}]}]}]}], ",", 
           RowBox[{"NonCommutativeMultiply", "[", "]"}], ",", "All"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], ":>", "x"}], 
         ",", "All"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NonCommutativeMultiply", "[", 
          RowBox[{
           RowBox[{"nonqs", ":", 
            RowBox[{"Repeated", "[", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "#", "]"}], "==", "Symbol"}], "&&", 
                 RowBox[{"#", "=!=", "q"}]}], "&"}], ")"}]}], "]"}]}], ",", 
           RowBox[{"qs", ":", 
            RowBox[{"Power", "[", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", "[", 
               RowBox[{"q", ",", "_"}], "]"}], ",", "_"}], "]"}]}]}], "]"}], ":>", 
         RowBox[{"NonCommutativeMultiply", "[", 
          RowBox[{"qs", ",", "nonqs"}], "]"}]}], "}"}], ",", "All"}], 
      "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8949778940733547`*^9, 3.894977896581274*^9}, {
   3.89497798697108*^9, 3.894977990911439*^9}, {3.8949780318527555`*^9, 
   3.894978052774125*^9}, {3.8949780871475506`*^9, 3.8949780896524487`*^9}, {
   3.89497812457271*^9, 3.8949781645881367`*^9}, {3.894978674904045*^9, 
   3.8949786753771615`*^9}, 3.8949806779203672`*^9},
 CellLabel->"In[14]:=",
 CellID->368103848,ExpressionUUID->"e0555286-04b9-4743-b069-459394db6064"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RearrangeFunction2", "[", 
  RowBox[{"a", " ", "b", " ", "c", " ", "d"}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.8949779302433434`*^9, 3.894977936179144*^9}},
 CellLabel->"In[85]:=",
 CellID->75949663,ExpressionUUID->"14f9af16-385d-483d-8c6a-4795bd0c3d99"],

Cell[BoxData[
 RowBox[{"a", "**", "b", "**", "c", "**", "d"}]], "Output",
 CellChangeTimes->{3.894977936431043*^9, 3.8949781682931175`*^9},
 CellLabel->"Out[85]=",
 CellID->16251515,ExpressionUUID->"f2987302-9878-42ac-aed3-b5ec0289f8ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RearrangeFunction2", "[", 
  RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.8949779302433434`*^9, 3.894977942101209*^9}},
 CellLabel->"In[86]:=",
 CellID->53162270,ExpressionUUID->"1d6a75e6-46bb-40b7-ab58-6305ec9610be"],

Cell[BoxData[
 RowBox[{"q", "**", "a", "**", "b", "**", "c", "**", "d"}]], "Output",
 CellChangeTimes->{3.8949779425971875`*^9, 3.894978171216213*^9},
 CellLabel->"Out[86]=",
 CellID->402951547,ExpressionUUID->"85dfb224-7cb4-4590-b054-3c2835e0e985"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RearrangeFunction2", "[", 
  RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
   SuperscriptBox["q", "n"]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949779302433434`*^9, 3.8949779477212825`*^9}},
 CellLabel->"In[87]:=",
 CellID->229526090,ExpressionUUID->"1bcc0602-d555-4b18-8140-385588c0ea13"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["q", "n"], "**", "a", "**", "b", "**", "c", "**", 
  "d"}]], "Output",
 CellChangeTimes->{
  3.894977948392253*^9, 3.8949780003471565`*^9, {3.894978037143547*^9, 
   3.894978056279378*^9}, {3.8949780984121943`*^9, 3.894978127127043*^9}, 
   3.8949781737938013`*^9},
 CellLabel->"Out[87]=",
 CellID->798424520,ExpressionUUID->"efc4a112-1768-49ea-bbb2-559ccad3daa5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RearrangeFunction2", "[", 
  RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
   SuperscriptBox["q", 
    RowBox[{"n", "-", "1"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949779302433434`*^9, 3.8949779477212825`*^9}, {
  3.8949781777554626`*^9, 3.8949781791899967`*^9}},
 CellLabel->"In[16]:=",
 CellID->224954957,ExpressionUUID->"33ecf1d7-c60b-45ff-911d-6dd7a188cedd"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["q", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]], "**", "a", "**", "b", "**", "c", "**", 
  "d"}]], "Output",
 CellChangeTimes->{3.894978179619497*^9, 3.894981049072235*^9},
 CellLabel->"Out[16]=",
 CellID->454449641,ExpressionUUID->"fe9312a2-e4e7-41f6-8ed2-7c8d81964d9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inactivate", "[", 
    RowBox[{
     RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
      SuperscriptBox["q", 
       RowBox[{"n", "-", "1"}]]}], ",", "Times"}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Inactive", "[", "Times", "]"}], "[", 
       RowBox[{"i", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], ":>", 
      RowBox[{"NonCommutativeMultiply", "@@", 
       RowBox[{"PositionQInFrontOfList", "[", 
        RowBox[{"{", "i", "}"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactive", "[", "Times", "]"}], "[", 
       RowBox[{"OrderlessPatternSequence", "[", 
        RowBox[{
         RowBox[{"n", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"_", "^", 
               RowBox[{"_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"#1", ">", "0"}], "&"}], ")"}]}]}], "|", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Denominator", "[", "#1", "]"}], "===", "1"}], 
                 "&"}], ")"}]}]}], ")"}], ".."}], ")"}]}], ",", 
         RowBox[{"d", ":", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"_", "^", 
               RowBox[{"_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]}], "|", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Denominator", "[", "#1", "]"}], "=!=", "1"}], 
                 "&"}], ")"}]}]}], ")"}], ".."}], ")"}]}]}], "]"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NonCommutativeMultiply", "@@", 
          RowBox[{"PositionQInFrontOfList", "[", 
           RowBox[{"{", "n", "}"}], "]"}]}], "/.", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], ":>", "x"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NonCommutativeMultiply", "@@", 
          RowBox[{"PositionQInFrontOfList", "[", 
           RowBox[{"Denominator", "/@", 
            RowBox[{"{", "d", "}"}]}], "]"}]}], "/.", " ", 
         RowBox[{
          RowBox[{"NonCommutativeMultiply", "[", "y_", "]"}], ":>", "y"}]}], 
        ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"NonCommutativeMultiply", "[", 
       RowBox[{"i", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], ":>", 
      RowBox[{"Times", "[", "i", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"u", ":", 
        RowBox[{"NonCommutativeMultiply", "[", "___", "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"u", ",", 
          RowBox[{"q", "|", 
           RowBox[{"q", "^", "_"}]}]}], "]"}], "!=", 
        RowBox[{"{", "}"}]}]}], ":>", 
      RowBox[{"NonCommutativeMultiply", "@@", 
       RowBox[{"PositionQInFrontOfList", "[", 
        RowBox[{"List", "@@", "u"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactive", "[", "Times", "]"}], "[", "y__", "]"}], ":>", 
      RowBox[{"NonCommutativeMultiply", "[", "y", "]"}]}]}], "}"}]}], "/.", 
  " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Inactive", "[", "Times", "]"}], "[", 
    RowBox[{"i", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], ":>", 
   RowBox[{"Times", "[", "i", "]"}]}]}]], "Input",
 CellChangeTimes->{3.8949782044658537`*^9},
 CellLabel->"In[89]:=",
 CellID->28050259,ExpressionUUID->"8b4b56df-a3e5-452b-9c70-d582d59e68a0"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", "**", "b", "**", "c", "**", "d"}], "q"]], "Output",
 CellChangeTimes->{3.894978205785619*^9},
 CellLabel->"Out[89]=",
 CellID->490810363,ExpressionUUID->"b38e704b-4a3d-4a98-989c-34f881114252"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Inactivate", "[", 
   RowBox[{
    RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
     SuperscriptBox["q", 
      RowBox[{"n", "-", "1"}]]}], ",", "Times"}], "]"}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Inactive", "[", "Times", "]"}], "[", 
     RowBox[{"OrderlessPatternSequence", "[", 
      RowBox[{
       RowBox[{"n", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"_", "^", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#1", ">", "0"}], "&"}], ")"}]}]}], "|", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Denominator", "[", "#1", "]"}], "===", "1"}], "&"}], 
              ")"}]}]}], ")"}], ".."}], ")"}]}], ",", 
       RowBox[{"d", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"_", "^", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]}], "|", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Denominator", "[", "#1", "]"}], "=!=", "1"}], "&"}], 
              ")"}]}]}], ")"}], ".."}], ")"}]}]}], "]"}], "]"}], ":>", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", 
      RowBox[{"{", "d", "}"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8949782265380173`*^9, 3.8949782882597466`*^9}},
 CellLabel->"In[94]:=",
 CellID->404350346,ExpressionUUID->"1c2c1275-4f5d-40e9-9de5-29cee35164df"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
   RowBox[{"{", 
    SuperscriptBox["q", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}]], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8949782279528227`*^9, 3.8949782529560175`*^9}, 
   3.894978288652491*^9},
 CellLabel->"Out[94]=",
 CellID->218827964,ExpressionUUID->"bc3b8eb4-7545-438c-be39-5d5cfedf1c26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Inactivate", "[", 
  RowBox[{
   RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
    SuperscriptBox["q", 
     RowBox[{"n", "-", "1"}]]}], ",", "Times"}], "]"}]], "Input",
 CellLabel->"In[95]:=",
 CellID->690671388,ExpressionUUID->"4dc2b004-a66c-4281-8531-fc6dc77cd526"],

Cell[BoxData[
 RowBox[{"a", 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], "b", 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], "c", 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], "d", 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  SuperscriptBox["q", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]]}]], "Output",
 CellChangeTimes->{3.894978350085149*^9},
 CellLabel->"Out[95]=",
 CellID->763570026,ExpressionUUID->"8505fd7b-8ce9-492d-ad4e-cfa1b68fe834"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   SuperscriptBox["q", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}]], ",", 
   RowBox[{"TrueQ", "[", 
    SuperscriptBox["_", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949783434421186`*^9, 3.8949783899502335`*^9}},
 CellLabel->"In[96]:=",
 CellID->149289639,ExpressionUUID->"a4066e0c-2ad9-4a8c-a1e7-957557721db1"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.894978390382659*^9},
 CellLabel->"Out[96]=",
 CellID->626446846,ExpressionUUID->"b6fadd1e-d000-40c0-9050-4f2474ee9411"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   SuperscriptBox["q", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}]], ",", 
   RowBox[{"_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Denominator", "[", "#1", "]"}], "=!=", "1"}], "&"}], 
     ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949783434421186`*^9, 3.8949784025644016`*^9}},
 CellLabel->"In[97]:=",
 CellID->477936917,ExpressionUUID->"f77d5609-f0a5-4741-8c06-8efaf139c695"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.894978403294839*^9},
 CellLabel->"Out[97]=",
 CellID->125609227,ExpressionUUID->"8e229b96-3fc3-4686-b26f-657acd239245"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"CloudGet", "[", 
  "\"\<https://www.wolframcloud.com/obj/burbery1/cloudfunctions/\
NumeratorTermQ\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.894978538593215*^9, 3.894978545258723*^9}},
 CellLabel->"In[98]:=",
 CellID->29177797,ExpressionUUID->"ed79a72d-971f-4f8c-9804-866fc7fa8f61"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NumeratorTermQ", "[", 
  SuperscriptBox["q", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]], "]"}]], "Input",
 CellChangeTimes->{{3.8949784911974764`*^9, 3.8949784911974764`*^9}, {
  3.894978553994131*^9, 3.8949785559255915`*^9}},
 CellLabel->"In[99]:=",
 CellID->669767948,ExpressionUUID->"250be2f2-8ad0-4efd-b606-8b2c0b0d9947"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.894978556204723*^9},
 CellLabel->"Out[99]=",
 CellID->304190463,ExpressionUUID->"1762b7de-92c2-42f2-b83b-c70628067150"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Inactivate", "[", 
   RowBox[{
    RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
     SuperscriptBox["q", 
      RowBox[{"n", "-", "1"}]]}], ",", "Times"}], "]"}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Inactive", "[", "Times", "]"}], "[", 
     RowBox[{"OrderlessPatternSequence", "[", 
      RowBox[{
       RowBox[{"n", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"_", "^", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#1", ">", "0"}], "&"}], ")"}]}]}], "|", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"NumeratorTermQ", "[", "#1", "]"}], "&"}], ")"}]}]}], 
           ")"}], ".."}], ")"}]}], ",", 
       RowBox[{"d", ":", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"_", "^", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]}], "|", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"DenominatorTermQ", "[", "#1", "]"}], "&"}], ")"}]}]}],
            ")"}], ".."}], ")"}]}]}], "]"}], "]"}], ":>", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", 
      RowBox[{"{", "d", "}"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.894978580879963*^9, 3.8949785930935535`*^9}, {
  3.8949806574558754`*^9, 3.8949806613046722`*^9}},
 CellLabel->"In[32]:=",
 CellID->171821158,ExpressionUUID->"712a2576-2ac3-4f68-9f65-6632b7939ae2"],

Cell[BoxData[
 RowBox[{"a", 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], "b", 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], "c", 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], "d", 
  TagBox["\[Times]",
   "InactiveToken",
   BaseStyle->"Inactive",
   SyntaxForm->"a*b"], 
  SuperscriptBox["q", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]]}]], "Output",
 CellChangeTimes->{{3.894978585003316*^9, 3.894978593605856*^9}, 
   3.894980661875492*^9},
 CellLabel->"Out[32]=",
 CellID->31127353,ExpressionUUID->"7c77c2eb-162b-48ba-b3aa-03b5782f42d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RearrangeFunction2", "[", 
  RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
   SuperscriptBox["q", 
    RowBox[{"n", "-", "1"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.894978683311671*^9, 3.894978689710198*^9}},
 CellLabel->"In[105]:=",
 CellID->56910265,ExpressionUUID->"67830dbc-942f-4041-83ca-5d832cbcf0e1"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["q", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]], "**", "a", "**", "b", "**", "c", "**", 
  "d"}]], "Output",
 CellChangeTimes->{3.89497869030099*^9},
 CellLabel->"Out[105]=",
 CellID->1010161959,ExpressionUUID->"16f5ba4c-50d5-424a-9a51-d30e9dbdfebe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RearrangeMultiplicativeSubExpressions", "[", 
  RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
   SuperscriptBox["q", 
    RowBox[{"n", "-", "1"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.894980711037059*^9, 3.894980718782871*^9}},
 CellLabel->"In[35]:=",
 CellID->93964102,ExpressionUUID->"61f47128-ddcd-4934-a0d0-7bcb36a78241"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", "**", "b", "**", "c", "**", "d"}], "q"]], "Output",
 CellChangeTimes->{3.894980719392506*^9},
 CellLabel->"Out[35]=",
 CellID->122682045,ExpressionUUID->"46e501f7-ae1b-4401-a27f-e97d35282ccc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "firstoutput", "}"}], ",", " ", "\n", " ", 
   RowBox[{
    RowBox[{"firstoutput", " ", "=", " ", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactivate", "[", 
        RowBox[{
         RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
          SuperscriptBox["q", 
           RowBox[{"n", "-", "1"}]]}], ",", " ", "\n", "     ", "Times"}], 
        "]"}], " ", "//.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "Times", "]"}], "[", 
           RowBox[{"i", " ", ":", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"_", "?", "AtomQ"}], " ", ".."}], ")"}]}], "]"}], " ", ":>",
           " ", "\n", "      ", 
          RowBox[{"NonCommutativeMultiply", " ", "@@", " ", 
           RowBox[{"PositionQInFrontOfList", "[", 
            RowBox[{"{", "i", "}"}], "]"}]}]}], ",", " ", "\n", "     ", 
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "Times", "]"}], "[", "\n", "       ", 
           RowBox[{"OrderlessPatternSequence", "[", "\n", "        ", 
            RowBox[{
             RowBox[{"n", " ", ":", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"_", "^", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", " ", ">", " ", "0"}], " ", "&"}], ")"}]}]}],
                   " ", "|", " ", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumeratorTermQ", "[", "#1", "]"}], " ", "&"}], 
                    ")"}]}]}], ")"}], " ", ".."}], ")"}]}], ",", " ", "\n", 
             "        ", 
             RowBox[{"d", " ", ":", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"_", "^", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "#1", " ", "<", " ", "\n", "                  ", "0"}], 
                    " ", "&"}], ")"}]}]}], " ", "|", " ", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"DenominatorTermQ", "[", "#1", "]"}], " ", "&"}], 
                    ")"}]}]}], ")"}], " ", ".."}], ")"}]}]}], "]"}], "]"}], 
          " ", ":>", " ", 
          RowBox[{
           RowBox[{"\\\n", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", " ", "@@", " ", 
               RowBox[{"PositionQInFrontOfList", "[", 
                RowBox[{"{", "n", "}"}], "]"}]}], " ", "/.", "\n", 
              "         ", "\n", "         ", 
              RowBox[{
               RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], " ", ":>", 
               " ", "x"}]}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "NonCommutativeMultiply", " ", "@@", " ", "\n", "          ", 
              RowBox[{"PositionQInFrontOfList", "[", 
               RowBox[{"Denominator", " ", "/@", " ", 
                RowBox[{"{", "d", "}"}]}], "]"}]}], " ", "/.", " ", "\n", 
             "         ", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", "[", "y_", "]"}], " ", ":>", 
              " ", "y"}]}], ")"}]}]}], ",", " ", "\n", "     ", 
         RowBox[{
          RowBox[{"NonCommutativeMultiply", "[", 
           RowBox[{"i", " ", ":", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], " ", ".."}], ")"}]}], "]"}], 
          " ", ":>", " ", 
          RowBox[{"Times", "[", "i", "]"}]}], ",", " ", "\n", "     ", 
         RowBox[{
          RowBox[{
           RowBox[{"u", " ", ":", " ", 
            RowBox[{"NonCommutativeMultiply", "[", "___", "]"}]}], " ", "/;", 
           " ", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"u", ",", " ", 
              RowBox[{"q", " ", "|", " ", 
               RowBox[{"q", "^", "_"}]}]}], "]"}], " ", "!=", " ", 
            RowBox[{"{", "}"}]}]}], " ", ":>", " ", "\n", "      ", 
          RowBox[{"NonCommutativeMultiply", " ", "@@", " ", 
           RowBox[{"PositionQInFrontOfList", "[", 
            RowBox[{"List", " ", "@@", " ", "u"}], "]"}]}]}], ",", " ", "\n", 
         "     ", 
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "Times", "]"}], "[", "y__", "]"}], " ", ":>",
           " ", 
          RowBox[{"NonCommutativeMultiply", "[", "y", "]"}]}]}], "}"}]}], " ",
       "/.", " ", "\n", "   ", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactive", "[", "Times", "]"}], "[", 
        RowBox[{"i", " ", ":", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], " ", ".."}], ")"}]}], "]"}], " ", ":>",
        " ", 
       RowBox[{"Times", "[", "i", "]"}]}]}]}], ";", "\n", " ", 
    RowBox[{"Replace", "[", "\n", "  ", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"DeleteCases", "[", "\n", "    ", 
         RowBox[{
          RowBox[{"firstoutput", " ", "/.", " ", "\n", "     ", 
           RowBox[{
            RowBox[{
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"numbers", " ", ":", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], " ", ".."}], ")"}]}], ",", 
               " ", "\n", "        ", 
               RowBox[{"symbols", " ", ":", " ", 
                RowBox[{"(", 
                 RowBox[{"_Symbol", " ", "..."}], ")"}]}], ",", " ", "\n", 
               "        ", 
               RowBox[{"powers", " ", ":", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"_", "^", "_."}], " ", ".."}], ")"}]}]}], "]"}], 
             " ", "**", " ", 
             RowBox[{"(", 
              RowBox[{"plus", " ", ":", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"+", "__"}], ")"}], " ", "..."}], ")"}]}], ")"}]}], 
            " ", ":>", " ", "\n", "      ", 
            RowBox[{
             RowBox[{"Times", " ", "@@", " ", "numbers"}], " ", 
             RowBox[{
             "NonCommutativeMultiply", " ", "@@", " ", "\n", "        ", 
              RowBox[{"PositionQInFrontOfList", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", "symbols", "}"}], ",", " ", 
                 RowBox[{"{", "powers", "}"}], ",", " ", 
                 RowBox[{"{", "plus", "}"}]}], "]"}], "]"}]}]}]}]}], ",", " ",
           "\n", "    ", 
          RowBox[{"NonCommutativeMultiply", "[", "]"}], ",", " ", "All"}], 
         "]"}], ",", " ", 
        RowBox[{
         RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], " ", ":>", " ", 
         "x"}], ",", " ", "\n", "   ", "All"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NonCommutativeMultiply", "[", "\n", "     ", 
         RowBox[{
          RowBox[{"nonqs", " ", ":", " ", 
           RowBox[{"Repeated", "[", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], " ", "==", " ", "Symbol"}], 
                " ", "&&", " ", 
                RowBox[{"#", " ", "=!=", " ", "q"}]}], " ", "&"}], ")"}]}], 
            "]"}]}], ",", " ", "\n", "     ", 
          RowBox[{"qs", " ", ":", " ", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"NonCommutativeMultiply", "[", 
              RowBox[{"q", ",", " ", "_"}], "]"}], ",", " ", "_"}], "]"}]}]}],
          "]"}], " ", ":>", " ", "\n", "    ", 
        RowBox[{"NonCommutativeMultiply", "[", 
         RowBox[{"qs", ",", " ", "nonqs"}], "]"}]}], "}"}], ",", " ", "All"}],
      "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{3.8949815673670273`*^9},
 CellLabel->"In[6]:=",
 CellID->21969815,ExpressionUUID->"0cacd8f5-23dc-4ea0-ac55-a8d2c46faef8"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["q", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]], "**", "a", "**", "b", "**", "c", "**", 
  "d"}]], "Output",
 CellChangeTimes->{3.8949815689227724`*^9},
 CellLabel->"Out[6]=",
 CellID->157418928,ExpressionUUID->"e67930fe-c619-44f7-89b3-a87489619bf5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{
   "{", "PeterBurbery`BasicHypergeometricFunctions`Private`firstoutput", 
    "}"}], ",", 
   RowBox[{
    RowBox[{
    "PeterBurbery`BasicHypergeometricFunctions`Private`firstoutput", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactivate", "[", 
        RowBox[{
         RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
          SuperscriptBox["q", 
           RowBox[{"n", "-", "1"}]]}], ",", "Times"}], "]"}], "//.", 
       "\[VeryThinSpace]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "Times", "]"}], "[", 
           RowBox[{"PeterBurbery`BasicHypergeometricFunctions`Private`i", ":", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"NonCommutativeMultiply", "@@", 
           RowBox[{"PositionQInFrontOfList", "[", 
            RowBox[{
            "{", "PeterBurbery`BasicHypergeometricFunctions`Private`i", "}"}],
             "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "Times", "]"}], "[", 
           RowBox[{"OrderlessPatternSequence", "[", 
            RowBox[{
             RowBox[{
             "PeterBurbery`BasicHypergeometricFunctions`Private`n", ":", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["_", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", ">", "0"}], "&"}], ")"}]}]], "|", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "PeterBurbery`BasicHypergeometricFunctions`Private`\
NumeratorTermQ", "[", "#1", "]"}], "&"}], ")"}]}]}], ")"}], ".."}], ")"}]}], 
             ",", 
             RowBox[{
             "PeterBurbery`BasicHypergeometricFunctions`Private`d", ":", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["_", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]], "|", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "PeterBurbery`BasicHypergeometricFunctions`Private`\
DenominatorTermQ", "[", "#1", "]"}], "&"}], ")"}]}]}], ")"}], ".."}], 
               ")"}]}]}], "]"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"NonCommutativeMultiply", "@@", 
              RowBox[{"PositionQInFrontOfList", "[", 
               RowBox[{
               "{", "PeterBurbery`BasicHypergeometricFunctions`Private`n", 
                "}"}], "]"}]}], "/.", "\[VeryThinSpace]", 
             RowBox[{
              RowBox[{
              "NonCommutativeMultiply", "[", 
               "PeterBurbery`BasicHypergeometricFunctions`Private`x_", "]"}], 
              "\[RuleDelayed]", 
              "PeterBurbery`BasicHypergeometricFunctions`Private`x"}]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"NonCommutativeMultiply", "@@", 
              RowBox[{"PositionQInFrontOfList", "[", 
               RowBox[{"Denominator", "/@", 
                RowBox[{
                "{", "PeterBurbery`BasicHypergeometricFunctions`Private`d", 
                 "}"}]}], "]"}]}], "/.", "\[VeryThinSpace]", 
             RowBox[{
              RowBox[{
              "NonCommutativeMultiply", "[", 
               "PeterBurbery`BasicHypergeometricFunctions`Private`y_", "]"}], 
              "\[RuleDelayed]", 
              "PeterBurbery`BasicHypergeometricFunctions`Private`y"}]}], 
            ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"NonCommutativeMultiply", "[", 
           RowBox[{"PeterBurbery`BasicHypergeometricFunctions`Private`i", ":", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
          "Times", "[", "PeterBurbery`BasicHypergeometricFunctions`Private`i",
            "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"PeterBurbery`BasicHypergeometricFunctions`Private`u", ":", 
            RowBox[{"NonCommutativeMultiply", "[", "___", "]"}]}], "/;", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
             "PeterBurbery`BasicHypergeometricFunctions`Private`u", ",", 
              RowBox[{
              "PeterBurbery`BasicHypergeometricFunctions`Private`q", "|", 
               
               SuperscriptBox[
                "PeterBurbery`BasicHypergeometricFunctions`Private`q", 
                "_"]}]}], "]"}], "\[NotEqual]", 
            RowBox[{"{", "}"}]}]}], "\[RuleDelayed]", 
          RowBox[{"NonCommutativeMultiply", "@@", 
           RowBox[{"PositionQInFrontOfList", "[", 
            RowBox[{
            "List", "@@", 
             "PeterBurbery`BasicHypergeometricFunctions`Private`u"}], 
            "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "Times", "]"}], "[", 
           "PeterBurbery`BasicHypergeometricFunctions`Private`y__", "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
          "NonCommutativeMultiply", "[", 
           "PeterBurbery`BasicHypergeometricFunctions`Private`y", "]"}]}]}], 
        "}"}]}], "/.", "\[VeryThinSpace]", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactive", "[", "Times", "]"}], "[", 
        RowBox[{"PeterBurbery`BasicHypergeometricFunctions`Private`i", ":", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{
       "Times", "[", "PeterBurbery`BasicHypergeometricFunctions`Private`i", 
        "]"}]}]}]}], ";", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
          "PeterBurbery`BasicHypergeometricFunctions`Private`firstoutput", "/.",
            "\[VeryThinSpace]", 
           RowBox[{
            RowBox[{
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{
               "PeterBurbery`BasicHypergeometricFunctions`Private`numbers", 
                ":", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], ",", 
               RowBox[{
               "PeterBurbery`BasicHypergeometricFunctions`Private`symbols", 
                ":", 
                RowBox[{"(", 
                 RowBox[{"_Symbol", "..."}], ")"}]}], ",", 
               RowBox[{
               "PeterBurbery`BasicHypergeometricFunctions`Private`powers", 
                ":", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["_", "_."], ".."}], ")"}]}]}], "]"}], "**", 
             RowBox[{"(", 
              RowBox[{
              "PeterBurbery`BasicHypergeometricFunctions`Private`plus", ":", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"+", "__"}], ")"}], "..."}], ")"}]}], ")"}]}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
             "Times", "@@", 
              "PeterBurbery`BasicHypergeometricFunctions`Private`numbers"}], 
             " ", 
             RowBox[{"NonCommutativeMultiply", "@@", 
              RowBox[{"PositionQInFrontOfList", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{
                 "{", "PeterBurbery`BasicHypergeometricFunctions`Private`\
symbols", "}"}], ",", 
                 RowBox[{
                 "{", "PeterBurbery`BasicHypergeometricFunctions`Private`\
powers", "}"}], ",", 
                 RowBox[{
                 "{", "PeterBurbery`BasicHypergeometricFunctions`Private`\
plus", "}"}]}], "]"}], "]"}]}]}]}]}], ",", 
          RowBox[{"NonCommutativeMultiply", "[", "]"}], ",", "All"}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{
         "NonCommutativeMultiply", "[", 
          "PeterBurbery`BasicHypergeometricFunctions`Private`x_", "]"}], 
         "\[RuleDelayed]", 
         "PeterBurbery`BasicHypergeometricFunctions`Private`x"}], ",", 
        "All"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "PeterBurbery`BasicHypergeometricFunctions`Private`nonqs", ":", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "#1", "]"}], "\[Equal]", "Symbol"}], "&&", 
                 RowBox[{
                 "#1", "=!=", 
                  "PeterBurbery`BasicHypergeometricFunctions`Private`q"}]}], 
                "&"}], ")"}]}], ".."}], ")"}]}], ")"}], "**", 
         RowBox[{"(", 
          RowBox[{"PeterBurbery`BasicHypergeometricFunctions`Private`qs", ":", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
             "PeterBurbery`BasicHypergeometricFunctions`Private`q", "**", 
              "_"}], ")"}], "_"]}], ")"}]}], "\[RuleDelayed]", 
        RowBox[{
        "PeterBurbery`BasicHypergeometricFunctions`Private`qs", "**", 
         "PeterBurbery`BasicHypergeometricFunctions`Private`nonqs"}]}], "}"}],
       ",", "All"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{3.894981634088307*^9},
 CellLabel->"In[11]:=",
 CellID->173646475,ExpressionUUID->"8166455e-febd-4dac-b422-66f59e9787e0"],

Cell[BoxData[
 RowBox[{"a", "**", "b", "**", "c", "**", "d", "**", 
  SuperscriptBox["q", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]]}]], "Output",
 CellChangeTimes->{3.8949816352760525`*^9, 3.894981897511026*^9},
 CellLabel->"Out[11]=",
 CellID->202299149,ExpressionUUID->"32ac0768-b6a0-47e9-beb7-94ec0c80417a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{
   "{", "PeterBurbery`BasicHypergeometricFunctions`Private`firstoutput", 
    "}"}], ",", 
   RowBox[{
    RowBox[{
    "PeterBurbery`BasicHypergeometricFunctions`Private`firstoutput", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Inactivate", "[", 
        RowBox[{
         RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
          SuperscriptBox["q", 
           RowBox[{"n", "-", "1"}]]}], ",", "Times"}], "]"}], "//.", 
       "\[VeryThinSpace]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "Times", "]"}], "[", 
           RowBox[{"PeterBurbery`BasicHypergeometricFunctions`Private`i", ":", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"NonCommutativeMultiply", "@@", 
           RowBox[{"PositionQInFrontOfList", "[", 
            RowBox[{
            "{", "PeterBurbery`BasicHypergeometricFunctions`Private`i", "}"}],
             "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "Times", "]"}], "[", 
           RowBox[{"OrderlessPatternSequence", "[", 
            RowBox[{
             RowBox[{"n", ":", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["_", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", ">", "0"}], "&"}], ")"}]}]], "|", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "PeterBurbery`BasicHypergeometricFunctions`Private`\
NumeratorTermQ", "[", "#1", "]"}], "&"}], ")"}]}]}], ")"}], ".."}], ")"}]}], 
             ",", 
             RowBox[{"d", ":", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["_", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]], "|", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "PeterBurbery`BasicHypergeometricFunctions`Private`\
DenominatorTermQ", "[", "#1", "]"}], "&"}], ")"}]}]}], ")"}], ".."}], 
               ")"}]}]}], "]"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"NonCommutativeMultiply", "@@", 
              RowBox[{"PositionQInFrontOfList", "[", 
               RowBox[{"{", "n", "}"}], "]"}]}], "/.", "\[VeryThinSpace]", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], 
              "\[RuleDelayed]", "x"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"NonCommutativeMultiply", "@@", 
              RowBox[{"PositionQInFrontOfList", "[", 
               RowBox[{"Denominator", "/@", 
                RowBox[{"{", "d", "}"}]}], "]"}]}], "/.", "\[VeryThinSpace]", 
             RowBox[{
              RowBox[{"NonCommutativeMultiply", "[", "y_", "]"}], 
              "\[RuleDelayed]", "y"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"NonCommutativeMultiply", "[", 
           RowBox[{"i", ":", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"Times", "[", "i", "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"u", ":", 
            RowBox[{"NonCommutativeMultiply", "[", "___", "]"}]}], "/;", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"u", ",", 
              RowBox[{"q", "|", 
               SuperscriptBox["q", "_"]}]}], "]"}], "\[NotEqual]", 
            RowBox[{"{", "}"}]}]}], "\[RuleDelayed]", 
          RowBox[{"NonCommutativeMultiply", "@@", 
           RowBox[{"PositionQInFrontOfList", "[", 
            RowBox[{"List", "@@", "u"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Inactive", "[", "Times", "]"}], "[", "y__", "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"NonCommutativeMultiply", "[", "y", "]"}]}]}], "}"}]}], "/.",
       "\[VeryThinSpace]", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactive", "[", "Times", "]"}], "[", 
        RowBox[{"i", ":", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Times", "[", "i", "]"}]}]}]}], ";", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
          "PeterBurbery`BasicHypergeometricFunctions`Private`firstoutput", "/.",
            "\[VeryThinSpace]", 
           RowBox[{
            RowBox[{
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"numbers", ":", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], ",", 
               RowBox[{"symbols", ":", 
                RowBox[{"(", 
                 RowBox[{"_Symbol", "..."}], ")"}]}], ",", 
               RowBox[{"powers", ":", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["_", "_."], ".."}], ")"}]}]}], "]"}], "**", 
             RowBox[{"(", 
              RowBox[{"plus", ":", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"+", "__"}], ")"}], "..."}], ")"}]}], ")"}]}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"Times", "@@", "numbers"}], " ", 
             RowBox[{"NonCommutativeMultiply", "@@", 
              RowBox[{"PositionQInFrontOfList", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", "symbols", "}"}], ",", 
                 RowBox[{"{", "powers", "}"}], ",", 
                 RowBox[{"{", "plus", "}"}]}], "]"}], "]"}]}]}]}]}], ",", 
          RowBox[{"NonCommutativeMultiply", "[", "]"}], ",", "All"}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"NonCommutativeMultiply", "[", "x_", "]"}], "\[RuleDelayed]",
          "x"}], ",", "All"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"nonqs", ":", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "#1", "]"}], "\[Equal]", "Symbol"}], "&&", 
                 RowBox[{"#1", "=!=", "q"}]}], "&"}], ")"}]}], ".."}], 
            ")"}]}], ")"}], "**", 
         RowBox[{"(", 
          RowBox[{"qs", ":", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q", "**", "_"}], ")"}], "_"]}], ")"}]}], 
        "\[RuleDelayed]", 
        RowBox[{"qs", "**", "nonqs"}]}], "}"}], ",", "All"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.894981654864444*^9, 3.894981771533656*^9}},
 CellLabel->"In[8]:=",
 CellID->30857652,ExpressionUUID->"de2936b4-acfa-49d3-b894-732c03afb353"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["q", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]], "**", "a", "**", "b", "**", "c", "**", 
  "d"}]], "Output",
 CellChangeTimes->{3.894981773738967*^9},
 CellLabel->"Out[8]=",
 CellID->516730849,ExpressionUUID->"c7bf196a-8ddd-425c-b530-23f2eedd2aaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "q", ",", "n"}], "}"}], 
   ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{
     "{", "PeterBurbery`BasicHypergeometricFunctions`Private`firstoutput", 
      "}"}], ",", 
     RowBox[{
      RowBox[{
      "PeterBurbery`BasicHypergeometricFunctions`Private`firstoutput", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Inactivate", "[", 
          RowBox[{
           RowBox[{"a", " ", "b", " ", "c", " ", "d", " ", 
            SuperscriptBox["q", 
             RowBox[{"n", "-", "1"}]]}], ",", "Times"}], "]"}], "//.", 
         "\[VeryThinSpace]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Inactive", "[", "Times", "]"}], "[", 
             RowBox[{
             "PeterBurbery`BasicHypergeometricFunctions`Private`i", ":", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"_", "?", "AtomQ"}], ".."}], ")"}]}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"NonCommutativeMultiply", "@@", 
             RowBox[{"PositionQInFrontOfList", "[", 
              RowBox[{
              "{", "PeterBurbery`BasicHypergeometricFunctions`Private`i", 
               "}"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Inactive", "[", "Times", "]"}], "[", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{
               "PeterBurbery`BasicHypergeometricFunctions`Private`n", ":", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["_", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", ">", "0"}], "&"}], ")"}]}]], "|", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "PeterBurbery`BasicHypergeometricFunctions`Private`\
NumeratorTermQ", "[", "#1", "]"}], "&"}], ")"}]}]}], ")"}], ".."}], ")"}]}], 
               ",", 
               RowBox[{
               "PeterBurbery`BasicHypergeometricFunctions`Private`d", ":", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["_", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "<", "0"}], "&"}], ")"}]}]], "|", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "PeterBurbery`BasicHypergeometricFunctions`Private`\
DenominatorTermQ", "[", "#1", "]"}], "&"}], ")"}]}]}], ")"}], ".."}], 
                 ")"}]}]}], "]"}], "]"}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"NonCommutativeMultiply", "@@", 
                RowBox[{"PositionQInFrontOfList", "[", 
                 RowBox[{
                 "{", "PeterBurbery`BasicHypergeometricFunctions`Private`n", 
                  "}"}], "]"}]}], "/.", "\[VeryThinSpace]", 
               RowBox[{
                RowBox[{
                "NonCommutativeMultiply", "[", 
                 "PeterBurbery`BasicHypergeometricFunctions`Private`x_", 
                 "]"}], "\[RuleDelayed]", 
                "PeterBurbery`BasicHypergeometricFunctions`Private`x"}]}], 
              ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"NonCommutativeMultiply", "@@", 
                RowBox[{"PositionQInFrontOfList", "[", 
                 RowBox[{"Denominator", "/@", 
                  RowBox[{
                  "{", "PeterBurbery`BasicHypergeometricFunctions`Private`d", 
                   "}"}]}], "]"}]}], "/.", "\[VeryThinSpace]", 
               RowBox[{
                RowBox[{
                "NonCommutativeMultiply", "[", 
                 "PeterBurbery`BasicHypergeometricFunctions`Private`y_", 
                 "]"}], "\[RuleDelayed]", 
                "PeterBurbery`BasicHypergeometricFunctions`Private`y"}]}], 
              ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"NonCommutativeMultiply", "[", 
             RowBox[{
             "PeterBurbery`BasicHypergeometricFunctions`Private`i", ":", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{
            "Times", "[", 
             "PeterBurbery`BasicHypergeometricFunctions`Private`i", "]"}]}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "PeterBurbery`BasicHypergeometricFunctions`Private`u", ":", 
              RowBox[{"NonCommutativeMultiply", "[", "___", "]"}]}], "/;", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
               "PeterBurbery`BasicHypergeometricFunctions`Private`u", ",", 
                RowBox[{
                "PeterBurbery`BasicHypergeometricFunctions`Private`q", "|", 
                 
                 SuperscriptBox[
                  "PeterBurbery`BasicHypergeometricFunctions`Private`q", 
                  "_"]}]}], "]"}], "\[NotEqual]", 
              RowBox[{"{", "}"}]}]}], "\[RuleDelayed]", 
            RowBox[{"NonCommutativeMultiply", "@@", 
             RowBox[{"PositionQInFrontOfList", "[", 
              RowBox[{
              "List", "@@", 
               "PeterBurbery`BasicHypergeometricFunctions`Private`u"}], 
              "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Inactive", "[", "Times", "]"}], "[", 
             "PeterBurbery`BasicHypergeometricFunctions`Private`y__", "]"}], 
            "\[RuleDelayed]", 
            RowBox[{
            "NonCommutativeMultiply", "[", 
             "PeterBurbery`BasicHypergeometricFunctions`Private`y", "]"}]}]}],
           "}"}]}], "/.", "\[VeryThinSpace]", 
        RowBox[{
         RowBox[{
          RowBox[{"Inactive", "[", "Times", "]"}], "[", 
          RowBox[{"PeterBurbery`BasicHypergeometricFunctions`Private`i", ":", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{
         "Times", "[", "PeterBurbery`BasicHypergeometricFunctions`Private`i", 
          "]"}]}]}]}], ";", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
            "PeterBurbery`BasicHypergeometricFunctions`Private`firstoutput", "/.",
              "\[VeryThinSpace]", 
             RowBox[{
              RowBox[{
               RowBox[{"OrderlessPatternSequence", "[", 
                RowBox[{
                 RowBox[{
                 "PeterBurbery`BasicHypergeometricFunctions`Private`numbers", 
                  ":", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"_", "?", "NumericQ"}], ".."}], ")"}]}], ",", 
                 RowBox[{
                 "PeterBurbery`BasicHypergeometricFunctions`Private`symbols", 
                  ":", 
                  RowBox[{"(", 
                   RowBox[{"_Symbol", "..."}], ")"}]}], ",", 
                 RowBox[{
                 "PeterBurbery`BasicHypergeometricFunctions`Private`powers", 
                  ":", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["_", "_."], ".."}], ")"}]}]}], "]"}], "**", 
               RowBox[{"(", 
                RowBox[{
                "PeterBurbery`BasicHypergeometricFunctions`Private`plus", ":", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"+", "__"}], ")"}], "..."}], ")"}]}], ")"}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{
               "Times", "@@", 
                "PeterBurbery`BasicHypergeometricFunctions`Private`numbers"}],
                " ", 
               RowBox[{"NonCommutativeMultiply", "@@", 
                RowBox[{"PositionQInFrontOfList", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                   "{", "PeterBurbery`BasicHypergeometricFunctions`Private`\
symbols", "}"}], ",", 
                   RowBox[{
                   "{", "PeterBurbery`BasicHypergeometricFunctions`Private`\
powers", "}"}], ",", 
                   RowBox[{
                   "{", "PeterBurbery`BasicHypergeometricFunctions`Private`\
plus", "}"}]}], "]"}], "]"}]}]}]}]}], ",", 
            RowBox[{"NonCommutativeMultiply", "[", "]"}], ",", "All"}], "]"}],
           ",", 
          RowBox[{
           RowBox[{
           "NonCommutativeMultiply", "[", 
            "PeterBurbery`BasicHypergeometricFunctions`Private`x_", "]"}], 
           "\[RuleDelayed]", 
           "PeterBurbery`BasicHypergeometricFunctions`Private`x"}], ",", 
          "All"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "PeterBurbery`BasicHypergeometricFunctions`Private`nonqs", ":", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Head", "[", "#1", "]"}], "\[Equal]", "Symbol"}], 
                   "&&", 
                   RowBox[{
                   "#1", "=!=", 
                    "PeterBurbery`BasicHypergeometricFunctions`Private`q"}]}],
                   "&"}], ")"}]}], ".."}], ")"}]}], ")"}], "**", 
           RowBox[{"(", 
            RowBox[{
            "PeterBurbery`BasicHypergeometricFunctions`Private`qs", ":", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
               "PeterBurbery`BasicHypergeometricFunctions`Private`q", "**", 
                "_"}], ")"}], "_"]}], ")"}]}], "\[RuleDelayed]", 
          RowBox[{
          "PeterBurbery`BasicHypergeometricFunctions`Private`qs", "**", 
           "PeterBurbery`BasicHypergeometricFunctions`Private`nonqs"}]}], 
         "}"}], ",", "All"}], "]"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8949817848290215`*^9, 3.894981801164785*^9}},
 CellLabel->"In[10]:=",
 CellID->34212862,ExpressionUUID->"180f119f-213a-4120-ad9e-5dbda72e643d"],

Cell[BoxData[
 RowBox[{"a", "**", "b", "**", "c", "**", "d", "**", 
  SuperscriptBox["q", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]]}]], "Output",
 CellChangeTimes->{{3.8949817882600565`*^9, 3.8949818017795935`*^9}},
 CellLabel->"Out[10]=",
 CellID->76091348,ExpressionUUID->"23847299-afed-4fcd-a99b-eafd7ab717a0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Guides", "TutorialMoreAboutSection",
 CellChangeTimes->{{3.843042384656711*^9, 3.843042386024461*^9}},
 CellID->161772049,ExpressionUUID->"76801787-5f70-41d3-a497-142c85e4f5f5"],

Cell["XXXX", "TutorialMoreAbout",
 CellID->67989278,ExpressionUUID->"293b3931-85af-4829-9e80-7b6c6a37d4eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Tech Notes", "RelatedTutorialsSection",
 CellID->183639716,ExpressionUUID->"b843fff2-33d9-4c3f-83b8-39883e476e35"],

Cell["XXXX", "RelatedTutorials",
 CellID->29667343,ExpressionUUID->"3ca477f5-83dd-45cf-97d5-2f16fcf8c0a1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metadata", "MetadataSection",
 CellID->213044136,ExpressionUUID->"f70824db-8bb0-4d0d-a14e-72f55559f5eb"],

Cell[TextData[{
 "New in: ",
 Cell["XX", "HistoryData",
  CellTags->"New",ExpressionUUID->"00750a98-0d8b-4ac9-a585-78078de9c9c1"],
 " | Modified in: ",
 Cell[" ", "HistoryData",
  CellTags->"Modified",ExpressionUUID->"d9f1acff-d511-4f24-bff4-6f819a656bdf"],
 " | Obsolete in: ",
 Cell[" ", "HistoryData",
  CellTags->"Obsolete",ExpressionUUID->"35277e2a-5bd5-4a8a-8d1f-f226c2768b16"]
}], "History",
 CellID->72794903,ExpressionUUID->"1fbf2634-130c-4a42-b1fd-588c4e7a8f5b"],

Cell[CellGroupData[{

Cell["Categorization", "CategorizationSection",
 CellID->385949988,ExpressionUUID->"1aa13a2a-d527-4b88-a6f6-f464858515fe"],

Cell["Tech Note", "Categorization",
 CellLabel->"Entity Type",
 CellID->509057587,ExpressionUUID->"ae94e6e3-6a49-4d7e-bb24-26a709fea1f8"],

Cell["PeterBurbery/BasicHypergeometricFunctions", "Categorization",
 CellLabel->"Paclet Name",
 CellID->519804101,ExpressionUUID->"c05029b2-5853-47e8-8989-2c88539ca3a9"],

Cell["PeterBurbery`BasicHypergeometricFunctions`", "Categorization",
 CellLabel->"Context",
 CellID->392509224,ExpressionUUID->"44216c23-99d0-4901-8e9a-cf8468fac854"],

Cell["\<\
PeterBurbery/BasicHypergeometricFunctions/tutorial/RearrangingExpressions\
\>", "Categorization",
 CellLabel->"URI",
 CellID->22346959,ExpressionUUID->"764c4ddd-b0e0-480f-80bd-532b6aa0f96f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Keywords", "KeywordsSection",
 CellID->426123361,ExpressionUUID->"bf86c44b-4960-45b2-b08f-b5f2b7bff7e6"],

Cell["XXXX", "Keywords",
 CellID->393918541,ExpressionUUID->"196dd428-ec9d-4b25-82c2-5e89d985bbff"]
}, Closed]]
}, Open  ]]
},
WindowSize->{574.8, 579.6},
WindowMargins->{{-4.8, Automatic}, {Automatic, 0}},
TaggingRules-><|"Paclet" -> "PeterBurbery/BasicHypergeometricFunctions"|>,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (May 18, 2023)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "TechNotePageStylesExt.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"ab883cbf-4143-4b6c-8411-58fb2a297181"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "1e264c9a-d32f-444c-996b-0bb1b507d08a"->{
  Cell[348266, 9723, 1480, 42, 24, "EchoAfter",ExpressionUUID->"db7c6fb7-bb00-4871-a8a4-db62aeb14ff1",
   CellTags->"1e264c9a-d32f-444c-996b-0bb1b507d08a",
   CellID->257068581]},
 "407df68d-e655-417b-9ff2-0449c81d58ef"->{
  Cell[347492, 9701, 771, 20, 24, "EchoBefore",ExpressionUUID->"104d456c-ed20-4f85-a700-42712bc8cd17",
   CellTags->"407df68d-e655-417b-9ff2-0449c81d58ef",
   CellID->585255656]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"1e264c9a-d32f-444c-996b-0bb1b507d08a", 414955, 11537},
 {"407df68d-e655-417b-9ff2-0449c81d58ef", 415178, 11541}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 115, 1, 114, "Title",ExpressionUUID->"4392a549-f5bc-4eed-86cd-bd4f56abb022",
 CellID->555292541],
Cell[698, 25, 424, 8, 44, "Text",ExpressionUUID->"da171d77-9ecf-45b9-aa05-d6d9041a939a",
 CellID->34242218],
Cell[CellGroupData[{
Cell[1147, 37, 189, 2, 40, "MathCaption",ExpressionUUID->"7bada169-7c3d-4776-b7f7-9de2435b9070",
 CellID->513850824],
Cell[1339, 41, 252, 4, 25, "Input",ExpressionUUID->"0dee9fdd-35d3-4720-adb9-0ac50b09f781",
 CellID->542855510]
}, Open  ]],
Cell[CellGroupData[{
Cell[1628, 50, 301, 4, 45, "Section",ExpressionUUID->"e289c6af-e7f4-4b1c-818e-9eda6dd9cb82",
 CellID->2591],
Cell[CellGroupData[{
Cell[1954, 58, 288, 5, 44, "Text",ExpressionUUID->"b612293d-b26c-4a4f-9c16-0ee176d43931",
 CellID->590619292],
Cell[CellGroupData[{
Cell[2267, 67, 330, 7, 25, "Input",ExpressionUUID->"c005b7de-a8c7-45df-9f11-f64113601e19",
 CellID->219423307],
Cell[2600, 76, 256, 6, 24, "Output",ExpressionUUID->"9e37fe5e-f82a-4f84-a340-a0975f379d0a",
 CellID->272831206]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2917, 89, 351, 5, 45, "Section",ExpressionUUID->"00036f6a-63fd-4f4f-a2de-66a749e3d47c",
 CellID->237748664],
Cell[CellGroupData[{
Cell[3293, 98, 240, 3, 40, "MathCaption",ExpressionUUID->"e250cd9f-9b0e-4e7b-8c8b-dd8939ecf38b",
 CellID->30906755],
Cell[CellGroupData[{
Cell[3558, 105, 336, 7, 25, "Input",ExpressionUUID->"1542516c-d21f-43bc-a96f-434c0b7c4782",
 CellID->501709717],
Cell[3897, 114, 316, 7, 25, "Output",ExpressionUUID->"488c71cf-7b69-4b59-85bc-82928f353118",
 CellID->187249567]
}, Open  ]],
Cell[CellGroupData[{
Cell[4250, 126, 243, 4, 25, "Input",ExpressionUUID->"afa7c4e4-7e9c-42d8-8885-a887ef7faee4",
 CellID->45907700],
Cell[4496, 132, 11190, 300, 178, "Output",ExpressionUUID->"8107efe8-ed22-4c56-87de-5eaa90656bb7",
 CellID->895181536]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15735, 438, 254, 4, 40, "MathCaption",ExpressionUUID->"f8838af4-b20d-4ec5-a66f-f7d8b078f083",
 CellID->340949841],
Cell[CellGroupData[{
Cell[16014, 446, 263, 5, 25, "Input",ExpressionUUID->"3ffb77c4-590c-4ead-a50c-cb1b18c855f9",
 CellID->152984908],
Cell[16280, 453, 235, 5, 24, "Output",ExpressionUUID->"c93a09c0-c592-4a37-a1c9-a736cb2815d0",
 CellID->130135511]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16564, 464, 222, 2, 40, "MathCaption",ExpressionUUID->"2e56b696-7921-4dd2-bf7d-0c15be4b3e70",
 CellID->579788294],
Cell[CellGroupData[{
Cell[16811, 470, 250, 5, 25, "Input",ExpressionUUID->"9e3189cf-1dac-4683-b068-aa39e4a347fe",
 CellID->8585758],
Cell[17064, 477, 213, 4, 24, "Output",ExpressionUUID->"4705ed4c-77f3-4d52-93c1-3e4e4dd55fb2",
 CellID->15928604]
}, Open  ]],
Cell[CellGroupData[{
Cell[17314, 486, 269, 5, 25, "Input",ExpressionUUID->"8d2cec3f-4b54-43fc-ae0e-c64bd1ae354a",
 CellID->1001352657],
Cell[17586, 493, 208, 4, 24, "Output",ExpressionUUID->"ed66c2d4-31f0-4bb5-ba5d-b990fa15b75b",
 CellID->555168197]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17843, 503, 201, 2, 40, "MathCaption",ExpressionUUID->"8565d89a-3dc1-40ac-acd5-d801d217a040",
 CellID->210058381],
Cell[CellGroupData[{
Cell[18069, 509, 309, 6, 26, "Input",ExpressionUUID->"2de0fa28-d123-428b-b5e2-98d1c8625d06",
 CellID->3618976],
Cell[18381, 517, 295, 7, 25, "Output",ExpressionUUID->"94746ca0-d6f1-48e7-8278-248ff52f0647",
 CellID->60384182]
}, Open  ]],
Cell[CellGroupData[{
Cell[18713, 529, 265, 5, 25, "Input",ExpressionUUID->"660b225c-1422-4319-8e29-d30e3deb8688",
 CellID->158897045],
Cell[18981, 536, 259, 6, 24, "Output",ExpressionUUID->"601fecce-349c-4039-8f5b-2f1b74399bd6",
 CellID->90949083]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19289, 548, 240, 4, 40, "MathCaption",ExpressionUUID->"2af08122-2b75-4880-a344-84d2102e1006",
 CellID->45747336],
Cell[CellGroupData[{
Cell[19554, 556, 261, 5, 25, "Input",ExpressionUUID->"66b70e28-e77a-447e-a23b-1b9e9d0d56eb",
 CellID->106947108],
Cell[19818, 563, 215, 4, 24, "Output",ExpressionUUID->"4c82f576-35b3-4c89-9dda-a2b8fadfdd98",
 CellID->688234202]
}, Open  ]],
Cell[CellGroupData[{
Cell[20070, 572, 266, 5, 25, "Input",ExpressionUUID->"4468754d-b339-4a2a-9d0d-4595095e64b6",
 CellID->289386853],
Cell[20339, 579, 210, 4, 24, "Output",ExpressionUUID->"48a35c84-046a-4567-9766-96920108ee49",
 CellID->383066580]
}, Open  ]],
Cell[CellGroupData[{
Cell[20586, 588, 266, 5, 25, "Input",ExpressionUUID->"d79fbaf0-27e6-49a8-aa49-3068b2ea26df",
 CellID->616336306],
Cell[20855, 595, 210, 4, 24, "Output",ExpressionUUID->"f29a22a9-3747-4e8f-b627-7b11e218ce82",
 CellID->287890430]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21114, 605, 276, 5, 57, "MathCaption",ExpressionUUID->"58782be3-aee4-4688-9aa0-f67ced329f3f",
 CellID->657986846],
Cell[CellGroupData[{
Cell[21415, 614, 247, 4, 25, "Input",ExpressionUUID->"53397038-fd0e-4d9a-9edd-b596769b620d",
 CellID->3639185],
Cell[21665, 620, 9438, 256, 178, "Output",ExpressionUUID->"84c8a925-7c7f-43d1-9477-0b21d4c74fd7",
 CellID->781595662]
}, Open  ]],
Cell[CellGroupData[{
Cell[31140, 881, 311, 7, 25, "Input",ExpressionUUID->"b8a9ab4a-ca17-489b-a112-77b3eb665233",
 CellID->106876852],
Cell[31454, 890, 10549, 302, 413, "Output",ExpressionUUID->"c1912582-c320-4a31-a835-d77a09a1b203",
 CellID->78099367]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42052, 1198, 193, 2, 40, "MathCaption",ExpressionUUID->"ea217606-4fc7-4ae5-b860-1a9d9c0c9bb4",
 CellID->201555096],
Cell[CellGroupData[{
Cell[42270, 1204, 363, 8, 25, "Input",ExpressionUUID->"7365682a-9352-4f44-8e92-8fa88547b46e",
 CellID->76274047],
Cell[42636, 1214, 20271, 632, 1044, "Output",ExpressionUUID->"d0cf1f2d-53e1-484a-9edc-173b312ec335",
 CellID->268218734]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62956, 1852, 241, 4, 40, "MathCaption",ExpressionUUID->"193fd985-a1c8-4cb4-8049-61c540b24416",
 CellID->116384939],
Cell[CellGroupData[{
Cell[63222, 1860, 382, 8, 25, "Input",ExpressionUUID->"1650bdc2-d3dd-44d2-935a-cb0166afa61e",
 CellID->11721902],
Cell[63607, 1870, 9941, 335, 608, "Output",ExpressionUUID->"f3d6bc50-6c9c-40f3-bf12-4a151619f9cb",
 CellID->122696485]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73597, 2211, 183, 2, 40, "MathCaption",ExpressionUUID->"86b94b57-eaac-4303-81af-a7050b4a3f0d",
 CellID->7379660],
Cell[CellGroupData[{
Cell[73805, 2217, 286, 5, 25, "Input",ExpressionUUID->"fc483901-d97e-4372-9f6a-9813c3022a4b",
 CellID->57152497],
Cell[74094, 2224, 9968, 336, 608, "Output",ExpressionUUID->"c5e71275-b015-4f09-85eb-6a48969472f9",
 CellID->99386605]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84111, 2566, 254, 3, 40, "MathCaption",ExpressionUUID->"124a6d2d-ea42-451a-94ee-c679eb1ebe95",
 CellID->600024437],
Cell[CellGroupData[{
Cell[84390, 2573, 405, 9, 25, "Input",ExpressionUUID->"85f25a87-aaee-49ac-aec1-40dc56984d69",
 CellID->356384648],
Cell[84798, 2584, 9942, 335, 608, "Output",ExpressionUUID->"44758134-dc52-4f6e-9723-314aab58a870",
 CellID->51287920]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94789, 2925, 206, 2, 40, "MathCaption",ExpressionUUID->"ef013166-4ead-44c5-b462-ff65ddc99d01",
 CellID->32533157],
Cell[CellGroupData[{
Cell[95020, 2931, 423, 9, 25, "Input",ExpressionUUID->"0416be1e-c919-43ec-aa1e-85469159a7b8",
 CellID->221488453],
Cell[95446, 2942, 9938, 335, 608, "Output",ExpressionUUID->"35e9dc97-64da-40ab-bf0d-b1170d95795f",
 CellID->44145120]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105433, 3283, 200, 2, 40, "MathCaption",ExpressionUUID->"a2133ad2-2225-44aa-9f09-fb71192a71ea",
 CellID->441304007],
Cell[CellGroupData[{
Cell[105658, 3289, 357, 8, 25, "Input",ExpressionUUID->"a58c9ff8-287c-44c1-b668-5330c449eee6",
 CellID->784023909],
Cell[106018, 3299, 281, 6, 24, "Output",ExpressionUUID->"81941b3a-1333-4d5a-a4ac-58c4a01cf9cd",
 CellID->565604538]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[106348, 3311, 309, 6, 40, "MathCaption",ExpressionUUID->"5149010d-c608-4898-8767-cfd634db1877",
 CellID->48363548],
Cell[CellGroupData[{
Cell[106682, 3321, 407, 9, 25, "Input",ExpressionUUID->"0994fd9e-af71-478d-908d-4500620df444",
 CellID->265849720],
Cell[107092, 3332, 237, 5, 24, "Output",ExpressionUUID->"affd3fdf-d9ac-416c-862d-47ff1e8b97d6",
 CellID->36210837]
}, Open  ]],
Cell[CellGroupData[{
Cell[107366, 3342, 424, 10, 25, "Input",ExpressionUUID->"fd7a6e53-b654-4cbc-b5ee-9f48f9ec5f56",
 CellID->10018807],
Cell[107793, 3354, 196, 3, 24, "Output",ExpressionUUID->"e76d88ee-cf9e-4426-9e7b-7134e41378e3",
 CellID->90942833]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108038, 3363, 215, 2, 40, "MathCaption",ExpressionUUID->"7d92d8c6-2ea7-4ba0-8219-43584f030b73",
 CellID->222360495],
Cell[108256, 3367, 590, 14, 43, "Input",ExpressionUUID->"82beeeb9-2a8c-4463-af42-1005bc5440b5",
 CellID->876159263]
}, Open  ]],
Cell[CellGroupData[{
Cell[108883, 3386, 184, 2, 40, "MathCaption",ExpressionUUID->"bb3a1f82-6483-45e6-bf09-9be803a1b346",
 CellID->140693972],
Cell[CellGroupData[{
Cell[109092, 3392, 358, 6, 25, "Input",ExpressionUUID->"d8f63307-e67d-4fc8-a97d-402c45b59692",
 CellID->676058770],
Cell[109453, 3400, 222, 4, 24, "Output",ExpressionUUID->"eea12d2b-f043-46fd-85dd-2cbf4f625467",
 CellID->173651887]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109724, 3410, 239, 4, 40, "MathCaption",ExpressionUUID->"9acb1795-a990-4a13-8873-c90e28be41a8",
 CellID->362701572],
Cell[CellGroupData[{
Cell[109988, 3418, 1016, 28, 61, "Input",ExpressionUUID->"19d0214e-62ae-45d5-aa1b-60302fc7b9e9",
 CellID->569912814],
Cell[111007, 3448, 10214, 199, 53, "Output",ExpressionUUID->"a2d3cb23-f362-4b5c-a1bc-da580aaa66bf",
 CellID->466247083]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121270, 3653, 222, 2, 40, "MathCaption",ExpressionUUID->"97132d86-e5d0-45e3-802f-58f9f0f39315",
 CellID->860484422],
Cell[CellGroupData[{
Cell[121517, 3659, 393, 9, 25, "Input",ExpressionUUID->"add0c371-31b9-4367-bc72-eb4c040e00e9",
 CellID->200160651],
Cell[121913, 3670, 256, 5, 24, "Output",ExpressionUUID->"167bdd41-fd93-47ac-ab49-db1c26338de0",
 CellID->5616810]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122218, 3681, 234, 4, 40, "MathCaption",ExpressionUUID->"9c17d504-b7ec-49f5-aa76-01b975d8b4ff",
 CellID->38347245],
Cell[CellGroupData[{
Cell[122477, 3689, 393, 9, 25, "Input",ExpressionUUID->"724adc3c-0673-4c79-83a0-9b35580656c0",
 CellID->26282727],
Cell[122873, 3700, 22828, 560, 103, "Output",ExpressionUUID->"cfcbbb5c-53db-400b-b113-44c26b8cecc7",
 CellID->434215884]
}, Open  ]],
Cell[CellGroupData[{
Cell[145738, 4265, 615, 16, 43, "Input",ExpressionUUID->"b4839ee4-2c41-4b36-94a0-7b8578dcef1d",
 CellID->466437509],
Cell[146356, 4283, 11538, 302, 103, "Output",ExpressionUUID->"5c162d0f-d327-443a-a8bc-5f4ac9e44d7f",
 CellID->581867833]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[157943, 4591, 199, 2, 40, "MathCaption",ExpressionUUID->"c3f2f89c-9482-4f53-98b1-6c9fc2a23c33",
 CellID->46456499],
Cell[CellGroupData[{
Cell[158167, 4597, 323, 6, 44, "Input",ExpressionUUID->"546a60cf-d081-49f5-aa14-fa702e72a761",
 CellID->30529297],
Cell[158493, 4605, 502, 14, 45, "Output",ExpressionUUID->"9103b4bb-7813-45f2-a6d7-9a32cded2b51",
 CellID->315960114]
}, Open  ]],
Cell[CellGroupData[{
Cell[159032, 4624, 228, 4, 25, "Input",ExpressionUUID->"ab190343-3149-4f6a-8623-4ccb8dedd90a",
 CellID->562027770],
Cell[159263, 4630, 25332, 654, 245, "Output",ExpressionUUID->"afcc092f-35b7-4fcc-b26b-92d5ac91f7b1",
 CellID->601819694]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[184644, 5290, 188, 2, 40, "MathCaption",ExpressionUUID->"77777825-f8e5-4ced-be9c-4cc1309fbd28",
 CellID->194616050],
Cell[CellGroupData[{
Cell[184857, 5296, 721, 17, 43, "Input",ExpressionUUID->"72c77568-5553-4447-b7b6-5d1fe557a34e",
 CellID->233755330],
Cell[185581, 5315, 36506, 911, 421, "Output",ExpressionUUID->"dce34231-e31a-474d-8db2-47053a02cbd7",
 CellID->147590346]
}, Open  ]],
Cell[CellGroupData[{
Cell[222124, 6231, 601, 13, 25, "Input",ExpressionUUID->"c67180dc-cad8-49b0-943d-64bf7b19934b",
 CellID->45569491],
Cell[222728, 6246, 39890, 1008, 414, "Output",ExpressionUUID->"43022bc4-fb05-4799-b6aa-38362aa929e6",
 CellID->86851793]
}, Open  ]]
}, Open  ]],
Cell[262645, 7258, 438, 11, 96, "DefinitionBox",ExpressionUUID->"3a120140-9199-49e4-9455-dd2ea9fc8376",
 CellID->771150938],
Cell[263086, 7271, 98, 1, 30, "Caption",ExpressionUUID->"f5f60007-c978-4515-b0ad-835ba5ae7d46",
 CellID->56681674]
}, Open  ]],
Cell[CellGroupData[{
Cell[263221, 7277, 172, 2, 45, "Section",ExpressionUUID->"19945e51-54d3-43c9-aa1b-f6fdb8d3c43e",
 CellID->194172257],
Cell[CellGroupData[{
Cell[263418, 7283, 174, 2, 42, "Subsection",ExpressionUUID->"1e56a077-1c45-4290-8be6-0d02c8772dcc",
 CellID->268449717],
Cell[263595, 7287, 254, 5, 25, "Text",ExpressionUUID->"f43cd62e-9a36-420a-b91e-3d128127be16",
 CellID->38548766],
Cell[CellGroupData[{
Cell[263874, 7296, 168, 2, 40, "MathCaption",ExpressionUUID->"bcaa542b-05a8-40ae-8474-eb2c14e74d8c",
 CellID->869928153],
Cell[264045, 7300, 289, 6, 25, "Input",ExpressionUUID->"2839130b-501f-465e-b1d6-f14121ff0e17",
 CellID->332914739]
}, Open  ]],
Cell[CellGroupData[{
Cell[264371, 7311, 183, 2, 40, "MathCaption",ExpressionUUID->"28ce1dcc-0757-40de-b210-523e1bf7b01e",
 CellID->76608498],
Cell[CellGroupData[{
Cell[264579, 7317, 237, 4, 25, "Input",ExpressionUUID->"cd69e59c-e6ea-4b50-9ff6-c1a65c608a37",
 CellID->96817370],
Cell[264819, 7323, 170, 3, 24, "Output",ExpressionUUID->"5fe6d5fd-930d-450e-9f7a-9e42e562f7e7",
 CellID->333277154]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265038, 7332, 196, 2, 40, "MathCaption",ExpressionUUID->"28fe1505-656f-4577-8353-f3aa193cb1a4",
 CellID->132842737],
Cell[CellGroupData[{
Cell[265259, 7338, 236, 4, 25, "Input",ExpressionUUID->"662735f4-c64c-4559-a8a8-6e8d8f29167c",
 CellID->384650234],
Cell[265498, 7344, 170, 3, 24, "Output",ExpressionUUID->"62918c2d-efef-4281-85cf-fc5d34de8b89",
 CellID->202833461]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265729, 7354, 225, 3, 42, "Subsection",ExpressionUUID->"6983f950-66f2-4847-b830-1bf59eecd009",
 CellID->194967963],
Cell[CellGroupData[{
Cell[265979, 7361, 524, 15, 25, "Text",ExpressionUUID->"90f00af2-676b-4b97-9811-3bd4dd7d6754",
 CellID->185252635],
Cell[CellGroupData[{
Cell[266528, 7380, 422, 11, 25, "Input",ExpressionUUID->"c5c33a0d-a7c3-4ba1-a946-fcaff628af6e",
 CellID->250393049],
Cell[266953, 7393, 430, 12, 45, "Output",ExpressionUUID->"c29aedee-2263-4374-8164-0dd77a1007a7",
 CellID->878465958]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[267432, 7411, 175, 2, 40, "MathCaption",ExpressionUUID->"3f611023-c3c0-45d3-9bc3-0bc5cdf393a3",
 CellID->386931535],
Cell[CellGroupData[{
Cell[267632, 7417, 529, 15, 47, "Input",ExpressionUUID->"056d53d0-94f6-4eb4-a3a9-30502ed40cd6",
 CellID->170794992],
Cell[268164, 7434, 877, 32, 42, "Output",ExpressionUUID->"296619f3-3e80-4fd6-a0ec-c21a226deaea",
 CellID->112160897]
}, Open  ]],
Cell[CellGroupData[{
Cell[269078, 7471, 232, 4, 25, "Input",ExpressionUUID->"7768e08f-1efd-4577-83cf-0b81f428b9d9",
 CellID->200307475],
Cell[269313, 7477, 245, 6, 43, "Output",ExpressionUUID->"3d93041f-01d3-42c1-924c-16ab8a04e539",
 CellID->1194021]
}, Open  ]],
Cell[CellGroupData[{
Cell[269595, 7488, 233, 4, 25, "Input",ExpressionUUID->"6355e096-68a8-40fa-b4cb-7f2526bf9496",
 CellID->791122323],
Cell[269831, 7494, 17562, 485, 183, "Output",ExpressionUUID->"4493ce93-aa09-4ec8-ace9-d8028959f40d",
 CellID->170209671]
}, Open  ]],
Cell[CellGroupData[{
Cell[287430, 7984, 237, 4, 25, "Input",ExpressionUUID->"c13fba48-4a62-4503-a2bb-e39e9bd34fa8",
 CellID->66563211],
Cell[287670, 7990, 26291, 686, 323, "Output",ExpressionUUID->"03247c3a-8051-483e-9c28-96703063ee23",
 CellID->162891395]
}, Open  ]],
Cell[CellGroupData[{
Cell[313998, 8681, 938, 33, 44, "Input",ExpressionUUID->"ec6fb240-62f1-481b-aead-d76ba7d01e83",
 CellID->172257243],
Cell[314939, 8716, 209, 4, 24, "Output",ExpressionUUID->"eaeea999-b9d6-434c-86bf-8808382d67df",
 CellID->113973965]
}, Open  ]],
Cell[CellGroupData[{
Cell[315185, 8725, 1544, 50, 106, "Input",ExpressionUUID->"13eb6b9c-455c-4ad9-bd49-edd045309a4a",
 CellID->250063681],
Cell[316732, 8777, 369, 8, 24, "Output",ExpressionUUID->"0e53fd9a-0db9-4847-b392-bf47cfc113ca",
 CellID->106697600]
}, Open  ]],
Cell[CellGroupData[{
Cell[317138, 8790, 826, 23, 43, "Input",ExpressionUUID->"dbc6f9c3-035e-4def-a6e5-e35f54f2c047",
 CellID->661990640],
Cell[317967, 8815, 172, 3, 24, "Output",ExpressionUUID->"1ea36e34-572f-497e-96d1-6ca644b69040",
 CellID->179615253]
}, Open  ]],
Cell[CellGroupData[{
Cell[318176, 8823, 849, 23, 43, "Input",ExpressionUUID->"3d6228a8-2208-4d35-95b0-a050cee534b1",
 CellID->60633593],
Cell[319028, 8848, 491, 10, 26, "Message",ExpressionUUID->"5a4fabba-f2ec-4c83-b2a4-b38f3e0ece80",
 CellID->170308327],
Cell[319522, 8860, 491, 10, 26, "Message",ExpressionUUID->"61a8d197-545b-44b1-83e3-71cbb7032891",
 CellID->102137890],
Cell[320016, 8872, 493, 10, 26, "Message",ExpressionUUID->"0f8e44fb-fc80-4be1-910d-1125443ebcc8",
 CellID->394454359],
Cell[320512, 8884, 490, 10, 26, "Message",ExpressionUUID->"70210467-e429-4c0c-a85a-959e7fe46990",
 CellID->76820452],
Cell[321005, 8896, 173, 3, 24, "Output",ExpressionUUID->"e53fb0c0-7c9d-4a9a-a8ad-14927e217ac7",
 CellID->491793677]
}, Open  ]],
Cell[CellGroupData[{
Cell[321215, 8904, 400, 10, 29, "Input",ExpressionUUID->"2de3f7cd-8cc2-44d0-97aa-27093d6cd1e0",
 CellID->384495673],
Cell[321618, 8916, 175, 3, 24, "Output",ExpressionUUID->"ded23f71-8f0d-4855-950e-4a71093512d1",
 CellID->186967771]
}, Open  ]],
Cell[CellGroupData[{
Cell[321830, 8924, 403, 10, 29, "Input",ExpressionUUID->"4f18cbe3-aae0-43f9-903d-5b5f5e86408a",
 CellID->322303961],
Cell[322236, 8936, 174, 3, 24, "Output",ExpressionUUID->"679fcfca-9b09-47d4-b027-626f35009e3e",
 CellID->705383167]
}, Open  ]],
Cell[CellGroupData[{
Cell[322447, 8944, 403, 10, 29, "Input",ExpressionUUID->"8444b3cf-06af-42e3-8559-d3cc05066374",
 CellID->352881982],
Cell[322853, 8956, 174, 3, 24, "Output",ExpressionUUID->"c9a85bc5-8306-4405-ab81-892c8d1a822c",
 CellID->104515354]
}, Open  ]],
Cell[CellGroupData[{
Cell[323064, 8964, 630, 18, 44, "Input",ExpressionUUID->"1198c22f-8820-476d-882a-5d43b3337bb9",
 CellID->319128574],
Cell[323697, 8984, 173, 3, 24, "Output",ExpressionUUID->"d1ee4449-7485-4155-93c9-252412f233f9",
 CellID->32208754]
}, Open  ]],
Cell[CellGroupData[{
Cell[323907, 8992, 415, 12, 44, "Input",ExpressionUUID->"00f1cd4a-9fe8-42f1-985b-3fce886b359c",
 CellID->632903510],
Cell[324325, 9006, 172, 3, 24, "Output",ExpressionUUID->"1674cfe9-585a-4193-b5db-2c822c9e8c64",
 CellID->65152455]
}, Open  ]],
Cell[CellGroupData[{
Cell[324534, 9014, 541, 15, 44, "Input",ExpressionUUID->"7a83c442-d251-47b5-b5a1-d3bb25d22f13",
 CellID->588694242],
Cell[325078, 9031, 256, 5, 24, "Output",ExpressionUUID->"efbd91c7-c11c-4ea0-b7d3-33a30effc388",
 CellID->328151388]
}, Open  ]],
Cell[CellGroupData[{
Cell[325371, 9041, 661, 18, 44, "Input",ExpressionUUID->"cd28b2b7-65ae-400a-a093-7dad2334a9f4",
 CellID->148597441],
Cell[326035, 9061, 174, 3, 24, "Output",ExpressionUUID->"909173d8-b455-4248-a8c9-71120bd7a5b5",
 CellID->250828651]
}, Open  ]],
Cell[CellGroupData[{
Cell[326246, 9069, 367, 8, 29, "Input",ExpressionUUID->"a0a51258-c844-46c5-9e06-1d9327ee7bf8",
 CellID->328691234],
Cell[326616, 9079, 188, 4, 24, "Output",ExpressionUUID->"1b4accef-4fc1-4457-a47b-ee1df3cf1600",
 CellID->230939523]
}, Open  ]],
Cell[CellGroupData[{
Cell[326841, 9088, 473, 11, 29, "Input",ExpressionUUID->"9f2a93c1-fd83-4e4d-8b48-a9fed68f6d1c",
 CellID->236727458],
Cell[327317, 9101, 175, 3, 24, "Output",ExpressionUUID->"d34ec792-8a1c-4bb7-9762-433b0f04f7be",
 CellID->592692198]
}, Open  ]],
Cell[CellGroupData[{
Cell[327529, 9109, 420, 12, 44, "Input",ExpressionUUID->"c510437a-bcf3-4366-bd8b-1a3c2e50f76b",
 CellID->2559059],
Cell[327952, 9123, 202, 3, 26, "Output",ExpressionUUID->"2f2751b3-7d72-4276-9597-60b735135929",
 CellID->280959356]
}, Open  ]],
Cell[CellGroupData[{
Cell[328191, 9131, 1227, 37, 101, "Input",ExpressionUUID->"431fe04e-2754-4e57-90db-d8383a7d7144",
 CellID->322886675],
Cell[329421, 9170, 199, 3, 24, "Output",ExpressionUUID->"135ec8d8-f0d6-4014-97fd-0186555bf35f",
 CellID->215218184]
}, Open  ]],
Cell[CellGroupData[{
Cell[329657, 9178, 872, 27, 29, "Input",ExpressionUUID->"059dd3a9-ee61-4444-b26a-07a3cc3e54fc",
 CellID->284468844],
Cell[330532, 9207, 175, 3, 24, "Output",ExpressionUUID->"0835eedc-ced7-4500-a32b-1b1d5d30b0d6",
 CellID->300512079]
}, Open  ]],
Cell[CellGroupData[{
Cell[330744, 9215, 2252, 67, 176, "Input",ExpressionUUID->"4f5311fe-d663-4bf8-b6fb-f51d10a2b9b5",
 CellID->20379994],
Cell[332999, 9284, 977, 34, 42, "Output",ExpressionUUID->"2d9327b2-4dae-4956-a98e-58a4c8fac1d5",
 CellID->647092413]
}, Open  ]],
Cell[333991, 9321, 7389, 184, 502, "Input",ExpressionUUID->"21ee101e-a3a8-4f14-a5b7-72a1d6253748",
 CellID->471136429],
Cell[CellGroupData[{
Cell[341405, 9509, 436, 11, 25, "Input",ExpressionUUID->"37b1258b-5ebb-46fb-a9bc-7e6f8da57a70",
 CellID->396067602],
Cell[341844, 9522, 360, 10, 45, "Output",ExpressionUUID->"d5063990-1c42-4265-a57c-7669168239c1",
 CellID->91876342]
}, Open  ]],
Cell[CellGroupData[{
Cell[342241, 9537, 438, 13, 25, "Input",ExpressionUUID->"7cbfbbf7-3317-4633-995f-59bcb763a0e8",
 CellID->737919],
Cell[342682, 9552, 860, 30, 42, "Output",ExpressionUUID->"e7c93c68-1f93-4eac-9af1-a05a192c747f",
 CellID->65017555]
}, Open  ]],
Cell[CellGroupData[{
Cell[343579, 9587, 3888, 110, 274, "Input",ExpressionUUID->"358492fd-be8e-4c62-b9ed-fab0068babb0",
 CellID->7081445],
Cell[CellGroupData[{
Cell[347492, 9701, 771, 20, 24, "EchoBefore",ExpressionUUID->"104d456c-ed20-4f85-a700-42712bc8cd17",
 CellTags->"407df68d-e655-417b-9ff2-0449c81d58ef",
 CellID->585255656],
Cell[348266, 9723, 1480, 42, 24, "EchoAfter",ExpressionUUID->"db7c6fb7-bb00-4871-a8a4-db62aeb14ff1",
 CellTags->"1e264c9a-d32f-444c-996b-0bb1b507d08a",
 CellID->257068581]
}, Open  ]],
Cell[349761, 9768, 771, 26, 45, "Output",ExpressionUUID->"0b6a67ed-4aa9-4130-9665-a1d90348d6c8",
 CellID->362255658]
}, Open  ]],
Cell[350547, 9797, 7456, 183, 555, "Input",ExpressionUUID->"e0555286-04b9-4743-b069-459394db6064",
 CellID->368103848],
Cell[CellGroupData[{
Cell[358028, 9984, 285, 5, 25, "Input",ExpressionUUID->"14f9af16-385d-483d-8c6a-4795bd0c3d99",
 CellID->75949663],
Cell[358316, 9991, 237, 4, 24, "Output",ExpressionUUID->"f2987302-9878-42ac-aed3-b5ec0289f8ab",
 CellID->16251515]
}, Open  ]],
Cell[CellGroupData[{
Cell[358590, 10000, 290, 5, 25, "Input",ExpressionUUID->"1d6a75e6-46bb-40b7-ab58-6305ec9610be",
 CellID->53162270],
Cell[358883, 10007, 249, 4, 24, "Output",ExpressionUUID->"85dfb224-7cb4-4590-b054-3c2835e0e985",
 CellID->402951547]
}, Open  ]],
Cell[CellGroupData[{
Cell[359169, 10016, 318, 6, 28, "Input",ExpressionUUID->"1bcc0602-d555-4b18-8140-385588c0ea13",
 CellID->229526090],
Cell[359490, 10024, 405, 9, 24, "Output",ExpressionUUID->"efc4a112-1768-49ea-bbb2-559ccad3daa5",
 CellID->798424520]
}, Open  ]],
Cell[CellGroupData[{
Cell[359932, 10038, 396, 8, 29, "Input",ExpressionUUID->"33ecf1d7-c60b-45ff-911d-6dd7a188cedd",
 CellID->224954957],
Cell[360331, 10048, 318, 8, 25, "Output",ExpressionUUID->"fe9312a2-e4e7-41f6-8ed2-7c8d81964d9d",
 CellID->454449641]
}, Open  ]],
Cell[CellGroupData[{
Cell[360686, 10061, 3914, 110, 277, "Input",ExpressionUUID->"8b4b56df-a3e5-452b-9c70-d582d59e68a0",
 CellID->28050259],
Cell[364603, 10173, 235, 5, 42, "Output",ExpressionUUID->"b38e704b-4a3d-4a98-989c-34f881114252",
 CellID->490810363]
}, Open  ]],
Cell[CellGroupData[{
Cell[364875, 10183, 1740, 51, 83, "Input",ExpressionUUID->"1c2c1275-4f5d-40e9-9de5-29cee35164df",
 CellID->404350346],
Cell[366618, 10236, 435, 12, 28, "Output",ExpressionUUID->"bc3b8eb4-7545-438c-be39-5d5cfedf1c26",
 CellID->218827964]
}, Open  ]],
Cell[CellGroupData[{
Cell[367090, 10253, 295, 7, 29, "Input",ExpressionUUID->"4dc2b004-a66c-4281-8531-fc6dc77cd526",
 CellID->690671388],
Cell[367388, 10262, 633, 23, 25, "Output",ExpressionUUID->"8505fd7b-8ce9-492d-ad4e-cfa1b68fe834",
 CellID->763570026]
}, Open  ]],
Cell[CellGroupData[{
Cell[368058, 10290, 487, 14, 29, "Input",ExpressionUUID->"a4066e0c-2ad9-4a8c-a1e7-957557721db1",
 CellID->149289639],
Cell[368548, 10306, 173, 3, 24, "Output",ExpressionUUID->"b6fadd1e-d000-40c0-9050-4f2474ee9411",
 CellID->626446846]
}, Open  ]],
Cell[CellGroupData[{
Cell[368758, 10314, 471, 14, 29, "Input",ExpressionUUID->"f77d5609-f0a5-4741-8c06-8efaf139c695",
 CellID->477936917],
Cell[369232, 10330, 172, 3, 24, "Output",ExpressionUUID->"8e229b96-3fc3-4686-b26f-657acd239245",
 CellID->125609227]
}, Open  ]],
Cell[369419, 10336, 308, 6, 25, "Input",ExpressionUUID->"ed79a72d-971f-4f8c-9804-866fc7fa8f61",
 CellID->29177797],
Cell[CellGroupData[{
Cell[369752, 10346, 355, 8, 29, "Input",ExpressionUUID->"250be2f2-8ad0-4efd-b606-8b2c0b0d9947",
 CellID->669767948],
Cell[370110, 10356, 172, 3, 24, "Output",ExpressionUUID->"1762b7de-92c2-42f2-b83b-c70628067150",
 CellID->304190463]
}, Open  ]],
Cell[CellGroupData[{
Cell[370319, 10364, 1715, 50, 83, "Input",ExpressionUUID->"712a2576-2ac3-4f68-9f65-6632b7939ae2",
 CellID->171821158],
Cell[372037, 10416, 682, 24, 25, "Output",ExpressionUUID->"7c77c2eb-162b-48ba-b3aa-03b5782f42d1",
 CellID->31127353]
}, Open  ]],
Cell[CellGroupData[{
Cell[372756, 10445, 339, 7, 29, "Input",ExpressionUUID->"67830dbc-942f-4041-83ca-5d832cbcf0e1",
 CellID->56910265],
Cell[373098, 10454, 297, 8, 25, "Output",ExpressionUUID->"16f5ba4c-50d5-424a-9a51-d30e9dbdfebe",
 CellID->1010161959]
}, Open  ]],
Cell[CellGroupData[{
Cell[373432, 10467, 357, 7, 29, "Input",ExpressionUUID->"61f47128-ddcd-4934-a0d0-7bcb36a78241",
 CellID->93964102],
Cell[373792, 10476, 235, 5, 42, "Output",ExpressionUUID->"46e501f7-ae1b-4401-a27f-e97d35282ccc",
 CellID->122682045]
}, Open  ]],
Cell[CellGroupData[{
Cell[374064, 10486, 8332, 201, 599, "Input",ExpressionUUID->"0cacd8f5-23dc-4ea0-ac55-a8d2c46faef8",
 CellID->21969815],
Cell[382399, 10689, 297, 8, 25, "Output",ExpressionUUID->"e67930fe-c619-44f7-89b3-a87489619bf5",
 CellID->157418928]
}, Open  ]],
Cell[CellGroupData[{
Cell[382733, 10702, 10018, 250, 1142, "Input",ExpressionUUID->"8166455e-febd-4dac-b422-66f59e9787e0",
 CellID->173646475],
Cell[392754, 10954, 317, 7, 25, "Output",ExpressionUUID->"32ac0768-b6a0-47e9-beb7-94ec0c80417a",
 CellID->202299149]
}, Open  ]],
Cell[CellGroupData[{
Cell[393108, 10966, 7528, 195, 650, "Input",ExpressionUUID->"de2936b4-acfa-49d3-b894-732c03afb353",
 CellID->30857652],
Cell[400639, 11163, 295, 8, 25, "Output",ExpressionUUID->"c7bf196a-8ddd-425c-b530-23f2eedd2aaa",
 CellID->516730849]
}, Open  ]],
Cell[CellGroupData[{
Cell[400971, 11176, 10737, 261, 1197, "Input",ExpressionUUID->"180f119f-213a-4120-ad9e-5dbda72e643d",
 CellID->34212862],
Cell[411711, 11439, 320, 7, 25, "Output",ExpressionUUID->"23847299-afed-4fcd-a99b-eafd7ab717a0",
 CellID->76091348]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[412104, 11454, 191, 2, 74, "TutorialMoreAboutSection",ExpressionUUID->"76801787-5f70-41d3-a497-142c85e4f5f5",
 CellID->161772049],
Cell[412298, 11458, 107, 1, 24, "TutorialMoreAbout",ExpressionUUID->"293b3931-85af-4829-9e80-7b6c6a37d4eb",
 CellID->67989278]
}, Open  ]],
Cell[CellGroupData[{
Cell[412442, 11464, 128, 1, 74, "RelatedTutorialsSection",ExpressionUUID->"b843fff2-33d9-4c3f-83b8-39883e476e35",
 CellID->183639716],
Cell[412573, 11467, 106, 1, 24, "RelatedTutorials",ExpressionUUID->"3ca477f5-83dd-45cf-97d5-2f16fcf8c0a1",
 CellID->29667343]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[412728, 11474, 110, 1, 72, "MetadataSection",ExpressionUUID->"f70824db-8bb0-4d0d-a14e-72f55559f5eb",
 CellID->213044136],
Cell[412841, 11477, 472, 11, 26, "History",ExpressionUUID->"1fbf2634-130c-4a42-b1fd-588c4e7a8f5b",
 CellID->72794903],
Cell[CellGroupData[{
Cell[413338, 11492, 122, 1, 21, "CategorizationSection",ExpressionUUID->"1aa13a2a-d527-4b88-a6f6-f464858515fe",
 CellID->385949988],
Cell[413463, 11495, 137, 2, 70, "Categorization",ExpressionUUID->"ae94e6e3-6a49-4d7e-bb24-26a709fea1f8",
 CellID->509057587],
Cell[413603, 11499, 169, 2, 70, "Categorization",ExpressionUUID->"c05029b2-5853-47e8-8989-2c88539ca3a9",
 CellID->519804101],
Cell[413775, 11503, 166, 2, 70, "Categorization",ExpressionUUID->"44216c23-99d0-4901-8e9a-cf8468fac854",
 CellID->392509224],
Cell[413944, 11507, 200, 4, 70, "Categorization",ExpressionUUID->"764c4ddd-b0e0-480f-80bd-532b6aa0f96f",
 CellID->22346959]
}, Closed]],
Cell[CellGroupData[{
Cell[414181, 11516, 110, 1, 21, "KeywordsSection",ExpressionUUID->"bf86c44b-4960-45b2-b08f-b5f2b7bff7e6",
 CellID->426123361],
Cell[414294, 11519, 99, 1, 70, "Keywords",ExpressionUUID->"196dd428-ec9d-4b25-82c2-5e89d985bbff",
 CellID->393918541]
}, Closed]]
}, Open  ]]
}
]
*)

